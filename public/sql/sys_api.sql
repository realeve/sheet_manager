/*
Navicat MySQL Data Transfer

Source Server         : MYSQL
Source Server Version : 50720
Source Host           : localhost:3306
Source Database       : api_quality

Target Server Type    : MYSQL
Target Server Version : 50720
File Encoding         : 65001

Date: 2019-12-23 13:27:37
*/

SET FOREIGN_KEY_CHECKS=0;

-- ----------------------------
-- Table structure for sys_api
-- ----------------------------
DROP TABLE IF EXISTS `sys_api`;
CREATE TABLE `sys_api` (
  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT 'id',
  `db_id` int(11) unsigned zerofill DEFAULT '00000000001' COMMENT '数据库id',
  `uid` int(11) DEFAULT NULL COMMENT '接口所属用户id',
  `api_name` varchar(255) DEFAULT NULL COMMENT '接口名字',
  `nonce` varchar(255) DEFAULT NULL COMMENT '唯一字符串',
  `sqlstr` text COMMENT '查询sql',
  `param` varchar(255) DEFAULT NULL COMMENT '参数',
  `remark` text,
  `rec_time` datetime DEFAULT NULL COMMENT '插入时间',
  `update_time` datetime DEFAULT NULL ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  `fixed` int(11) DEFAULT '0',
  PRIMARY KEY (`id`) USING BTREE,
  KEY `id` (`id`,`db_id`,`uid`,`nonce`) USING BTREE
) ENGINE=InnoDB AUTO_INCREMENT=729 DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC;

-- ----------------------------
-- Records of sys_api
-- ----------------------------
INSERT INTO `sys_api` VALUES ('1', '00000000001', '1', ' 接口列表', 'e61799e7ab', 'SELECT a.id, b.db_name 数据库, a.api_name 接口名称, a.nonce, a.sqlstr 查询语句, ( CASE WHEN isnull(a.param) THEN \'\' ELSE a.param END ) 查询参数, a.rec_time 建立时间, a.update_time 最近更新, a.db_id,a.remark,uid,c.fullname username FROM sys_api a INNER JOIN sys_database b on a.db_id = b.id inner join sys_user c on a.uid=c.id WHERE a.id >3 order by a.id desc', '', ' ', '2017-07-30 03:07:37', '2019-03-13 10:15:02', '1');
INSERT INTO `sys_api` VALUES ('2', '00000000001', '1', '数据库列表', '6119bacd08', 'SELECT a.id,a.db_name text FROM sys_database AS a', '', ' ', '2017-11-24 00:49:19', '2019-03-13 10:15:02', '1');
INSERT INTO `sys_api` VALUES ('3', '00000000001', '1', '数据库列表', 'e4e497e849', 'select id,db_name 数据库名,db_key 配置项键值 from sys_database', '', ' ', '2017-11-24 16:02:10', '2019-03-13 10:15:02', '1');
INSERT INTO `sys_api` VALUES ('4', '00000000001', '1', '更新密码', '63bc967cec', 'update sys_user set psw =? where id =? and psw=MD5(concat(\'wMqSakbLdy9t8LLD\',?))', 'new,uid,old', ' ', '2017-12-18 02:10:47', '2019-03-13 10:15:02', '1');
INSERT INTO `sys_api` VALUES ('5', '00000000001', '1', '用户登录', '209a76b78d', 'SELECT a.id uid,a.username,a.fullname,a.avatar,a.user_type,b.detail menu,c.dept_name,a.actived,b.title menu_title,a.sys_id,a.sys_uid FROM sys_user AS a LEFT JOIN tbl_base_menu_list b ON ifnull(a.menu_id,1) = b.id LEFT JOIN sys_dept c ON a.dept_id = c.id WHERE ? in (a.username,a.fullname) AND a.psw = MD5( concat(\'wMqSakbLdy9t8LLD\' ,?) ) AND a.user_type > 0', 'username,password', ' ', '2017-12-18 02:50:11', '2019-04-02 11:40:03', '1');
INSERT INTO `sys_api` VALUES ('6', '00000000006', '1', 'api接口最大id', '2b9eaaabc3', 'SELECT max(id)+1 maxid FROM sys_api', '', '', '2019-12-23 13:07:06', '2019-12-23 13:27:07', '1');
INSERT INTO `sys_api` VALUES ('18', '00000000001', '1', '插入菜单项', '2b9eaaab97', 'insert into tbl_base_menu_item(icon,title,url,pinyin,pinyin_full,uid ) values (?,?,?,?,?,?)', 'icon,title,url,pinyin,pinyin_full,uid', '', '2018-09-28 00:12:09', '2019-03-13 10:15:02', '1');
INSERT INTO `sys_api` VALUES ('19', '00000000001', '1', '更新菜单项', '5fc349508c', 'update tbl_base_menu_item set icon = ?,title = ?,url = ?,pinyin = ?,pinyin_full = ? where id=?', 'icon,title,url,pinyin,pinyin_full,_id', '@id:_id. 参数说明：api 索引序号', '2018-09-28 00:28:26', '2019-03-13 10:15:02', '1');
INSERT INTO `sys_api` VALUES ('20', '00000000001', '1', '查询菜单项', 'b5fa4e6e6e', 'select id,icon,title,url,pinyin,pinyin_full,uid from tbl_base_menu_item order by id desc', '', '', '2018-09-28 00:32:11', '2019-03-13 10:15:02', '1');
INSERT INTO `sys_api` VALUES ('21', '00000000001', '1', '删除菜单', '548039aa24', 'delete from tbl_base_menu_item where id=?', '_id', '@id:_id. 参数说明：api 索引序号', '2018-09-28 01:19:43', '2019-03-13 10:15:02', '1');
INSERT INTO `sys_api` VALUES ('22', '00000000001', '1', '插入菜单配置信息', '48c41dde3b', 'insert into tbl_base_menu_list(title,detail,uid ) values (?,?,?)', 'title,detail,uid', '', '2018-09-28 01:39:34', '2019-03-13 10:15:02', '1');
INSERT INTO `sys_api` VALUES ('23', '00000000001', '1', '读取菜单配置列表', 'dc95d5f25b', 'select a.id,a.title,a.detail,a.uid from tbl_base_menu_list as a', '', '', '2018-09-28 01:40:06', '2019-03-13 10:15:02', '1');
INSERT INTO `sys_api` VALUES ('24', '00000000001', '1', '修改菜单列表', '0e4f343fa7', 'update tbl_base_menu_list set title = ?,detail = ? where id=? and uid=?', 'title,detail,_id,uid', '@id:_id. 参数说明：api 索引序号', '2018-09-28 02:13:28', '2019-03-13 10:15:02', '1');
INSERT INTO `sys_api` VALUES ('25', '00000000001', '1', '删除菜单列表', 'bbbd988205', 'delete from tbl_base_menu_list where id=? and uid=?', '_id,uid', '@id:_id. 参数说明：api 索引序号', '2018-09-28 02:16:08', '2019-03-13 10:15:02', '1');
INSERT INTO `sys_api` VALUES ('26', '00000000001', '1', '设置用户默认菜单', '0d3c8d84a5', 'update sys_user set menu_id = ? where id=?', 'menu_id,_id', '@id:_id. 参数说明：api 索引序号', '2018-10-04 15:43:32', '2019-03-13 10:15:02', '1');
INSERT INTO `sys_api` VALUES ('27', '00000000001', '1', '部门列表', '9b520a55df', 'SELECT id,dept_name value FROM sys_dept order by order_idx', '', '', '2018-10-06 12:32:47', '2019-04-02 14:44:40', '1');
INSERT INTO `sys_api` VALUES ('28', '00000000001', '1', '当前用户名是否存在', '9c38509a7f', 'select count(*) value from sys_user where username=?', 'username', '', '2018-10-06 13:13:00', '2019-03-13 10:15:02', '1');
INSERT INTO `sys_api` VALUES ('29', '00000000001', '1', '用户注册', '607526f43d', 'insert into sys_user(username,fullname,psw,avatar,user_type,dept_id,menu_id,actived,ip,sys_id,sys_uid ) values (?,?,?,?,?,?,?,?,?,?,?)', 'username,fullname,psw,avatar,user_type,dept_id,menu_id,actived,ip,sys_id,sys_uid', '', '2018-10-06 13:49:01', '2019-04-02 11:37:28', '1');
INSERT INTO `sys_api` VALUES ('30', '00000000001', '1', '获取帐户注册时ip', '9cb633ba86', 'select ip from sys_user where username=?', 'username', '', '2018-10-06 14:21:14', '2019-03-13 10:15:02', '1');
INSERT INTO `sys_api` VALUES ('31', '00000000001', '1', '更新用户头像', '26695416cd', 'update sys_user set avatar = ? where id=? and username=?', 'avatar,_id,username', '@id:_id. 参数说明：api 索引序号', '2018-10-07 20:56:35', '2019-03-13 10:15:02', '1');
INSERT INTO `sys_api` VALUES ('32', '00000000001', '1', '更新用户基本信息', '73bf9df9bb', 'update sys_user set fullname = ?,dept_id = ? where id=? and username=?', 'fullname,dept_id,_id,username', '@id:_id. 参数说明：api 索引序号', '2018-10-07 21:42:03', '2019-03-13 10:15:02', '1');
INSERT INTO `sys_api` VALUES ('33', '00000000001', '1', '待激活用户列表', '831c282ac2', 'SELECT a.id _id,fullname,dept_name FROM sys_user a INNER JOIN sys_dept b on a.dept_id=b.id where actived=0', '', '', '2018-10-08 00:01:18', '2019-03-13 10:15:02', '1');
INSERT INTO `sys_api` VALUES ('34', '00000000001', '1', '用户类型列表', 'ad64451402', 'SELECT type_id id,type_name value FROM sys_user_types a', '', '', '2018-10-08 11:38:27', '2019-03-13 10:15:02', '1');
INSERT INTO `sys_api` VALUES ('35', '00000000001', '1', '用户激活', '8c99b29613', 'update sys_user set user_type = ?,menu_id=?,actived = 1 where id=?', 'user_type,menu_id,_id', '@id:_id. 参数说明：api 索引序号', '2018-10-08 12:01:56', '2019-03-13 10:15:02', '1');
INSERT INTO `sys_api` VALUES ('36', '00000000016', '1', 'MES登录', '70b95faf0d', 'SELECT user_id sys_uid,User_Desc username,Username uid FROM Users_Base a WHERE User_Desc IS NOT NULL AND ( ? IN (user_desc,username) ) AND UPPER ( SUBSTRING ( SUBSTRING ( sys.fn_sqlvarbasetostr ( HashBytes (\'MD5\',cast(? as varchar)) ),3,32 ),9,16 ) ) = Password', 'username,password', '', '2019-03-29 14:15:29', '2019-04-02 11:35:53', '1');
INSERT INTO `sys_api` VALUES ('37', '00000000001', '1', '代理登录_更新密码', '9764cfb047', 'UPDATE sys_user set psw=? where username=? and sys_id=?', 'password,username,sys_id', '', '2019-04-02 11:53:02', '2019-04-08 18:41:55', '1');
INSERT INTO `sys_api` VALUES ('38', '00000000001', '1', '代理登录_是否已经添加过', '35c95de3bb', 'SELECT id,sys_id FROM sys_user where username=?', 'uid', '', '2019-04-02 11:55:38', '2019-04-02 12:34:40', '1');
INSERT INTO `sys_api` VALUES ('52', '00000000002', '1', '插入抽样车号列表', 'c5f6f72a3c', 'insert into dbo.print_sample_cartlist(cart_number,gz_no,code_no,proc_name,class_name,machine_name,captain_name,print_date,week_name,prod_name,week_num,rec_time,user_name) values ?', 'values', '@desc:批量插入数据时，约定使用二维数组values参数，格式为[[cart_number,gz_no,code_no,proc_name,class_name,machine_name,captain_name,print_date,week_name,prod_name,week_num,rec_time,status ]]，数组的每一项表示一条数据', '2019-03-11 17:39:29', '2019-03-30 14:35:38', '1');
INSERT INTO `sys_api` VALUES ('53', '00000000002', '1', '插入机台列表', '807bb22f83', 'insert into dbo.print_sample_machine(machine_name,check_num,week_num,rec_time ) values ?', 'values', '@desc:批量插入数据时，约定使用二维数组values参数，格式为[[machine_name,check_num,week_num,sample_num,rec_time ]]，数组的每一项表示一条数据', '2019-03-11 17:39:29', '2019-03-30 14:35:38', '1');
INSERT INTO `sys_api` VALUES ('54', '00000000002', '1', '已领取车号数', '40614909a0', 'select count(distinct cart_number) nums from print_sample_cartlist a where week_num=? and convert(varchar(4),rec_time,112)=convert(varchar(4),getdate(),112)', 'week_num', '', '2019-03-11 17:39:29', '2019-05-28 17:09:23', '1');
INSERT INTO `sys_api` VALUES ('55', '00000000002', '1', '本周待检车号列表', '38989f6661', 'SELECT a.cart_number 车号,a.gz_no + a.code_no 冠字,a.machine_name 机台,CONVERT (VARCHAR,a.print_date,120) 印刷时间,(case when lock_date is null then \'\' else CONVERT (VARCHAR,a.lock_date,120) end) 完工时间,a.prod_name 品种,a.week_num 周数,a.user_name 领用人 FROM print_sample_cartlist a WHERE id IN ( SELECT MIN (a.id) id FROM print_sample_cartlist a WHERE CONVERT (VARCHAR,rec_time,112) BETWEEN ? AND ? AND proc_name = \'印码\' AND A.STATUS = ? GROUP BY cart_number ) ORDER BY 5,4', 'tstart,tend,status', '', '2019-03-11 17:39:29', '2019-03-13 10:10:50', '1');
INSERT INTO `sys_api` VALUES ('56', '00000000002', '1', '人工抽检领活', 'fe353b42f0', 'update print_sample_cartlist set status = 1,lock_date=getdate() where cart_number in (?)', 'cart_number', '', '2019-03-11 17:39:29', '2019-03-18 18:06:05', '1');
INSERT INTO `sys_api` VALUES ('57', '00000000002', '1', '人工抽检更新设备抽检数', '6968997cb2', 'update print_sample_machine set sample_num=sample_num+1 where machine_name in (SELECT machine_name FROM print_sample_cartlist where cart_number=?) and week_num in (SELECT week_num FROM print_sample_cartlist where cart_number=?)', 'cart1,cart2', '', '2019-03-11 17:39:29', '2019-03-30 14:35:38', '1');
INSERT INTO `sys_api` VALUES ('58', '00000000002', '1', '各机台产品抽检情况', '0695d9575b', 'select a.machine_name 设备,a.check_num 预计抽检,a.week_num 周数,a.sample_num 实际抽检 from dbo.print_sample_machine as a where convert(varchar,a.rec_time,112) between ? and ? order by 4,1', 'tstart,tend', '', '2019-03-11 17:39:29', '2019-03-13 10:10:54', '1');
INSERT INTO `sys_api` VALUES ('59', '00000000002', '1', 'SQL Server Test', 'a08b99bd2e', 'SELECT 生产日期 AS 日期,品种,round(AVG(好品率),2) AS 好品率 FROM [dbo].[view_print_hecha] WHERE 生产日期 = ( SELECT max(producedate) FROM MaHouData ) GROUP BY 品种,生产日期 UNION ALL SELECT 生产日期 / 100 AS 日期,品种,round(AVG(好品率),2) AS 好品率 FROM [dbo].[view_print_hecha] WHERE 生产日期 / 100 = ( SELECT TOP 1 producedate / 100 FROM MaHouData WHERE ProduceDate < ( SELECT MAX (ProduceDate) FROM mahoudata ) ORDER BY ProduceDate DESC ) GROUP BY 品种,生产日期 / 100', '', '', '2019-03-11 17:39:29', '2019-03-13 10:15:56', '1');
INSERT INTO `sys_api` VALUES ('60', '00000000005', '1', '小张核查 orcl 测试', '50a6bb93e0', 'select to_char(sysdate,\'yyyy-mm-dd hh24:mi:ss\') \"rec_time\" from dual', '', '', '2019-03-11 17:39:29', '2019-03-13 10:15:56', '1');
INSERT INTO `sys_api` VALUES ('61', '00000000006', '1', '在线清数 ORCL测试', '61e867bb5e', 'select to_char(sysdate,\'yyyy-mm-dd hh24:mi:ss\') \"rec_time\" from dual', '', '', '2019-03-11 17:39:29', '2019-03-13 10:15:56', '1');
INSERT INTO `sys_api` VALUES ('62', '00000000007', '1', '码后核查orcl测试', 'f758cd6d70', 'select to_char(sysdate,\'yyyy-mm-dd hh24:mi:ss\') \"rec_time\" from dual', '', '', '2019-03-11 17:39:29', '2019-03-13 10:15:56', '1');
INSERT INTO `sys_api` VALUES ('63', '00000000008', '1', 'czuser orcl测试', '7fb0e137f3', 'select to_char(sysdate,\'yyyy-mm-dd hh24:mi:ss\') \"rec_time\" from dual', '', '', '2019-03-11 17:39:29', '2019-03-13 10:15:56', '1');
INSERT INTO `sys_api` VALUES ('64', '00000000009', '1', '装箱系统 ORCL数据测试', '71bd431830', 'select to_char(sysdate,\'yyyy-mm-dd hh24:mi:ss\') \"rec_time\" from dual', '', '', '2019-03-11 17:39:29', '2019-03-13 10:15:56', '1');
INSERT INTO `sys_api` VALUES ('65', '00000000010', '1', '装箱系统历史数据 orcl测试', 'd2989b3785', 'select to_char(sysdate,\'yyyy-mm-dd hh24:mi:ss\') \"rec_time\" from dual', '', '', '2019-03-11 17:39:29', '2019-03-13 10:15:56', '1');
INSERT INTO `sys_api` VALUES ('66', '00000000011', '1', '数据共享平台 orcl测试', '18342475c8', 'select to_char(sysdate,\'yyyy-mm-dd hh24:mi:ss\') \"rec_time\" from dual', '', '', '2019-03-11 17:39:29', '2019-03-13 10:15:56', '1');
INSERT INTO `sys_api` VALUES ('67', '00000000013', '1', '库管系统 ORCL测试', '0d8da674d3', 'select to_char(sysdate,\'yyyy-mm-dd hh24:mi:ss\') \"rec_time\" from dual', '', '', '2019-03-11 17:39:29', '2019-03-13 10:15:56', '1');
INSERT INTO `sys_api` VALUES ('68', '00000000014', '1', '机台作业 orcl测试', '5fb1f54e1f', 'select to_char(sysdate,\'yyyy-mm-dd hh24:mi:ss\') \"rec_time\" from dual', '', '', '2019-03-11 17:39:29', '2019-03-13 10:15:56', '1');
INSERT INTO `sys_api` VALUES ('69', '00000000014', '1', '产品抽检车号原始记录', 'bafd099930', 'SELECT a.车号,a.冠号,a.字号,a.工序,a.班次,a.机台,a.机长,to_char(a.开始时间,\'YYYY-MM-DD\') 生产日期,to_char(a.开始时间,\'hh24:mi:ss\') 开始时间,to_char(a.开始时间,\'day\') 星期,(case when to_char(a.开始时间,\'day\')=\'星期一\' then 1 when to_char(a.开始时间,\'day\')=\'星期二\' then 2 when to_char(a.开始时间,\'day\')=\'星期三\' then 3 when to_char(a.开始时间,\'day\')=\'星期四\' then 4 when to_char(a.开始时间,\'day\')=\'星期五\' then 5 when to_char(a.开始时间,\'day\')=\'星期六\' then 6 else 7 end) dayIdx,a.品种 FROM CDYC_USER.VIEW_CARTFINDER a where substr(a.工序,0,1) in (\'胶\',\'凹\',\'印\',\'丝\') and a.车号 in (SELECT a.车号 FROM CDYC_USER.VIEW_CARTFINDER a where to_char(a.开始时间,\'YYYYMMDD\') between ? and ? and a.工艺=\'码后核查\' and a.工序=\'印码\' ) and(a.工序<>\'印码\' or (a.工序=\'印码\' and to_char(a.开始时间,\'YYYYMMDD\') between ? and ? ) ) order by 4,6,11,9', 'tstart,tend,tstart2,tend2', '', '2019-03-11 17:39:29', '2019-03-30 14:35:38', '1');
INSERT INTO `sys_api` VALUES ('70', '00000000002', '1', '印码机台列表', '75b4becb09', 'SELECT rtrim(MachineName) name FROM MachineData where MachineTypeID between 1 and 6 order by MachineID', '', '', '2019-03-11 17:39:29', '2019-03-30 14:35:38', '1');
INSERT INTO `sys_api` VALUES ('71', '00000000002', '1', '印钞品种列表', '0fff65bc40', 'select ProductID value,rtrim(ProductName) name from ProductData a where status=1 order by 2', '', '', '2019-03-11 17:39:29', '2019-05-15 14:16:19', '1');
INSERT INTO `sys_api` VALUES ('72', '00000000002', '1', '异常产品原因列表', '2b853fe9ed', 'select DISTINCT abnormal_type proc_name from Print_Abnormal_Prod', '', '', '2019-03-11 17:39:29', '2019-03-13 10:11:06', '1');
INSERT INTO `sys_api` VALUES ('73', '00000000002', '1', '异常产品车号列表', '2dcf6571e6', 'SELECT a.[品种],a.[车号],a.[生产日期],a.[工序],a.[设备],a.[机长],a.[异常类型],a.[工艺],a.[完成状态],a.[备注],a.[记录时间],a.记录人 FROM view_print_abnormal_prod a where a.记录日期 between ? and ? and only_lock_cart = ? order by a.id desc', 'tstart,tend,only_lock_cart', '', '2019-03-11 17:39:29', '2019-03-13 10:11:06', '1');
INSERT INTO `sys_api` VALUES ('74', '00000000002', '1', '按开始时间插入四新计划', '05807b4c13', 'insert into dbo.print_newproc_plan(date_type,machine_name,proc_name,prod_id,reason,num1,num2,proc_stream1,proc_stream2,rec_date1,rec_time,task_name,user_name ) values (?,?,?,?,?,?,?,?,?,?,?,?,?)', 'date_type,machine_name,proc_name,prod_id,reason,num1,num2,proc_stream1,proc_stream2,rec_date1,rec_time,task_name,user_name', '', '2019-03-11 17:39:29', '2019-03-19 08:11:17', '1');
INSERT INTO `sys_api` VALUES ('75', '00000000002', '1', '四新计划列表', '6ac934ad66', 'SELECT * FROM view_print_newproc_plan WHERE replace(left(记录时间,10),\'-\',\'\') BETWEEN ? AND ? ORDER BY id DESC', 'tstart,tend', '', '2019-03-11 17:39:29', '2019-03-13 10:11:28', '1');
INSERT INTO `sys_api` VALUES ('76', '00000000002', '1', '按时间范围插入四新计划', 'e261b7e26b', 'insert into dbo.print_newproc_plan(date_type,machine_name,proc_name,prod_id,reason,proc_stream1,rec_date1,rec_date2,rec_time,task_name,user_name ) values (?,?,?,?,?,?,?,?,?,?,?)', 'date_type,machine_name,proc_name,prod_id,reason,proc_stream1,rec_date1,rec_date2,rec_time,task_name ,user_name', '', '2019-03-11 17:39:29', '2019-03-30 14:35:38', '1');
INSERT INTO `sys_api` VALUES ('77', '00000000002', '1', '添加异常品', 'd9072e2900', 'insert into print_abnormal_prod(prod_id,cart_number,rec_date,machine_name,reason,proc_stream,proc_name,captain_name,prod_date,abnormal_type,user_name) values (?,?,?,?,?,?,?,?,?,?,?)', 'prod_id,cart_number,rec_date,machine_name,reason,proc_stream,proc_name,captain_name,prod_date,abnormal_type,user_name', '', '2019-03-11 17:39:29', '2019-03-21 08:56:02', '1');
INSERT INTO `sys_api` VALUES ('78', '00000000002', '1', '未完成的全检任务计划列表', 'b36aab89f7', 'SELECT a.id,a.date_type,a.machine_name,a.proc_name,rtrim(b.ProductName) ProductName,a.reason,isnull(a.num1,0) num1,isnull(a.num2,0) num2,a.proc_stream1,a.proc_stream2,CONVERT (VARCHAR,a.rec_date1,112) rec_date1,CONVERT (VARCHAR,a.rec_date2,112) rec_date2,a.complete_num,a.complete_status,a.alpha_num FROM dbo.print_newproc_plan AS a INNER JOIN ProductData b on a.prod_id = b.ProductID WHERE a.complete_status = 0', '', '', '2019-03-11 17:39:29', '2019-03-13 10:10:18', '1');
INSERT INTO `sys_api` VALUES ('79', '00000000014', '1', '冠字查车号', '797066c5d6', 'SELECT 车号 \"cartNumber\",冠号 carNumber,字号 gzNumber,工艺 techTypeName,工序 \"procName\",班次 workClassName,机台 \"machineName\",机长 \"captainName\",班组 teamName,班长 monitorName,产量 printNum,to_char(开始时间,\'YYYY-MM-DD hh24:mi:ss\') \"startDate\",品种 productName FROM CDYC_USER.VIEW_CARTFINDER A WHERE 品种 = ? AND ( ( 冠号 = ? AND 字号 BETWEEN ? AND ? ) OR ( 冠号 = ? AND 字号 BETWEEN ? AND ? ) ) ORDER BY 开始时间', 'prod,alpha,start,end,alpha2,start2,end2', '', '2019-03-11 17:39:29', '2019-03-13 10:12:11', '1');
INSERT INTO `sys_api` VALUES ('80', '00000000002', '1', '添加机检弱项信息', 'c2f98ddf63', 'insert into print_machinecheck_weak(prod_id,code_num,cart_number,proc_name,machine_name,captain_name,fake_type,paper_num,level_type,img_url,remark,rec_time,print_time,user_name ) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?)', 'prod_id,code_num,cart_number,proc_name,machine_name,captain_name,fake_type,paper_num,level_type,img_url,remark,rec_time,print_time,user_name', '', '2019-03-11 17:39:30', '2019-03-13 15:11:52', '1');
INSERT INTO `sys_api` VALUES ('81', '00000000002', '1', '机检弱项记废列表', 'a22afbf675', 'SELECT distinct a.[品种],a.[号码信息],a.[车号],a.[工序],a.[设备],a.[机长],a.[类型],a.[张数],a.[记废等级],a.[缺陷图像],a.[备注],a.印刷时间,a.[登记时间] ,a.登记人,a.裁封机长 FROM view_print_machinecheck_weak a where 登记日期 between ? and ? order by a.[登记时间] desc', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-05-28 11:00:13', '1');
INSERT INTO `sys_api` VALUES ('82', '00000000014', '1', '车号信息查询', '882df77c3a', 'SELECT 车号 cartNumber,冠号 carNumber,字号 gzNumber,工艺 techTypeName,工序 procName,班次 workClassName,机台 machineName,机长 captainName,班组 teamName,班长 monitorName,产量 printNum,to_char(开始时间,\'YYYY-MM-DD hh24:mi:ss\') startDate,品种 productName FROM CDYC_USER.VIEW_CARTFINDER A WHERE 车号 = ? ORDER BY 开始时间', 'cart', '', '2019-03-11 17:39:30', '2019-03-30 14:35:38', '1');
INSERT INTO `sys_api` VALUES ('83', '00000000002', '1', '机台连续废信息通知', '3475990fbf', 'insert into print_machinecheck_multiweak(cart_number,prod_id,proc_name,machine_name,captain_name,fake_type,kilo_num,pos_info,remark,rec_time,fake_num,user_name ) values (?,?,?,?,?,?,?,?,?,?,?,?)', 'cart_number,prod_id,proc_name,machine_name,captain_name,fake_type,kilo_num,pos_info,remark,rec_time,fake_num,user_name', '', '2019-03-11 17:39:30', '2019-03-30 14:35:38', '1');
INSERT INTO `sys_api` VALUES ('84', '00000000002', '1', '机台是否通知作废信息', '4c10668fdd', 'select a.cart_number,a.machine_name,a.captain_name,a.fake_type,a.kilo_num,a.pos_info,a.remark,convert(varchar,a.rec_time,112) rec_time from print_machinecheck_multiweak a where a.cart_number=?', 'cart_number', '', '2019-03-11 17:39:30', '2019-03-13 10:12:13', '1');
INSERT INTO `sys_api` VALUES ('85', '00000000002', '1', '增加冠字号段验证计划', '4f8c1cbb45', 'insert into print_newproc_plan(alpha_num,date_type,num1,num2,proc_name,proc_stream1,prod_id,reason,rec_time ,task_name,user_name ) values (?,?,?,?,?,?,?,?,?,?,?)', 'alpha_num,date_type,num1,num2,proc_name,proc_stream1,prod_id,reason,rec_time,task_name ,user_name', '', '2019-03-11 17:39:30', '2019-03-30 14:35:38', '1');
INSERT INTO `sys_api` VALUES ('86', '00000000014', '1', '根据车号查询生产信息', '2f2847fddf', 'select distinct 工序 \"proc_name\",机台 \"machine_name\",机长 \"captain_name\",to_char(开始时间,\'yyyymmdd\') \"start_time\" from view_cartfinder t where t.车号=? order by 4 desc', 'cart', '', '2019-03-11 17:39:30', '2019-03-30 14:35:38', '1');
INSERT INTO `sys_api` VALUES ('87', '00000000002', '1', '流转工艺列表', 'a7835c9ebc', 'select proc_stream_id value ,proc_stream_name name from print_newproc_type a where is_hide=0', '', '', '2019-03-11 17:39:30', '2019-03-13 10:10:34', '1');
INSERT INTO `sys_api` VALUES ('88', '00000000016', '1', '印刷工序所有机台列表', '6d0e2a4781', 'SELECT DISTINCT mid machine_id,机台 machine_name,(  CASE  WHEN 工序 LIKE \'胶%\'  OR 工序 LIKE \'凹%\' THEN  \'胶凹制作部\'  WHEN 工序 IN (\'白纸\',\'过数\') THEN  \'数管制作部\'  WHEN 工序 IN (\'印码\',\'丝印\',\'涂布\') THEN  \'印码制作部\'  ELSE  \'检封制作部\'  END ) as dept_name FROM v_cbpc_cartlist order by 3,2', '', '', '2019-03-11 17:39:30', '2019-03-29 16:40:13', '1');
INSERT INTO `sys_api` VALUES ('89', '00000000016', '1', '机台最近开印品种', 'cab08fa0d8', 'SELECT TOP 1 t.品种 prod_type FROM v_cbpc_cartlist t WHERE 机台 = ? AND 完成时间 IS NOT NULL ORDER BY 完成时间 DESC', 'machine_name', '', '2019-03-11 17:39:30', '2019-04-09 14:39:50', '1');
INSERT INTO `sys_api` VALUES ('90', '00000000002', '1', '更新四新计划状态信息', 'a6c66f8d72', 'update print_newproc_plan set complete_num = ?,complete_status = ?,update_time = ? where id=?', 'complete_num,complete_status,update_time,_id', '@id:_id. 参数说明：api 索引序号', '2019-03-11 17:39:30', '2019-03-19 08:12:07', '1');
INSERT INTO `sys_api` VALUES ('91', '00000000002', '1', '记录库管系统日志信息', 'f0500427cb', 'insert into print_wms_log(remark,rec_time) values ?', 'values', '@desc:批量插入数据时，约定使用二维数组values参数，格式为[{remark,rec_time,return_info }]，数组的每一项表示一条数据', '2019-03-11 17:39:30', '2019-03-13 13:30:03', '1');
INSERT INTO `sys_api` VALUES ('92', '00000000002', '1', '批量插入立体库四新计划工艺流转信息', 'db02022755', 'insert into dbo.print_wms_proclist(cart_number,gz_num,proc_plan,proc_real,rec_time,check_type,task_id ) values ?', 'values', '@desc:批量插入数据时，约定使用二维数组values参数，格式为[{cart_number,gz_num,proc_plan,proc_real,rec_time }]，数组的每一项表示一条数据', '2019-03-11 17:39:30', '2019-03-13 18:52:03', '1');
INSERT INTO `sys_api` VALUES ('93', '00000000002', '1', '未处理的异常品列表', 'ba126b61bf', 'SELECT distinct a.cart_number,a.proc_stream,a.id FROM Print_Abnormal_Prod a where a.id in (select max(a.id) id from Print_Abnormal_Prod a where complete_status=0 group by a.cart_number)', '', '', '2019-03-11 17:39:30', '2019-03-13 10:10:18', '1');
INSERT INTO `sys_api` VALUES ('94', '00000000002', '1', '记录异常品任务处理状态为已完成', 'ae030c585f', 'update Print_Abnormal_Prod set complete_status=1 where cart_number=?', 'cart_number', '', '2019-03-11 17:39:30', '2019-03-13 11:17:04', '1');
INSERT INTO `sys_api` VALUES ('95', '00000000002', '1', '更新NodeJS 服务心跳', 'e04e4b3593', 'insert into dbo.print_wms_heartbeat(rec_time,task_name ) values (?,?)', 'rec_time,task_name', '', '2019-03-11 17:39:30', '2019-03-30 14:35:38', '1');
INSERT INTO `sys_api` VALUES ('96', '00000000002', '1', '查询NodeJS 服务心跳', '8d7c52c835', 'SELECT a.rec_time,a.task_name FROM dbo.print_wms_heartbeat AS a', '', '', '2019-03-11 17:39:30', '2019-03-13 10:10:18', '1');
INSERT INTO `sys_api` VALUES ('97', '00000000002', '1', '更新Nodejs 服务心跳', 'c7677a2271', 'update dbo.print_wms_heartbeat set rec_time = ? where task_name = ?', 'rec_time,task_name', '', '2019-03-11 17:39:30', '2019-03-13 10:10:18', '1');
INSERT INTO `sys_api` VALUES ('98', '00000000002', '1', '自动排活待处理列表', '6fc36fa52a', 'SELECT DISTINCT a.cart_number,a.gz_no + a.code_no gz_num FROM print_sample_cartlist a WHERE ( lock_status = 0 OR lock_status IS NULL ) AND proc_name = \'印码\'', '', '', '2019-03-11 17:39:30', '2019-03-30 14:38:09', '1');
INSERT INTO `sys_api` VALUES ('99', '00000000002', '1', '连续废通知未生产完毕车号列表', '4c9141bdd3', 'select id,cart_number,isnull(last_proc,proc_name) last_proc,isnull(last_machine,machine_name) last_machine,convert(varchar,isnull(last_rec_time,rec_time),120) rec_time from print_machinecheck_multiweak a where a.id in (SELECT max(id) id FROM print_machinecheck_multiweak where complete_status=0 or complete_status is null group by cart_number)', '', '', '2019-03-11 17:39:30', '2019-03-13 10:10:19', '1');
INSERT INTO `sys_api` VALUES ('100', '00000000014', '1', '车号最近生产工序', '60d5ad27ec', 'select 车号 \"cart_number\",工序 \"last_proc\",机台 \"machine_name\" ,to_char(开始时间,\'YYYY-MM-DD HH24:mi:ss\') \"rec_time\" from VIEW_CARTFINDER where key_recid in (select max(key_recid) key_recid from VIEW_CARTFINDER t where 车号 in (?) group by 车号) and 车号 in (?)', 'cart1,cart2', '', '2019-03-11 17:39:30', '2019-03-30 14:38:09', '1');
INSERT INTO `sys_api` VALUES ('101', '00000000002', '1', '更新连续废通知产品生产进度信息', 'f4f2a8ef0f', 'update print_machinecheck_multiweak set last_proc = ?,last_machine = ?,last_rec_time = ? where id=?', 'last_proc,last_machine,last_rec_time,_id', '@id:_id. 参数说明：api 索引序号', '2019-03-11 17:39:30', '2019-03-26 17:02:50', '1');
INSERT INTO `sys_api` VALUES ('102', '00000000002', '1', '根据id信息查询连续废通知情况', 'fe64360a81', 'select * from [dbo].[print_machinecheck_multiweak] where id=?', '_id', '@id:_id. 参数说明：api 索引序号', '2019-03-11 17:39:30', '2019-03-30 14:38:09', '1');
INSERT INTO `sys_api` VALUES ('103', '00000000002', '1', '连续废通知产品已完工', '1db66c49a0', 'update print_machinecheck_multiweak set complete_status = 1 where id=?', '_id', '@id:_id. 参数说明：api 索引序号', '2019-03-11 17:39:30', '2019-03-28 14:11:45', '1');
INSERT INTO `sys_api` VALUES ('104', '00000000002', '1', '待检车号列表', 'f0241dd3d4', 'SELECT DISTINCT a.cart_number 车号,a.gz_no + a.code_no 冠字,a.machine_name 机台,( CASE WHEN a.week_name = \'星期一\' THEN \'是\' ELSE \'否\' END ) 周一,convert(varchar,a.print_date,120) 印刷时间,a.prod_name 品种,a.week_num 周数,a.status 领取状态 FROM print_sample_cartlist a WHERE proc_name = \'印码\' ORDER BY a.status,5', '', '', '2019-03-11 17:39:30', '2019-03-30 14:38:09', '1');
INSERT INTO `sys_api` VALUES ('105', '00000000014', '1', '车号查冠字', '8081338dc1', 'select distinct 车号 \"cart_number\",冠号||字号 \"gz_num\" from view_cartfinder t where t.车号 in (?)', 'carnos', '', '2019-03-11 17:39:30', '2019-03-30 14:38:09', '1');
INSERT INTO `sys_api` VALUES ('106', '00000000014', '1', '机台从某天起生产的X万产品车号列表', '934af4f8b4', 'select a.车号 from (select a.车号,min(row_num) row_num from (select distinct 车号,row_number() over ( order by 开始时间) row_num from view_cartfinder a where a.机台=? and to_char(开始时间,\'YYYYMMDD\') >=?) a group by a.车号 order by 2) a where rownum<=?', 'machine_name, rec_date, max_carts', '', '2019-03-11 17:39:30', '2019-03-30 14:38:09', '1');
INSERT INTO `sys_api` VALUES ('107', '00000000014', '1', '机台某段时间生产的车号列表', 'bf34cf0c07', 'select 车号 from view_cartfinder a where a.机台=? and to_char(开始时间,\'YYYYMMDD\') between ? and ? order by a.开始时间', 'machine_name,         rec_date1,         rec_date2', '', '2019-03-11 17:39:30', '2019-03-30 14:38:09', '1');
INSERT INTO `sys_api` VALUES ('108', '00000000014', '1', '某冠字号段车号列表', 'ee7ddb80c4', 'select distinct 车号,a.字号 from view_cartfinder a where a.品种=? and a.冠号=? and a.字号 between ? and ? order by a.字号', 'prod_name, gz, start_no, end_no', '', '2019-03-11 17:39:30', '2019-03-30 14:38:09', '1');
INSERT INTO `sys_api` VALUES ('109', '00000000002', '1', '过滤已处理的四新或异常品车号列表', '95aa0001e8', 'select distinct cart_number from print_wms_proclist where check_type=? and task_id=? and len(cart_number)>0', 'check_type,task_id', '', '2019-03-11 17:39:30', '2019-03-29 18:30:36', '1');
INSERT INTO `sys_api` VALUES ('110', '00000000002', '1', '机检弱项产品作废汇总', 'b579b29ab8', 'SELECT a.[品种],a.[工序],a.[设备],a.[机长],a.[类型],(case when a.[记废等级]=0 then 0 else a.[记废等级]+1 end ) 记废等级,sum(a.[张数]) 总张数,count(a.[记废等级]) 次数,sum(a.张数*a.记废等级) 总作废开数 FROM view_print_machinecheck_weak a WHERE 登记日期 BETWEEN ? AND ? group by a.[品种],a.[工序],a.[设备],a.[机长],a.[类型],(case when a.[记废等级]=0 then 0 else a.[记废等级]+1 end ) order by 9 desc', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-13 10:12:18', '1');
INSERT INTO `sys_api` VALUES ('111', '00000000002', '1', '各机台弱项类型汇总', '0dfc50bc58', 'SELECT a.[品种],a.[工序],a.[设备],a.[机长],a.[类型],sum(a.[张数]) 总张数,count(a.[记废等级]) 次数,sum(a.张数*a.记废等级) 总作废开数 FROM view_print_machinecheck_weak a WHERE 登记日期 BETWEEN ? AND ? group by a.[品种],a.[工序],a.[设备],a.[机长],a.[类型] order by 8 desc', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-13 10:12:19', '1');
INSERT INTO `sys_api` VALUES ('112', '00000000002', '1', '胶凹设备机检弱项分布', 'e91457516b', 'SELECT a.[品种],a.[工序],a.[设备],a.[类型],sum(a.[张数]) 总张数,count(a.[记废等级]) 次数 FROM view_print_machinecheck_weak a WHERE 登记日期 BETWEEN ? AND ? group by a.[品种],a.[工序],a.[设备],a.[类型] order by 6 desc', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-13 10:12:19', '1');
INSERT INTO `sys_api` VALUES ('113', '00000000002', '1', '当前车号已输入信息', '898aa211d8', 'SELECT a.[品种],a.[号码信息],a.[车号],a.[工序],a.[设备],a.[机长],a.[类型],a.[张数],a.[记废等级],a.[缺陷图像],a.[备注],a.[登记时间] FROM view_print_machinecheck_weak a where a.[车号] =? order by a.[登记时间] desc', 'cart', '', '2019-03-11 17:39:30', '2019-03-13 10:12:12', '1');
INSERT INTO `sys_api` VALUES ('114', '00000000002', '1', '印码机检设备弱项统计信息', 'da79e3d38c', 'SELECT d.ProductName 品种,a.fake_type 类型,c.MachineName 机检设备,sum(a.paper_num) 总张数,count(a.paper_num) 次数 FROM print_machinecheck_weak a INNER JOIN MaHouData b on a.cart_number=b.CartNumber INNER JOIN MachineData c on c.MachineID=b.MachineID INNER JOIN ProductData d on d.ProductID=a.prod_id where convert(varchar,rec_time,112) between ? and ? group by d.ProductName,a.fake_type,c.MachineName order by 4 desc', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-13 10:12:20', '1');
INSERT INTO `sys_api` VALUES ('115', '00000000002', '1', '下机产品通知已完成状态以及工序', '296ec53c58', 'update print_wms_proclist set process_name=? ,complete_status=? where cart_number=?', 'process,status,cart', '', '2019-03-11 17:39:30', '2019-03-13 10:10:03', '1');
INSERT INTO `sys_api` VALUES ('116', '00000000002', '1', '当前车号是否有连续废通知', 'c96d2b8975', 'SELECT cart_number,count(*) count FROM print_machinecheck_multiweak where cart_number in (?) group by cart_number', 'cart', '', '2019-03-11 17:39:30', '2019-03-13 10:11:04', '1');
INSERT INTO `sys_api` VALUES ('117', '00000000002', '1', '领用车号后更新抽检机台信息', '3b263894ae', 'update print_sample_machine set sample_num=sample_num+1 where id in (select distinct b.id from print_sample_cartlist a INNER JOIN print_sample_machine b on a.week_num = b.week_num and a.machine_name=b.machine_name and a.cart_number in (?))', 'cart', '', '2019-03-11 17:39:30', '2019-03-18 18:06:05', '1');
INSERT INTO `sys_api` VALUES ('118', '00000000002', '1', '更新异常品完工状态', '5877893b72', 'update Print_Abnormal_Prod set complete_status=?,proc_name=?,prod_date=? where cart_number=?', 'status,process,prod_date,cart', '', '2019-03-11 17:39:30', '2019-03-13 10:10:03', '1');
INSERT INTO `sys_api` VALUES ('119', '00000000002', '1', '机台生产异常信息完工状态跟踪', 'fc4fd73e9e', 'update print_machinecheck_multiweak set complete_status=?,last_proc=?,last_rec_time=? where cart_number=?', 'status,process,prod_date,cart', '', '2019-03-11 17:39:30', '2019-03-13 10:10:03', '1');
INSERT INTO `sys_api` VALUES ('120', '00000000002', '1', '更新wms日志信息', 'e7d88969ca', 'update print_wms_log set return_info=? where id=?', 'return_info,_id', '', '2019-03-11 17:39:30', '2019-03-13 13:30:03', '1');
INSERT INTO `sys_api` VALUES ('121', '00000000002', '1', '四新及异常品人工拉号产品列表', 'fff29f5a04', 'SELECT a.cart_number 车号,a.gz_num 冠字,a.proc_plan 计划执行工艺,a.proc_real 实际执行工艺,CONVERT (VARCHAR,a.rec_time,120) 记录时间,a.check_type 验证类型,(  CASE  WHEN a.manual_check_status = 0 THEN  \'未领取\'  ELSE  \'已领取\'  END ) 领取状态,(  CASE  WHEN a.complete_status = 0 THEN  \'未完成\'  ELSE  \'已完成\'  END ) 检封完工状态,a.process_name 当前工序,isnull(b.reason,\'\') + isnull(  (  CASE  WHEN alpha_num IS NULL THEN   c.machine_name + c.proc_name + \'四新验证,\' + c.reason  ELSE   c.alpha_num + CAST (c.num1 AS VARCHAR) + \'至\' + CAST (c.num2 AS VARCHAR) + \'冠字验证\'  END  ), \'\' ) 备注,(  CASE  WHEN isnull(a.user_name,\'\') IN (\'\',\'工艺流转系统\') THEN  (   isnull(b.user_name,\'\') + isnull(c.user_name,\'\')  )  ELSE  isnull(a.user_name,\'\')  END ) 记录人 FROM print_wms_proclist a LEFT JOIN Print_Abnormal_Prod b ON a.check_type = \'异常品处理\' AND a.task_id = b.id LEFT JOIN print_newproc_plan c ON a.check_type = \'四新验证\' AND a.task_id = c.id WHERE len(a.cart_number)>0 and  a.manual_check_status = 0 AND proc_plan LIKE \'%人工拉号%\' AND CONVERT (VARCHAR,a.rec_time,112) BETWEEN ? AND ? AND a.cart_number NOT IN ( SELECT  cart_number FROM  Print_Abnormal_Prod WHERE  proc_stream = 7 ) ORDER BY (  CASE  WHEN a.check_type = \'异常品处理\' THEN  0  ELSE  1  END ),3,manual_check_status,2', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-29 16:58:49', '1');
INSERT INTO `sys_api` VALUES ('122', '00000000002', '1', '更新四新及异常品人工抽检产品领用状态', '9343c77d3b', 'update print_wms_proclist set manual_check_status=1 where cart_number in (?)', 'cart', '', '2019-03-11 17:39:30', '2019-03-13 12:58:05', '1');
INSERT INTO `sys_api` VALUES ('123', '00000000013', '1', '查询批次状态', '30b9e66419', 'select org.strorgname 库房,def.strproductname 品种,st.strcarno 车号,ps.strpsname 工序,st.intstock 数量,(case when nvl2(bl.BATCH_NO,1,0)=1 then \'锁定\' else \'未锁车\' end) 锁车状态,bl.REASON_DESC 锁车原因,nvl(tech.TECHNOLOGY_TYPE_NAME,\'不分工艺\') 工艺 from mac2.tbstock st left join mac2.vw_wim_tb_black_list bl on st.strcarno = bl.BATCH_NO left join mac2.VW_TECHNOLOGY_TYPE tech on st.strcarno=tech.CAR_NO left join mac2.tborg org on st.intorgid=org.intorgid left join mac2.tbproductdef def on def.intproductid=st.intproductid left join mac2.tbproductst ps on ps.strpscode=st.strpscode where st.strcarno in (?) and st.intstock > 0', 'carnos', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('124', '00000000002', '1', '人工拉号车号万数汇总', 'cd6e54e7e3', 'SELECT COUNT (distinct cart_number) num,0 type FROM Print_Abnormal_Prod WHERE proc_stream = 1 AND rec_date BETWEEN ? AND ? AND isnull(only_lock_cart,0) = 0 UNION ALL SELECT COUNT (distinct cart_number) num,1 type FROM print_sample_cartlist a WHERE CONVERT (VARCHAR,rec_time,112) BETWEEN ? AND ? and a.cart_number not in (select distinct cart_number from print_wms_proclist)', 'tstart,tend,tstart2,tend2', '', '2019-03-11 17:39:30', '2019-03-13 10:11:06', '1');
INSERT INTO `sys_api` VALUES ('125', '00000000016', '1', '人工拉号准许出库查询', '0ec8ee76b3', 'SELECT 车号,工序,出库序号 FROM v_cbpc_whitelist a where a.车号 in (?)', 'carnos', '', '2019-03-11 17:39:30', '2019-08-12 08:49:50', '1');
INSERT INTO `sys_api` VALUES ('126', '00000000002', '1', '本周待检车号列表', 'd8f5882e8b', 'SELECT distinct a.cart_number 车号,a.gz_no+a.code_no 冠字,a.machine_name 机台,convert(varchar,a.print_date,120) 印刷时间,a.prod_name 品种,a.week_num 周数,a.status FROM print_sample_cartlist a where convert(varchar,print_date,112) between ? and ? and proc_name=\'印码\' order by a.status ,4 desc', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-13 10:10:34', '1');
INSERT INTO `sys_api` VALUES ('127', '00000000014', '1', '根据车号列表查询机台信息', '3039fdade1', 'SELECT distinct a.机台 FROM CDYC_USER.VIEW_CARTFINDER a where substr(a.工序,0,1) in (\'胶\',\'凹\',\'印\',\'丝\') and a.车号 in (?)', 'carts', '', '2019-03-11 17:39:30', '2019-03-18 08:38:07', '1');
INSERT INTO `sys_api` VALUES ('128', '00000000002', '1', '当前时间已添加异常品车号列表', 'be6c4a1438', 'SELECT distinct cart_number FROM Print_Abnormal_Prod a where a.proc_stream=1 AND isnull(only_lock_cart,0) = 0 and a.rec_date between ? and ?', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-13 10:10:35', '1');
INSERT INTO `sys_api` VALUES ('129', '00000000002', '1', '任务处理系统服务运行状态', 'b9bf89445c', 'SELECT a.task_name,convert(varchar,rec_time,120) rec_time,datediff(SECOND,rec_time,getdate()) date_diff,(case when datediff(SECOND,rec_time,getdate())<100 then \\\'存活\\\' else \\\'异常\\\' end) live_status FROM print_wms_heartbeat a', '', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('130', '00000000015', '1', 'ERP测试接口', 'c8600eca80', 'select to_char(sysdate,\\\'yyyy-mm-dd hh24:mi:ss\\\') \"rec_time\" from dual', '', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('131', '00000000015', '1', '物料账龄报表', '6044e2a4f9', 'SELECT A .*,(  CASE  WHEN A .结存数量 = 0 THEN  \'无\'  ELSE  TO_CHAR (   MAX (b.\"创建日期\"),  \'yyyy-mm-dd\'  )  END ) 帐龄 FROM (  SELECT   物料编码, 物料名称, MAX (收入数量) 末次收入数量, MAX (收入金额) 末次收入金额, MAX (来源情况) 来源情况, MIN (付出数量) 末次发出数量, MIN (付出金额) 末次发出金额, MAX (领用说明) 领用说明, 结存数量, 结存金额, 结存位置  FROM  (   SELECT    A .\"物料编码\",  A .\"物料名称\",  (    CASE    WHEN 收入状态 = 1 THEN    A .收入数量    ELSE    0    END   ) 收入数量,  (    CASE    WHEN 收入状态 = 1 THEN    A .收入金额    ELSE    0    END   ) 收入金额,  (    CASE    WHEN 收入状态 = 1 THEN    A .来源情况    ELSE    \' \'    END   ) 来源情况,  (    CASE    WHEN 收入状态 = 0 THEN    A .收入数量    ELSE    0    END   ) 付出数量,  (    CASE    WHEN 收入状态 = 0 THEN    A .收入金额    ELSE    0    END   ) 付出金额,  (    CASE    WHEN 收入状态 = 0 THEN    A .来源情况    ELSE    \' \'    END   ) 领用说明,  b.结存数量,  b.结存金额,  b.结存位置   FROM   VIEW_CBPC_WMS_YEAR A,  view_cbpc_wms_year_count b   WHERE   A .物料编码 = \'4103.029105\'   AND (   A .TRANSACTION_ID IN (    SELECT    MAX (A .TRANSACTION_ID)    FROM    VIEW_CBPC_WMS_YEAR A    WHERE    A .物料编码 = \'4103.029105\'    AND 收入状态 = 1   )   OR A .TRANSACTION_ID IN (    SELECT    MAX (A .TRANSACTION_ID)    FROM    VIEW_CBPC_WMS_YEAR A    WHERE    A .物料编码 = \'4103.029105\'    AND 收入状态 = 0   )   )   AND b.物料编码 = \'4103.029105\'  ) A  GROUP BY   物料编码, 物料名称, 结存数量, 结存金额, 结存位置 ) A,(  SELECT  A .TRANSACTION_ID, A .\"物料编码\", A .\"物料名称\", A .创建日期, SUM (A .\"收入数量\") OVER (   PARTITION BY A .\"物料编码\"   ORDER BY   A .TRANSACTION_ID DESC  ) 累计库存  FROM  VIEW_CBPC_WMS_YEAR A  WHERE  A .物料编码 = \'4103.029105\'  AND A .收入状态 = 1 ) b WHERE A .结存数量 < b.\"累计库存\" GROUP BY  A .物料编码,A .物料名称,A .末次收入数量,A .末次收入金额,A .来源情况,A .末次发出数量,A .末次发出金额,A .领用说明,A .结存数量,A .结存金额,A .结存位置', '', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('132', '00000000016', '1', '查询批次状态', '6ac1e30d85', 'SELECT v_Storage.StorageDesc AS 库房,replace(udt_tb_WipInventory.ProdTypeDesc,\'品\',\'\') AS 品种,udt_tb_WipInventory.CarNo AS 车号,v_process_path.ShortCode 工序,udt_tb_WipInventory.Total 数量,case when udt_tb_WipInventory.IsLock = 1 then \'锁定\' else \'未锁定\' end 锁车状态,Event_Reasons.Event_Reason_Code 锁车原因,udt_tb_WipInventory.ProcessLine_Desc 工艺 FROM udt_tb_WipInventory INNER JOIN Products on udt_tb_WipInventory.ProdTypeId=Products.Prod_Id inner join Engineering_Unit on udt_tb_WipInventory.Unit=Engineering_Unit.Eng_Unit_Id LEFT JOIN udt_pp_LockCar ON udt_tb_WipInventory.CarNo = udt_pp_LockCar.CarNumber AND udt_pp_LockCar.Event_Status = \'2002\' LEFT JOIN Event_Reasons ON udt_pp_LockCar.Reason = Event_Reasons.Event_Reason_Id INNER JOIN v_Storage ON udt_tb_WipInventory.CurrentUnit_Id = v_Storage.StorageId INNER JOIN v_process_path ON udt_tb_WipInventory.Path_Code = v_process_path.Path_Code WHERE (v_Storage.StorageTypeCode IN (\'ZZPK\',\'BZJGK\',\'ZZPLTK\')) AND (udt_tb_WipInventory.CarNo IN (?))', 'carnos1', '', '2019-03-11 17:39:30', '2019-03-13 10:11:04', '1');
INSERT INTO `sys_api` VALUES ('133', '00000000014', '1', '指定车号列表生产原始信息', '3ecce127ce', 'SELECT a.车号,   a.冠号,   a.字号,   a.工序,   a.班次,   a.机台,   a.机长,   to_char(a.开始时间,\\\'YYYY-MM-DD\\\') 生产日期,   to_char(a.开始时间,\\\'hh24:mi:ss\\\') 开始时间,   to_char(a.开始时间,\\\'day\\\') 星期,   (case     when to_char(a.开始时间,\\\'day\\\') = \\\'星期一\\\' then      1     when to_char(a.开始时间,\\\'day\\\') = \\\'星期二\\\' then      2     when to_char(a.开始时间,\\\'day\\\') = \\\'星期三\\\' then      3     when to_char(a.开始时间,\\\'day\\\') = \\\'星期四\\\' then      4     when to_char(a.开始时间,\\\'day\\\') = \\\'星期五\\\' then      5     when to_char(a.开始时间,\\\'day\\\') = \\\'星期六\\\' then      6     else      7    end) dayIdx,   a.品种  FROM CDYC_USER.VIEW_CARTFINDER a where substr(a.工序,0,1) in (\\\'胶\\\',\\\'凹\\\',\\\'印\\\',\\\'丝\\\')  and a.车号 in   (?)      order by 4,6,11,9', 'carts', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('134', '00000000002', '1', '产品锁车原因', 'bd88f2c112', 'with cartlist as (select ? cartnumber) SELECT DISTINCT remark,convert(varchar,rec_time,120) rec_time FROM (  SELECT  (   CASE   WHEN only_lock_cart = 1 THEN   \'【批量锁车.不拉号】\'   ELSE   \'【异常品】\'   END  ) + isnull(machine_name,\'\') + \' \' + reason + (   CASE   WHEN user_name IS NOT NULL THEN   + \'————\' + user_name   ELSE   \'\'   END  ) remark,a.rec_date rec_time  FROM  Print_Abnormal_Prod a  WHERE  cart_number = (select * from cartlist)  UNION ALL  SELECT DISTINCT   \'【人工大张日常抽检】\' remark,a.rec_time   FROM   print_sample_cartlist a  WHERE   cart_number =(select * from cartlist)  UNION ALL   SELECT DISTINCT   \'【四新验证】\' + (    CASE    WHEN user_name IS NOT NULL THEN    + \'————\' + user_name    ELSE    \'\'    END   ) remark,a.rec_time   FROM   print_wms_proclist a   WHERE   cart_number =(select * from cartlist)   AND check_type = \'四新验证\' ) a', 'cart1', '', '2019-03-11 17:39:30', '2019-03-13 10:10:27', '1');
INSERT INTO `sys_api` VALUES ('135', '00000000003', '1', '码后核查每车产品实际作废分布情况', '07f46b76c4', 'with temp_tbl as (select t.convert_sheet_number pos_idx,       substr(sheet_num,7,1) kilo_idx,       count(*) err_num,       sum(case           when t.item_flag = 3 then            1           else            0          end) fake_num      from qfm_wip_jobs a     inner join qfm_qa_inspect_master b       on a.job_id = b.job_id     inner join qfm_qa_inspect_slave t       on t.inspectm_id = b.inspectm_id     where a.cart_number = ?     group by t.convert_sheet_number,substr(sheet_num,7,1)     order by 3 desc)  select pos_idx 开位,kilo_idx 千位,err_num 缺陷条数,fake_num 实废条数 from temp_tbl where rownum<=(select count(*) from temp_tbl where fake_num>0)', 'cart', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('136', '00000000016', '1', 'mes uid', '308326df73', 'select t.user_code code,t.user_desc name,t.org_lv2_desc dept from dbo.v_Userinfo t', '', '', '2019-03-11 17:39:30', '2019-03-13 14:41:21', '1');
INSERT INTO `sys_api` VALUES ('137', '00000000002', '1', '批量锁车/解锁', 'd473b0d66a', 'select * from (SELECT a.[品种],a.[车号],a.[异常类型],a.[工艺],a.[完成状态],a.解锁状态,a.[备注],a.[记录时间],a.记录人 FROM view_print_abnormal_prod a WHERE a.记录日期 between ? and ? UNION SELECT ( CASE WHEN SUBSTRING (a.车号,3,1) = 8 THEN \'9607T\' ELSE \'960\' + SUBSTRING (a.车号,3,1) + \'A\' END ) 品种,车号,原因 异常类型,实际执行工艺 工艺,( CASE WHEN 完工状态 = 1 THEN \'已完成\' ELSE \'未完成\' END ) 完工状态,\'\' 解锁状态,isnull(备注,\'\') 备注,记录时间,isnull(记录人,\'\') 记录人 FROM [dbo].[view_print_wms_proclist] a where a.记录日期 between ? and ? and a.原因=\'批量车号工艺调整\' and 记录人 is not null ) a order by 记录时间 desc', 'tstart,tend,tstart2,tend2', '', '2019-03-11 17:39:30', '2019-05-24 22:08:01', '1');
INSERT INTO `sys_api` VALUES ('138', '00000000002', '1', '添加批量锁车车号列表', '1d999548c0', 'insert into dbo.print_abnormal_prod(prod_id,cart_number,rec_date,reason,only_lock_cart,abnormal_type,complete_status,proc_stream,user_name,unlock_date ) values ?', 'values', '@desc:批量插入数据时，约定使用二维数组values参数，格式为[{prod_id,cart_number,rec_date,reason,only_lock_cart,abnormal_type, complete_status, proc_stream }]，数组的每一项表示一条数据', '2019-03-11 17:39:30', '2019-03-13 17:34:44', '1');
INSERT INTO `sys_api` VALUES ('139', '00000000002', '1', '批量解锁', '00cbb681ae', 'update print_abnormal_prod set unlock_status = 1 ,unlock_time=getdate(),remark=? where cart_number in (?) and proc_stream=7', 'remark,carts', '', '2019-03-11 17:39:30', '2019-03-14 14:35:56', '1');
INSERT INTO `sys_api` VALUES ('140', '00000000002', '1', '批量工艺调整', '1d8a3759f2', 'insert into dbo.print_wms_proclist(cart_number,gz_num,proc_plan,proc_real,rec_time,check_type,task_id,remark,user_name ) values ?', 'values', '', '2019-03-11 17:39:30', '2019-03-18 08:39:07', '1');
INSERT INTO `sys_api` VALUES ('141', '00000000014', '1', '各机台近期生产品种列表', '058bfec815', 'SELECT t.工序,T.机台,T.品种,max(to_char(完成时间,\\\'YYYYMMDD\\\')) 最近日期  FROM VIEW_CARTFINDER T WHERE 完成时间 IS NOT NULL and to_char(完成时间,\\\'YYYYMMDD\\\') BETWEEN ? and ? group by T .品种,t.工序,T .机台 order by 1,2,3', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('142', '00000000013', '1', '数管-立库当日请求响应', '14f0d45c88', 'SELECT T.mes_manage_num \"mesid\",   T.asrs_manage_num \"asrsid\",   T.recpay_type \"recpaytype\",   T.business_type \"businesstype\",   T.isoffline \"isoffline\",   TO_CHAR(T.insert_time,\'yyyy-mm-dd hh24:mi:ss\') \"insertat\",   TO_CHAR(T.update_time,\'yyyy-mm-dd hh24:mi:ss\') \"updateat\",   TO_CHAR(T.task_start_time,\'yyyy-mm-dd hh24:mi:ss\') \"taskstart\",   TO_CHAR(T.task_end_time,\'yyyy-mm-dd hh24:mi:ss\') \"taskend\",   T.status_code \"status\",   T.check_status \"checkstatus\",   T.check_msg \"checkmsg\",   T.recpay_status \"syncstatus\",   T.direction \"pickuplocation\",   T.goods_code \"prodid\",   prod.strproductno \"prodcode\",   st.strpscode \"processcode\",   st.strpsname \"processname\",   T.branch_code \"techcode\",   T.review \"reviewtag\",   T.batch_no \"carno\",   T.manage_quantity_one \"quantitya\",   T.manage_quantity_two \"quantityb\",   T.quantity \"quantitytotal\",   pApp.strname \"applicantname\",   oApp.Strorgname \"applicantorg\",   ep.strname \"executorname\",   eo.strorgname \"executororg\",   T.cell \"asrscell\",   T.keyrecid \"keyrecid\",   T.cert_id_one \"carda\",   T.cert_id_two \"cardb\"  FROM mac2.tb_wim_recpay T  left JOIN vw_tbperson pApp   ON T.manage_operator = pApp.stridno  left JOIN tborg oApp   ON T.operator_org = oApp.Intorgid  left JOIN Tbproductdef prod   ON T.goods_code = prod.intproductid  left JOIN tbproductst st   ON st.strpscode = T.process_code  left JOIN vw_tbperson ep   ON ep.stridno = T.executor_code  left JOIN tborg eo   ON eo.intorgid = ep.intorgid WHERE TO_DATE(?,\'yyyymmdd\') = mac2.cal_accounting_date(T.insert_time) ORDER BY T.insert_time DESC', 'date', '', '2019-03-11 17:39:30', '2019-03-13 10:18:15', '1');
INSERT INTO `sys_api` VALUES ('143', '00000000017', '1', '立库-请求响应（按日）', '938a52d9c5', 'SELECT t.requestId asrsid,( CASE WHEN \'OutStockRequest\' = t.reponsetype THEN 2 ELSE 1 END ) recpaytype,t.EXTATTR26 AS businesstype,( CASE WHEN t.enterby = \'MES\' THEN 0 ELSE 1 END ) AS isoffline,t.enterdate AS insertat,t.EXTATTR34 AS taskstart,t.EXTATTR35 AS taskend,t.status,t.EXTATTR8 AS pickuplocation,t.EXTATTR9 AS prodid,t.EXTATTR10 AS processcode,t.EXTATTR25 AS techcode,t.EXTATTR21 AS reviewtag,t.EXTATTR11 AS carno,t.EXTATTR36 AS reqquantity,pApp.NAME AS applicantname,oApp.ORG_NM AS applicantorg,eApp.NAME AS executorname,eOrg.ORG_NM AS executororg,t.EXTATTR30 AS asrscell,t.EXTATTR32 AS carda,t.EXTATTR33 AS cardb FROM L0378.WMS_RSS_REQUEST t LEFT JOIN V_RSS_USER pApp ON t.extattr5 = pApp.CERT_ID LEFT JOIN V_RSS_DEPARTMENT oApp ON t.extattr6 = oApp.ORG_CODE LEFT JOIN V_RSS_USER eApp ON t.extattr15 = eApp.CERT_ID LEFT JOIN V_RSS_DEPARTMENT eOrg ON eApp.ORG_CODE = eOrg.ORG_CODE WHERE len(t.EXTATTR10) > 1 AND convert (VARCHAR,dateadd(HOUR ,- 3,t.enterdate),112) = ? ORDER BY t.enterdate DESC', 'date', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('144', '00000000013', '1', '在库锁车产品列表', '53c6aecdd4', 'select org.strorgname 库房,   replace(def.strproductname,\'主业品\',\'\') 品种,   st.strcarno 车号,   ps.strpsname 工序,   st.intstock 数量,   bl.REASON_DESC 锁车原因  from mac2.tbstock st  left join mac2.vw_wim_tb_black_list bl   on st.strcarno = bl.BATCH_NO    left join mac2.tborg org   on st.intorgid = org.intorgid  left join mac2.tbproductdef def   on def.intproductid = st.intproductid  left join mac2.tbproductst ps   on ps.strpscode = st.strpscode where nvl2(bl.BATCH_NO,1,0) = 1  and st.intstock > 0', '', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('145', '00000000018', '1', 'cc信息网栏目列表', 'e9d7ca7554', 'select * from categories', '', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('146', '00000000018', '1', '部门列表', '1b8ef4550c', 'SELECT trim(dept) FROM tbl_base_dept order by id', '', '', '2019-03-11 17:39:30', '2019-03-13 10:11:21', '1');
INSERT INTO `sys_api` VALUES ('147', '00000000018', '1', '电话列表', '484377bec9', 'SELECT username,phone,dept,a.id FROM tbl_base_phone a inner join tbl_base_dept b on a.dept_id=b.id order by dept_id,order_index', '', '', '2019-03-11 17:39:30', '2019-03-13 10:11:22', '1');
INSERT INTO `sys_api` VALUES ('148', '00000000002', '1', '机台连续废通知产品列表', 'c882234fd8', 'SELECT a.[车号],a.[品种],a.[工序],a.[机台],a.[机长],a.[类型],a.[千位],a.[开位],a.[备注],a.[记录时间],a.[预计作废数],a.[完工状态],a.[最近工序],a.[最近设备],a.[最近印刷时间] FROM dbo.view_print_machinecheck_multiweak AS a WHERE a.[记录日期] BETWEEN ? AND ? order by id desc', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-13 10:11:41', '1');
INSERT INTO `sys_api` VALUES ('149', '00000000004', '1', '用户登录', 'ffe1fb555a', 'SELECT id uid ,rtrim(fullname) name,\'/demo/avatar/\'+(case when set_avatar=1 then (SELECT CONVERT (varbinary(MAX),cast(cast(id as varchar)+rtrim(username) as varchar)) FOR xml path (\'\'))+\'.jpg\' else \'avatar.svg\' end) avatar FROM tblUser WHERE UserName = ? and right(sys.fn_sqlvarbasetostr(HashBytes(\'MD5\',cast(? as varchar))),32) = UserPassword', 'username,password', '', '2019-03-11 17:39:30', '2019-03-13 10:12:48', '1');
INSERT INTO `sys_api` VALUES ('150', '00000000015', '1', '按期间名称查询期间最大事务处理ID', 'bc2e7d3404', 'with max1 as (select nvl(max(acct_period_id),0) v,? p from inv.org_acct_periods) select nvl(max(acct_period_id),max(max1.v)) \"periodId\" from inv.org_acct_periods right join max1 on period_name = max1.p group by max1.p', 'period', '', '2019-03-11 17:39:30', '2019-03-11 18:42:13', '0');
INSERT INTO `sys_api` VALUES ('151', '00000000019', '1', '按区间查询ERP结存(不含子库)', '51d1aef4d2', 'SELECT SN \"sn\",NAME \"name\",SUM(QUANTITY) \"quantity\",ROUND(SUM(FIGURE),2) \"figure\",\'\' \"remark\",\'0\' \"type\" FROM TBERP_INV_PERIOD WHERE MAX_ID <= ? AND (QUANTITY > 0 OR FIGURE > 0) and sn like ? and name like ? GROUP BY SN,NAME', 'periodid,sn,name', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('152', '00000000019', '1', '按区间查询ERP付出', 'af36c75d8c', 'SELECT t.SN \"sn\",t.NAME \"name\",SUM(t.QUANTITY) \"quantity\",SUM(t.figure) \"figure\",t.DESCRIPTION \"remark\",\'2\' \"type\" FROM TBERP_PAYOUT t WHERE t.MAX_ID <= ? and sn like ? and name like ? GROUP BY t.SN,t.NAME,t.DESCRIPTION', 'periodid,sn,name', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('153', '00000000019', '1', '按区间查询ERP收入', 'b961a55a0b', 'SELECT t.SN \"sn\",t.NAME \"name\",SUM(t.QUANTITY) \"quantity\",SUM(t.figure) \"figure\",t.TRANSACTION_TYPE_NAME \"remark\",\'1\' \"type\" FROM TBERP_RECEIPT t WHERE t.MAX_ID <= ? and sn like ? and name like ? GROUP BY t.SN,t.NAME,t.TRANSACTION_TYPE_NAME', 'periodid,sn,name', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('154', '00000000019', '1', '按区间查询ERP结存(含子库)', 'ebc7f9e90f', 'SELECT SN \"sn\",NAME \"name\",SUM(QUANTITY) \"quantity\",ROUND(SUM(FIGURE),2) \"figure\",DESCRIPTION \"remark\",\'3\' \"type\" FROM TBERP_INV_PERIOD  WHERE MAX_ID <= ?  AND (QUANTITY > 0 OR FIGURE > 0)  and sn like ? and name like ? GROUP BY SN,NAME,DESCRIPTION', 'periodid', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('155', '00000000019', '1', 'ERP呆滞库存库存分析', '117dd652a7', 'SELECT distinct a.sn,a.name,a.account,a.quantity,a.figure,a.source,b.remain_figure,b.remain_quantity,b.remain_remark,a.duration FROM ( SELECT T .sn ,T . NAME ,T .transaction_type_name source,T .quantity ,T .figure ,T .description account,ROUND ( (SYSDATE - T .CREATION_DATE) / 365,2 ) duration FROM TBERP_LAST_TRANSACTION T WHERE (SYSDATE - T .CREATION_DATE) / 365 BETWEEN ? AND ? ) A LEFT JOIN ( SELECT SN remain_sn,SUM (QUANTITY) remain_quantity,ROUND (SUM(FIGURE),2) remain_figure,name remain_remark FROM TBERP_INV_PERIOD WHERE MAX_ID <= ? AND (QUANTITY > 0 OR FIGURE > 0) GROUP BY SN,NAME) b ON A .sn = b.remain_sn where nvl(b.remain_quantity,0)>0', 'from,to,periodid', '', '2019-03-11 17:39:30', '2019-03-11 18:42:00', '0');
INSERT INTO `sys_api` VALUES ('156', '00000000019', '1', '物料收付存统计查询', '4653126720', 'with tmp_tbl as (select distinct ?          as m_id,         ?          as base_id,         p.inventory_item_id,         p.sn        m_sn,         p.name       m_name,         p.organization_id   from tberp_inv_period p  where (p.sn like ? and p.name like ?)   and p.organization_id = ?) SELECT a.SN \"sn\",   a.NAME \"name\",   SUM(a.QUANTITY) \"quantity\",   ROUND(SUM(a.FIGURE),2) \"figure\",   a.NAME \"remark\",   \'0\' \"type\"  FROM TBERP_INV_PERIOD a inner join tmp_tbl b   on a.acct_period_id <= b.base_id  AND a.sn = b.m_sn and a.organization_id=b.organization_id GROUP BY a.SN,a.NAME union SELECT T.SN \"sn\",   T . NAME \"name\",   SUM(T.QUANTITY) \"quantity\",   SUM(T.figure) \"figure\",   T.TRANSACTION_TYPE_NAME \"remark\",   \'1\' \"type\"  FROM TBERP_RECEIPT T inner join tmp_tbl b   on MAX_ID <= b.m_id and MAX_ID > b.base_id AND sn = b.m_sn and b.organization_id=t.organization_id GROUP BY T.SN,T . NAME,T.TRANSACTION_TYPE_NAME union SELECT T.SN \"sn\",   T . NAME \"name\",   SUM(T.QUANTITY) \"quantity\",   SUM(T.figure) \"figure\",   T.DESCRIPTION \"remark\",   \'2\' \"type\"  FROM TBERP_PAYOUT T inner join tmp_tbl b   on MAX_ID <= b.m_id and MAX_ID > b.base_id AND sn = b.m_sn and b.organization_id=t.organization_id GROUP BY T.SN,T . NAME,T.DESCRIPTION union SELECT e.SN \"sn\",   e.NAME \"name\",   SUM(e.QUANTITY) \"quantity\",   ROUND(SUM(e.FIGURE),2) \"figure\",   e.name \"remark\",   \'3\' \"type\"  FROM TBERP_INV_PERIOD e inner join tmp_tbl b   on acct_period_id <= b.m_id AND e.sn = b.m_sn and e.organization_id=b.organization_id GROUP BY e.SN,e.NAME,e.name', 'periodid,baseid,sn,name,orgid', '', '2019-03-11 17:39:30', '2019-03-11 18:42:13', '0');
INSERT INTO `sys_api` VALUES ('157', '00000000015', '1', 'ERP主组织代码', '5f830d1833', 'select t.ORGANIZATION_ID \"value\",t.ORGANIZATION_CODE \"code\",t.ORGANIZATION_NAME \"name\" from APPS.ORG_ORGANIZATION_DEFINITIONS t where (t.DISABLE_DATE is null or t.DISABLE_DATE>sysdate) and t.INVENTORY_ENABLED_FLAG=\'Y\'', '', '', '2019-03-11 17:39:30', '2019-03-11 18:42:08', '0');
INSERT INTO `sys_api` VALUES ('158', '00000000019', '1', '按账户别名查询发出', 'ceca858baf', 'select t.sn \"sn\",   t.name \"name\",   t.description \"disaccount\",   sum(t.quantity) \"quantity\",   sum(t.figure) \"figure\"  from tberp_payout t  where t.max_id between ? and ?  and t.description like ? group by t.sn,t.name,t.description order by t.name', 'perioda,periodb,disaccount', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('159', '00000000002', '1', '获取当前用户锁车列表', 'e3e4d8dd13', 'select cart_number,user_name from print_abnormal_prod where cart_number in (?) and proc_stream=7', 'values', '', '2019-03-11 17:39:30', '2019-03-15 10:16:28', '1');
INSERT INTO `sys_api` VALUES ('160', '00000000013', '1', '在库产品锁车列表', '1e8982e423', 'select * from vw_blacklist order by 7', '', '', '2019-03-11 17:39:30', '2019-03-13 10:11:24', '1');
INSERT INTO `sys_api` VALUES ('161', '00000000013', '1', '当日过数计划与进度', 'b1d340ec35', 'select vc.seq \"seq\",   vc.strcarno \"carno\",   vc.strproductname \"prod\",   vc.strpsname \"ps\",   vc.strorgname \"org\",   substr(vc.dteparking,1,10) \"parkAt\",   substr(vc.dtescheduleout,1,10) \"outAt\",   0 \"isCountedToday\",   vc.\"isNeedcount\" \"isNeedcount\"  from vw_count_task vc union select row_number() over(partition by org.strorgname,def.strproductname,st.strpsname order by min(t.strcarno)) \"seq\",   t.strcarno \"carno\",   def.strproductname \"prod\",   st.strpsname \"ps\",   org.strorgname \"org\",   null \"parkAt\",   null \"outAt\",   1 \"isCountToday\",   0 \"isNeedCount\"  from tb_batch_count_control t inner join tbproductdef def   on t.intproductid = def.intproductid inner join tbproductst st   on t.strpscode = st.strpscode inner join tbstock stock   on t.strcarno = stock.strcarno  and stock.intstock > 0  and getUnitPscode(t.strpscode) = getUnitPscode(stock.strpscode) inner join tborg org   on stock.intorgid = org.intorgid where t.dtemanual = cal_accounting_date(sysdate)  and t.intcountstatus = 1 group by org.strorgname,def.strproductname,st.strpsname,t.strcarno', '', '', '2019-03-11 17:39:30', '2019-03-19 08:03:12', '1');
INSERT INTO `sys_api` VALUES ('162', '00000000013', '1', '数管机构列表', '2f6b82d5d6', 'select t.strorgtypecode \"typeCode\",t.strorgtypename \"typeName\",o.intorgid \"orgId\",o.strorgname \"orgName\" from tborg o inner join tborgtype t on o.strorgtypecode=t.strorgtypecode order by t.strorgtypecode,o.strorgname', '', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('163', '00000000002', '1', '批量查询锁车原因', '6e24e68067', 'SELECT DISTINCT * FROM ( SELECT cart_number,(  CASE  WHEN only_lock_cart = 1 THEN  \'【批量锁车.不拉号】\'  ELSE  \'【异常品】\'  END ) + isnull(machine_name,\'\') + \' \' + reason remark,user_name FROM Print_Abnormal_Prod a WHERE cart_number IN (?) UNION ALL SELECT DISTINCT cart_number,\'【人工大张日常抽检】\' remark,user_name FROM  print_sample_cartlist WHERE  cart_number in(?) UNION ALL  SELECT DISTINCT cart_number,\'【四新验证】\' remark,user_name  FROM  print_wms_proclist  WHERE cart_number in(?)  AND check_type = \'四新验证\' ) a', 'carts1,carts2,carts3', '', '2019-03-11 17:39:30', '2019-03-13 10:11:26', '1');
INSERT INTO `sys_api` VALUES ('164', '00000000002', '1', '指定车号列表是否是本周人工拉号任务', 'abd796c14c', 'SELECT cart_number,(case when sum(1) is null then 0 else 1 end) status FROM print_sample_cartlist where status = 0 and cart_number in (?) group by cart_number', 'cart_number', '', '2019-03-11 17:39:30', '2019-03-13 10:11:19', '1');
INSERT INTO `sys_api` VALUES ('165', '00000000002', '1', '锁车产品待推送车号列表', '3c1ac0c5ad', 'SELECT cart_number,user_name FROM Print_Abnormal_Prod WHERE proc_stream = 7 AND unlock_status = 0 AND NOT unlock_time IS NULL AND getdate() >= unlock_time and CONVERT (varchar,GETDATE(),112)> CONVERT (varchar,msg_push_date,112)', '', '', '2019-03-11 17:39:30', '2019-03-13 10:10:19', '1');
INSERT INTO `sys_api` VALUES ('166', '00000000002', '1', '更新推送时间', '941e7280d9', 'update Print_Abnormal_Prod set msg_push_date=GETDATE() where cart_number in (?)', 'carts', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('167', '00000000013', '1', '数管总库存日报', '81c0b17a5b', 'select to_char(t.dteaccounting,\'dd\') \"dte\",t.intproductid \"prod\",srt.strpsname \"pscode\",sum(t.intquantity) \"q\",srt.pscodesort \"idx\",def.intpaperfolds \"x\" from tb_invbook_daily@cognos t inner join STRPSCODE_SORT@cognos srt on getUnitPscode(t.strpscode)=srt.strpscode inner join tbproductdef def on t.intproductid=def.intproductid where to_char(t.dteaccounting,\'yyyy-mm\') = ? and t.intproductid=? and t.strsubject = \'实数\' and t.intorgid in (1445,1446,1447,1448,1449,1450,1451,1452,1453,1454,1460) group by t.dteaccounting,t.intproductid,srt.strpsname,srt.pscodesort,def.intpaperfolds order by t.dteaccounting,t.intproductid,srt.pscodesort', 'month,prod', '', '2019-03-11 17:39:30', '2019-04-03 23:03:04', '1');
INSERT INTO `sys_api` VALUES ('168', '00000000013', '1', '数管库存日报', 'e66bde9f4a', 'select t.dteaccounting \"dte\",t.intproductid \"prod\",st.strpsname \"pscode\",sum(t.intquantity) \"q\"  from tb_invbook_daily@mac.localdomain t  inner join tbproductst st on getUnitPscode(t.strpscode)=st.strpscode where to_char(t.dteaccounting,\\\'yyyy-mm\\\') = ? and t.intproductid=?  and t.strsubject = \\\'帐数\\\' group by t.dteaccounting,t.intproductid,st.strpsname', 'month,prod', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('169', '00000000013', '1', '数管库存日报', '3e24d20b26', 'select t.dteaccounting \"dte\",t.intproductid \"prod\",st.strpsname \"pscode\",sum(t.intquantity) \"q\" from tb_invbook_daily@mac t inner join tbproductst st on getUnitPscode(t.strpscode)=st.strpscode where to_char(t.dteaccounting,\'yyyy-mm\') = ? and t.intproductid=? and t.strsubject = \'帐数\' group by t.dteaccounting,t.intproductid,st.strpsname', 'month,prod', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('170', '00000000013', '1', '数管库存日报表头', '6ef23ccbcf', 'select distinct srt.strpsname \"pscode\",srt.pscodesort \"idx\" from tb_invbook_daily@cognos t inner join STRPSCODE_SORT@cognos srt on getUnitPscode(t.strpscode)=srt.strpscode where to_char(t.dteaccounting,\'yyyy-mm\') = ? and t.intproductid=? and t.strsubject = \'帐数\' and t.intorgid in (1445,1446,1447,1448,1449,1450,1451,1452,1453,1454,1460) group by t.dteaccounting,t.intproductid,srt.strpsname,srt.pscodesort order by srt.pscodesort', 'month,prod', '', '2019-03-11 17:39:30', '2019-04-03 23:03:02', '1');
INSERT INTO `sys_api` VALUES ('171', '00000000012', '1', '码后核查严重废图像列表', '994d3ec6b8', 'SELECT a.id,a.cart_number,a.img_id,a.client_no,a.macro_id,a.img_data,a.format_pos FROM serious_img a where cart_number in (?) and left(a.client_no,2) in (10,12,13,14)', 'carts', '', '2019-03-11 17:39:30', '2019-03-13 10:12:25', '1');
INSERT INTO `sys_api` VALUES ('172', '00000000012', '1', 'BLOB读取测试', 'bec3c2a63e', 'SELECT * FROM ImageData WHERE ID=1', '', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('173', '00000000002', '1', '码后核查严重废锁图车号列表', 'ac85e53805', 'SELECT a.CartNumber 车号,b.machineName 机台,c.ProductName 品种,ProduceDate 生产日期,seriousPicCount 严重废分级图片数 FROM MaHouData a INNER JOIN MachineData b on a.MachineID=b.machineId INNER JOIN ProductData c on c.ProductID = a.ProductTypeID where ProduceDate between ? and ? and seriousPicCount >0 order by 5 desc', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-13 10:12:25', '1');
INSERT INTO `sys_api` VALUES ('174', '00000000012', '1', '码后核查严重废图像判废结果', '76844be75f', 'SELECT id,status FROM serious_img a where cart_number in (?)', 'carts', '', '2019-03-11 17:39:30', '2019-03-13 10:12:30', '1');
INSERT INTO `sys_api` VALUES ('175', '00000000003', '1', '严重废锁图码后核查判废情况', 'e30c188fbd', 'select c.image_index \"image_index\",c.item_flag \"item_flag\" from qfm_wip_jobs a left join qfm_qa_inspect_master b on a.job_id = b.job_id left join qfm_qa_inspect_slave c on b.inspectm_id = c.inspectm_id where cart_number = ? and finished_flag >= 2 and c.image_index in (?)', 'cart,images', '', '2019-03-11 17:39:30', '2019-03-13 10:13:47', '1');
INSERT INTO `sys_api` VALUES ('176', '00000000012', '1', '码后核查严重废锁定图像未判废列表', 'ceb0dc2230', 'SELECT id,cart_number,img_id FROM serious_img WHERE status = 0  AND ( id > (  SELECT  MAX (id)  FROM  serious_img ) - 4000 )', '', '', '2019-03-11 17:39:30', '2019-03-13 10:13:46', '1');
INSERT INTO `sys_api` VALUES ('177', '00000000012', '1', '更新码后核查严重废锁定图像判废结果', 'd08b605030', 'update serious_img set status = ? where cart_number=? and convert( varchar,img_id ) in (?)', 'status,cart,img_id', '', '2019-03-11 17:39:30', '2019-03-13 14:52:22', '1');
INSERT INTO `sys_api` VALUES ('178', '00000000012', '1', '码后核查严重废锁图各区域报错情况', '005fdd6e3f', 'SELECT macro_id 宏区id,(case when client_no/10=10 then \\\'正面\\\' when client_no/10=14 then \\\'背面\\\' else \\\'其他\\\' end) 检测相机,(case when status=1 then \\\'误废\\\' when status in (3,8) then \\\'实废\\\' end) 判废结果,count(*) 条数 FROM [dbo].[serious_img] where status in (1,3,8) and cart_number in (?) group by (case when status=1 then \\\'误废\\\' when status in (3,8) then \\\'实废\\\' end),macro_id,client_no/10 order by 3,4 desc', 'carts', '', '2019-03-11 17:39:30', '2019-03-13 10:12:30', '1');
INSERT INTO `sys_api` VALUES ('179', '00000000002', '1', '机检弱项劳动竞赛汇总数据', '50e890f3e9', 'SELECT a.[品种],a.[工序],a.[设备],a.[机长],SUM (a.[张数]) 实际开数, SUM (a.张数 * a.记废等级) 折算开数 FROM view_print_machinecheck_weak a WHERE 登记日期 BETWEEN ? AND ? GROUP BY a.[品种],a.[工序],a.[设备],a.[机长] order by 1,6 ,2,3,4', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-13 10:12:20', '1');
INSERT INTO `sys_api` VALUES ('180', '00000000002', '1', '机检弱项各裁封线机台数据汇总', '4a598a3b41', 'select a.[品种],a.裁封机长,SUM (a.[张数]) 实际开数,SUM (a.张数 * a.记废等级) 折算开数 from (SELECT distinct a.车号,a.[品种],a.[张数],a.记废等级,a.裁封机长 FROM view_print_machinecheck_weak a WHERE 登记日期 BETWEEN ? AND ? and a.记废等级>9) a group by a.[品种],a.裁封机长 order by 1,4 desc', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-13 10:12:20', '1');
INSERT INTO `sys_api` VALUES ('181', '00000000013', '1', '按工号查询员工信息', '45b2ae536e', 'select t.intpersonid \"pid\",t.intorgid \"orgid\",t.stridno \"workno\",t.strname \"name\",o.strorgname \"orgname\",o.strorgtypecode \"orgtype\" from vw_tbperson t inner join tborg o on t.intorgid=o.intorgid where t.stridno=?', 'idno', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('182', '00000000013', '1', '在制品批次查询(按批次号或车卡号)', '09d12c2e14', 'select distinct c.strcarno \"carno\",   st.intstock \"quantity\",   c.strcard1no \"cardA\",   cc1.inttotnum \"quantityA\",   c.strcard2no \"cardB\",   cc2.inttotnum \"quantityB\",   c.strcard3no \"certA\",   c.strcard4no \"certB\",   st.intproductid \"prodid\",   st.strpscode \"process\",   proc.strpsname \"processName\",   st.intorgid \"orgid\",   o.strorgname \"orgName\",   def.intpaperfolds \"x\",   nvl((select distinct b.TECHNOLOGY_TYPE_NAME      from VW_DBJT_TECH b      where b.CAR_NO like c.strcarno),    \'不分工艺\') \"tech\" from tbstock  st, tbccmove  cc1, tbccmove  cc2, tbcare  c, tbproductst proc, tborg  o, tbproductdef def where st.strcarno = c.strcarno and def.intproductid = st.intproductid and st.intorgid = o.intorgid and st.strpscode = proc.strpscode and c.intisover = 0 and st.strcarno = cc1.strcarno and st.intorgid = cc1.intorgid and st.strpscode = cc1.strpscode and c.strcard1no = cc1.strcardno and st.strcarno = cc2.strcarno and st.intorgid = cc2.intorgid and st.strpscode = cc2.strpscode and c.strcard1no = cc2.strcardno and ? in  (c.strcard1no,c.strcard2no,c.strcard3no,c.strcard4no,c.strcarno) and st.intorgid in  (1445,1446,1447,1448,1449,1450,1451,1452,1453,1454,1460) and st.intstock > 0', 'batch', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('183', '00000000013', '1', '待执行入库请求查询（按车号或车卡号、班组）', 'e3bd6a4c40', 'select count(1) \"cnt\" from tb_wim_recpay t where t.insert_time>=mac2.cal_accounting_date(sysdate) and t.status_code in (1,2) and ? in (t.batch_no,t.cert_id_one,t.cert_id_two) and t.operator_org=?', 'batch,payorg', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('184', '00000000014', '1', '机台信息查询（按日作业编号）', 'ef85ec420b', 'select m.machine_id,m.machine_no,tp.model_id,tp.model_name,d.dept_id,d.dept_name  from tbbase_machine_info m inner join tbbase_machine_type tp   on m.model_id = tp.model_id inner join tbbase_dept_info d on m.dept_id=d.dept_id where m.machine_id = (select t.machine_id             from tbjt_day_rec_main t             where t.key_recid = ?)', 'keyid', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('185', '00000000014', '1', '图像判废每日待判车号列表', '4cc95c22ec', 'WITH carts AS ( SELECT A.品种,A.车号,A.工艺,A.机台,A.工序 FROM VIEW_CARTFINDER A WHERE TO_CHAR (A.完成时间,\'YYYYMMDD\') BETWEEN ? AND ? AND A.工序 = \'印码\' ) SELECT distinct A.品种 \"prod_name\",A.车号 \"cart_number\",A.工艺 \"proc_name\",A.机台 \"machine_name\" FROM carts A INNER JOIN VIEW_CARTFINDER b ON A.车号 = b.车号 AND A.工序 = b.工序 GROUP BY A.品种,A.车号,A.工艺,A.机台 HAVING SUM (B.产量) = 10000', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('186', '00000000003', '1', '全幅面_图像判废月度产量汇总', '9a8e4c9d74', 'select operator_name \"operator_name\",sum(cart_nums) \"cart_nums\",sum(pf_num) \"pf_num\",sum(check_num) \"check_num\",sum(pf_num + check_num) \"total_num\" from (SELECT D.operator_name,count(a.job_id) cart_nums,0 check_num,sum(prod_qty) pf_num FROM qfm_wip_prod_logs A inner join dic_operators D on D.operator_id = A.operator_id WHERE TO_CHAR(A.start_date,\'YYYYMMDD\') between ? and ? and a.operation_id = 8 group by d.operator_name union all SELECT D.operator_name,count(distinct a.job_id) cart_nums,count(b.item_flag) check_num,0 pf_num FROM qfm_wip_prod_logs A inner join dic_operators D on D.operator_id = A.operator_id inner join qfm_qa_inspect_master c on a.job_id = c.job_id inner join qfm_qa_inspect_slave b on c.inspectm_id = b.inspectm_id WHERE TO_CHAR(A.start_date,\'YYYYMMDD\') between ? and ? and a.operation_id = 9 and b.item_flag <> 3 group by D.operator_name union all SELECT D.operator_name,count(a.job_id) cart_nums,0 check_num,sum(prod_qty) pf_num FROM wip_prod_logs A inner join dic_operators@XZHC_DBLINK D on D.operator_id = A.operator_id WHERE TO_CHAR(A.start_date,\'YYYYMMDD\') between ? and ? and a.operation_id = 8 group by d.operator_name union all SELECT D.operator_name,count(distinct a.job_id) cart_nums,count(b.item_flag) check_num,0 pf_num FROM wip_prod_logs A inner join dic_operators@XZHC_DBLINK D on D.operator_id = A.operator_id inner join qa_inspect_master c on a.job_id = c.job_id inner join qa_inspect_slave b on c.inspectm_id = b.inspectm_id WHERE TO_CHAR(A.start_date,\'YYYYMMDD\') between ? and ? and a.operation_id = 9 and b.item_flag <> 3 group by D.operator_name) A group by operator_name order by 5 desc', 'tstart,tend,tstart2,tend2,tstart3,tend3,tstart4,tend4', '', '2019-03-11 17:39:30', '2019-03-13 10:11:01', '1');
INSERT INTO `sys_api` VALUES ('187', '00000000015', '1', 'ERP物料名称或编码查询（按组织）', 'dc065c8338', 'select t.inventory_item_id \"invid\",t.description \"name\",t.segment1 \"sn\",t.organization_id \"orgid\" from inv.mtl_system_items_b t where t.organization_id = ?and (t.description like \\\'%\\\'||?||\\\'%\\\' or t.segment1 like \\\'%\\\'||?||\\\'%\\\')', 'orgid,q1,q2', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('188', '00000000015', '1', 'ERP账户别名查询', '68a53c09a0', 'select distinct t.segment1 \"name\" from inv.MTL_GENERIC_DISPOSITIONS t where t.description like \'%\'||?||\'%\' or t.segment1 like \'%\'||?||\'%\'', 'q1,q2', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('189', '00000000017', '1', '立体库巷道状态', '0902139792', 'SELECT ws.DOOR_ID AS doorid,l.LedUniteId AS doorcode,d.DIRECTION AS direction,ws.STATUS AS status,l.RunInfo AS runinfo,l.FaultMessage AS faultmessage,l.DoingTransferlog AS doingtransferlog,di.DoorStatus AS doorstatus FROM [L0378].[WMS_RSS_STNPARA] ws,[L0378].[TWMS_LEDINFO] l,[L0378].[WMS_RSS_DOOR] d, [L0378].[TWMS_DOOR_INTERFACE] di WHERE ws.DOOR_ID = l.LedNo  AND l.LedUniteId = d.DOOR_CODE AND l.LedUniteId = di.DoorName ;', '', '', '2019-03-11 17:39:30', '2019-03-13 10:11:21', '1');
INSERT INTO `sys_api` VALUES ('190', '00000000017', '1', '立体库货架信息', 'f5419ca4d8', 'SELECT l.locnum,l.laneway,l.locstatus,l.storestatus,l.line,l.lie,l.layer,l.carno,l.prodid,l.prodcode,l.processcode,l.techcode,l.reviewtag,l.quantity1,l.quantity2,l.moveindate FROM V_stock_locmessage l ORDER BY l.LOCNUM;', '', '', '2019-03-11 17:39:30', '2019-03-13 11:26:55', '1');
INSERT INTO `sys_api` VALUES ('191', '00000000017', '1', '立库-请求响应（按日）1', '68ab48ba1c', 'SELECT t.requestId asrsid,( CASE WHEN \'OutStockRequest\' = t.reponsetype THEN 2 ELSE 1 END ) recpaytype,t.EXTATTR26 AS businesstype,( CASE WHEN t.enterby = \'MES\' THEN 0 ELSE 1 END ) AS isoffline,t.enterdate AS insertat,t.EXTATTR34 AS taskstart,t.EXTATTR35 AS taskend,t.status \"status\",t.EXTATTR8 AS pickuplocation,t.EXTATTR9 AS prodid,( CASE WHEN t.EXTATTR10 = \'\' THEN gc.GOODS_CLASS_NAME ELSE t.EXTATTR10 END ) AS processcode,t.EXTATTR25 AS techcode,t.EXTATTR21 AS reviewtag,t.EXTATTR11 AS carno,t.EXTATTR36 AS reqquantity,pApp.NAME AS applicantname,oApp.ORG_NM AS applicantorg,eApp.NAME AS executorname,eOrg.ORG_NM AS executororg,(CASE WHEN t.reponsetype = \'OutStockRequest\' THEN t.EXTATTR30 ELSE CONVERT(VARCHAR,d.DoorName) END) AS asrscell,t.EXTATTR32 AS carda,t.EXTATTR33 AS cardb,t.EXTATTR41 AS appoint FROM L0378.WMS_RSS_REQUEST t LEFT JOIN V_RSS_USER pApp ON t.extattr5 = pApp.CERT_ID LEFT JOIN V_RSS_DEPARTMENT oApp ON oApp.ORG_CODE = CASE WHEN t.extattr6 =\'\' THEN pApp.ORG_CODE ELSE t.extattr6 END LEFT JOIN V_RSS_USER eApp ON t.extattr15 = eApp.CERT_ID LEFT JOIN V_RSS_DEPARTMENT eOrg ON eApp.ORG_CODE = eOrg.ORG_CODE LEFT JOIN WMS_RSS_REQUEST_ALLOT ta ON t.requestId = ta.requestId LEFT JOIN TWMS_DOOR d ON d.DoorID = ta.doorid LEFT JOIN V_RSS_GOODS_CLASS gc ON t.EXTATTR9 = gc.GOODS_CLASS_CODE WHERE CONVERT ( VARCHAR,dateadd ( HOUR,- 3,t.enterdate ),112 ) = ? ORDER BY t.enterdate', 'date', '', '2019-03-11 17:39:30', '2019-03-13 10:18:15', '1');
INSERT INTO `sys_api` VALUES ('192', '00000000013', '1', '按IP查询设备当日生产记录编号', '3b371630b5', 'select t.key_recid \"keyRecid\",   t.rec_date \"dateStr\",   to_char(t.begin_date,\\\'hh24:mi:ss\\\') \"beginTime\",   t.machine_id \"machineId\",   mi.machine_no \"machineName\",   t.team_id \"teamId\",   t.team_name \"teamName\",   t.work_class_id \"workclassId\",   wc.work_class_name \"workclassName\",   proc.proc_main_id \"procId\",   proc.proc_name \"procName\",   dm.floor_nm||\\\'-\\\'||dm.direction \"door\"  from tbjt_day_rec_main@dbjt t  inner join tbbase_machine_info@dbjt mi on t.machine_id=mi.machine_id  inner join tbbase_work_class@dbjt wc on t.work_class_id=wc.work_class_id  left join tbjt_day_rec_base@dbjt b on t.key_recid=b.key_recid  inner join tbset_proc_main@dbjt proc on b.proc_main_id=proc.proc_main_id  left join TB_DOOR_MACHINE dm on t.machine_id=dm.machine_id where t.machine_id in    (select ip.cur_machine_id      from tbsys_machine_ip@dbjt ip     where ip.machine_ip like ?)  and calworkday@dbjt(t.begin_date) = calworkday@dbjt(sysdate-2)  and t.over_user_id is not null', 'ip', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('193', '00000000013', '1', '按barcode查询用户和部门', '27fd41feeb', 'select t.name \"name\",t.cert_id \"barcode\",t.PSN_NO \"worknum\",t.ORG_CODE \"orgid\",o.strorgname \"orgname\",ot.strorgtypecode \"orgtypeid\",ot.strorgtypename \"orgtypename\" from vw_wim_person t inner join tborg o inner join tborgtype ot on o.strorgtypecode=ot.strorgtypecode on t.ORG_CODE=o.intorgid where t.PSN_NO like ?', 'barcode', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('194', '00000000002', '1', '机检弱项各品种月度汇总', 'e60ff7ddde', 'SELECT a.[品种],(case when a.记废等级=9 then \\\'已检出\\\' else \\\'未检出\\\' end) 检测状态,convert(varchar(6),a.[登记日期],120) 月份,SUM (a.[张数]) 实际开数 FROM view_print_machinecheck_weak a where 记废等级>0 and 登记日期 between ? and ? and a.[品种]=? GROUP BY  a.[品种],convert(varchar(6),a.[登记日期],120),a.记废等级 order by 1,3,a.记废等级', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('195', '00000000003', '1', '判废排产_指定车号列表判废条数查询', '544a395fd4', 'SELECT 0 \"type\",A.cart_number \"cart_number\",b.product_name \"product_name\",TO_CHAR (A.start_date,\'yyyy-mm-dd hh24:mi:ss\') \"start_date\",c.machine_waster_number AS \"pf_num\" FROM qfm_wip_jobs A INNER JOIN dic_products b ON A .product_id = b.product_id INNER JOIN qfm_qa_inspect_master c ON c.job_id = A .job_id WHERE A .CART_NUMBER IN (?) UNION ALL SELECT 1 \"type\",A.cart_number \"cart_number\",b.product_name \"product_name\",TO_CHAR (A.start_date,\'yyyy-mm-dd hh24:mi:ss\') \"start_date\",c.machine_waster_number AS \"pf_num\" FROM wip_jobs A INNER JOIN dic_products b ON A .product_id = b.product_id INNER JOIN qa_inspect_master c ON c.job_id = A .job_id WHERE A .cart_number IN (?)', 'carts0,carts1', '', '2019-03-11 17:39:30', '2019-03-14 08:07:16', '1');
INSERT INTO `sys_api` VALUES ('196', '00000000013', '1', '过版纸总账表头', '5f9333593a', 'select distinct srt.strpsname \"pscode\",srt.pscodesort \"idx\" from tb_invbook_daily@cognos t inner join STRPSCODE_SORT@cognos srt on getUnitPscode(t.strpscode)=srt.strpscode where to_char(t.dteaccounting,\\\'yyyy-mm\\\') = ? and t.intproductid=? and t.strsubject = \\\'帐数\\\' and t.intorgid in (1446,20) group by t.dteaccounting,t.intproductid,srt.strpsname,srt.pscodesort order by srt.pscodesort', 'month,prod', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('197', '00000000013', '1', '过版纸总账', '770efaa2eb', 'with setting as (select ? mth,? prodid from dual) select to_char(t.dteaccounting,\'dd\') \"dte\", t.intproductid \"prod\", srt.strpsname \"pscode\", sum(t.intquantity) \"q\", srt.pscodesort \"idx\", def.intpaperfolds \"x\",    sum(case when vw.strpscode in (\'gbbz\') then vw.q else 0 end) \"rec\",   sum(case when vw.strpscode in (\'dzfp\') then vw.q else 0 end) \"pay\" from tb_invbook_daily@cognos t inner join STRPSCODE_SORT@cognos srt  on getUnitPscode(t.strpscode) = srt.strpscode inner join tbproductdef def  on t.intproductid = def.intproductid inner join setting  on to_char(t.dteaccounting,\'yyyy-mm\') = setting.mth and t.intproductid = setting.prodid left join ( select p.intproductid,p.strpscode,p.dteaccounting,abs(p.q) q from vw_daily_payout p inner join setting on to_char(p.dteaccounting,\'yyyy-mm\') = setting.mth and p.intproductid=setting.prodid where p.intorgid=20 union select r.intproductid,r.strpscode,r.dteaccounting,abs(r.q) q from vw_daily_receipt r inner join setting on r.intproductid=setting.prodid and to_char(r.dteaccounting,\'yyyy-mm\')=setting.mth where r.intorgid=1446 and r.strpscode like \'gbbz\' ) vw on t.intproductid=vw.intproductid and t.strpscode=vw.strpscode and t.dteaccounting=vw.dteaccounting where t.strsubject = \'实数\' and t.intorgid in (1446,20) group by t.dteaccounting,  t.intproductid,  srt.strpsname,  srt.pscodesort,  def.intpaperfolds order by t.dteaccounting,t.intproductid,srt.pscodesort', 'month,prod', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('198', '00000000020', '1', '设备采购事项中标情况', 'e1ded06919', 'SELECT id \"bid\",PROJECT_NAME \"prjName\",bidder \"bidder\",TOTALPRICE \"totalPrice\" FROM PAMS_FACILITY_CONNECTOR where id in (select distinct regexp_substr(?,\'[^,]+\',1,LEVEL) txt   from dual  connect by regexp_substr(?,\'[^,]+\',1,LEVEL) is not null)', 'bid1,bid2', '', '2019-03-11 17:39:30', '2019-03-13 19:53:06', '1');
INSERT INTO `sys_api` VALUES ('199', '00000000002', '1', '图像判废同步任务列表', '7b801561d1', 'SELECT a.id,rtrim(a.CartNumber) cart_number,b.MachineTypeID machinetype_id,DATEDIFF(  [day], CAST (  CAST (ProduceDate AS CHAR) AS datetime  ), GETDATE() ) date_diff FROM MahouData a INNER JOIN MachineData b ON a.MachineID = b.MachineID WHERE (  a.bManualSync = 0  OR a.bManualSync IS NULL ) AND ( DATEDIFF(  [day], CAST (  CAST (ProduceDate AS CHAR) AS datetime  ), GETDATE() ) > 0 ) ORDER BY a.ProduceDate', '', '', '2019-03-11 17:39:30', '2019-03-13 10:13:46', '1');
INSERT INTO `sys_api` VALUES ('200', '00000000003', '1', '指定车号丝印开包量', 'c05a19d61f', 'SELECT COUNT (*) \"opennum\",sum(real_fake) \"real_fake\" FROM (  SELECT  G .job_id,count(1) real_fake  FROM  qa_temp_qatbl G, wip_jobs a1  WHERE  G .job_id = a1.job_id  AND (a1.cart_number = ?)  GROUP BY  G .job_id, G .thousand_index, G .convert_num ) H GROUP BY job_id', 'cart', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('201', '00000000003', '1', '指定车号码后开包量', 'b471661443', 'SELECT COUNT (*) \"opennum\",sum(real_fake) \"real_fake\" FROM ( SELECT G .job_id,count(1) real_fake FROM qfm_qa_temp_qatbl G,qfm_wip_jobs a1 WHERE G .job_id = a1.job_id AND (a1.cart_number = ?) GROUP BY G .job_id,G .thousand_index,G .convert_num ) H GROUP BY job_id', 'cart', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('202', '00000000007', '1', '号码开包量', '5cdb3b665a', 'SELECT COUNT (*) \"opennum\",SUM (real_fake) \"real_fake\",SUM (black_img) \"black_img_code\" FROM (  SELECT  SUBSTR (D .ex_codenum,7,1) thousand_index, D .convert_sheet_number convert_num, COUNT (*) real_fake, SUM (   CASE   WHEN LENGTH (D .image_blob) < 10000 THEN   1   ELSE   0   END  ) black_img  FROM  WIP_JOBS A  INNER JOIN WIP_PROD_LOGS b ON A .job_id = b.JOB_ID  INNER JOIN QA_INSPECT_MASTER c ON b.log_id = c.log_id  INNER JOIN QA_INSPECT_SLAVE D ON c.inspectm_id = D .inspectm_id  WHERE  CART_NUMBER = ?  AND b.OPERATION_ID = 5  AND D .image_blob IS NOT NULL  GROUP BY  SUBSTR (D .ex_codenum,7,1), D .convert_sheet_number ) A', 'cart', '', '2019-03-11 17:39:30', '2019-03-13 14:22:19', '1');
INSERT INTO `sys_api` VALUES ('203', '00000000003', '1', '码后核查判废结果统计', 'ba81d18297', 'SELECT A .cart_number \"cart_number\",q.product_name \"product_name\",TO_CHAR ( A .start_date,\'yyyy-mm-dd hh24:mi:ss\' ) \"start_date\",TO_CHAR ( c.start_date,\'yyyy-mm-dd hh24:mi:ss\' ) \"verify_date\",r.operator_name \"operator_name\",b.machine_waster_number \"err_count\",H .opennum \"pm_opennum\",COUNT ( DISTINCT SUBSTR (E .code_num,7,4) ) \"real_paper_num\",COUNT (DISTINCT E .code_num) \"real_kai_num\",COUNT (DISTINCT E .qa_id) \"real_pic_num\",(case when s.black_img is null then 0 else s.black_img end) \"black_img_print\" FROM QFM_wip_jobs A INNER JOIN QFM_WIP_PROD_LOGS c ON A .job_id = c.job_id INNER JOIN QFM_QA_INSPECT_MASTER b ON A .job_id = b.job_id INNER JOIN qfm_qa_temp_qatbl E ON A .job_id = E .job_id INNER JOIN ( SELECT job_id,COUNT (*) AS opennum FROM ( SELECT G .job_id FROM qfm_qa_temp_qatbl G,qfm_wip_jobs a1 WHERE G .job_id = a1.job_id GROUP BY G .job_id,G .thousand_index,G .convert_num ) GROUP BY job_id ) H ON A .job_id = H .job_id INNER JOIN dic_products q ON q.product_id = A .product_id INNER JOIN dic_operators r ON r.operator_id = c.operator_id left JOIN ( SELECT A .job_id,COUNT (*) black_img FROM QFM_WIP_JOBS A INNER JOIN QFM_QA_INSPECT_MASTER b ON A .job_id = b.job_id INNER JOIN QFM_QA_INSPECT_SLAVE c ON b.inspectm_id = c.inspectm_id WHERE c.IMAGE_BLOB IS NOT NULL AND (A .cart_number = ?) AND LENGTH (c.image_blob) < 1040 group by a.job_id ) s ON s.job_id = A .job_id WHERE (c.operation_id = 8) AND (A .cart_number = ?) AND b.item_flag IN (2,3) and a.finished_flag>=2 GROUP BY A .cart_number,A .start_date,c.start_date,b.machine_waster_number,H .opennum,q.PRODUCT_NAME,r.operator_name,s.black_img', 'cart,cart2', '', '2019-03-11 17:39:30', '2019-03-13 10:13:46', '1');
INSERT INTO `sys_api` VALUES ('204', '00000000002', '1', '插入图像判废同步结果', 'fad6cab0fc', 'insert into manualverifydata(cartnumber,producttypename,producetime,verifytime,verifyoperatorname,totalcount,vbigpiececount,vkaicount,vrealtotalcount,opennum,opennum_code,realfake_code,opennum_siyin,realfake_siyin ) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?)', 'cartnumber,producttypename,producetime,verifytime,verifyoperatorname,totalcount,vbigpiececount,vkaicount,vrealtotalcount,opennum,opennum_code,realfake_code,opennum_siyin,realfake_siyin', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('205', '00000000002', '1', '人工判废状态回写', '18449cf95f', 'update mahoudata set bmanualsync = 1 where id=?', '_id', '@id:_id. 参数说明：api 索引序号', '2019-03-11 17:39:30', '2019-03-13 14:22:19', '1');
INSERT INTO `sys_api` VALUES ('206', '00000000002', '1', '今年未更新的车号列表', '7eb0409772', 'SELECT id,rtrim(cartnumber) cart FROM ManualVerifyData WHERE black_img_print =- 1 AND CONVERT (VARCHAR,ProduceTime,120) >= \'20180101\'', '', '', '2019-03-11 17:39:30', '2019-03-13 10:13:36', '1');
INSERT INTO `sys_api` VALUES ('207', '00000000002', '1', '更新2018年丝印开包量信息', 'e317de1906', 'update dbo.manualverifydata set producttypename = ?,producetime = ?,verifytime = ?,verifyoperatorname = ?,totalcount = ?,vbigpiececount = ?,vkaicount = ?,vrealtotalcount = ?,opennum = ?,opennum_code = ?,realfake_code = ?,opennum_siyin = ?,realfake_siyin = ? where id=?', 'producttypename,producetime,verifytime,verifyoperatorname,totalcount,vbigpiececount,vkaicount,vrealtotalcount,opennum,opennum_code,realfake_code,opennum_siyin,realfake_siyin,_id', '@id:_id. 参数说明：api 索引序号', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('208', '00000000014', '1', '当前工序完工量统计', 'fbcbbbf1aa', 'select t.DATA_DAY \"day\",t.PROC_MAIN_ID \"pricid\",proc.proc_name \"procName\",sum(t.prod_num_d) \"total\" from VW_DAILYREPORT_MAINPROC t inner join tbset_proc_main proc on t.PROC_MAIN_ID=proc.proc_main_id where t.DATA_DAY like to_char(sysdate,\'yyyymmdd\') group by t.DATA_DAY,t.PROC_MAIN_ID,proc.proc_name', '', '', '2019-03-11 17:39:30', '2019-03-13 10:13:40', '1');
INSERT INTO `sys_api` VALUES ('209', '00000000002', '1', '丝印图像判废任务列表', '20fe0c7321', 'SELECT a.id,rtrim(a.CartNumber) cart_number,b.MachineTypeID machinetype_id,DATEDIFF(  [day], CAST (  CAST (ProduceDate AS CHAR) AS datetime  ), GETDATE() ) date_diff FROM SiYinData a INNER JOIN MachineData b ON a.MachineID = b.MachineID WHERE (  a.bManualSync = 0  OR a.bManualSync IS NULL ) AND ( DATEDIFF(  [day], CAST (  CAST (ProduceDate AS CHAR) AS datetime  ), GETDATE() ) > 0 ) ORDER BY a.ProduceDate', '', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('210', '00000000014', '1', '指定车号列表中全检品', 'bb0c2704f1', 'select distinct 车号 \"carts\" from VIEW_CARTFINDER where \"工艺\"=\\\'全检品\\\' and 车号 in (?)', 'carts', '', '2019-03-11 17:39:30', '2019-03-13 10:13:36', '1');
INSERT INTO `sys_api` VALUES ('211', '00000000012', '1', '全检品不更新判废结果', 'a415d9e135', 'update serious_img set status=-1 where cart_number in (?)', 'carts', '', '2019-03-11 17:39:30', '2019-03-13 10:13:47', '1');
INSERT INTO `sys_api` VALUES ('212', '00000000002', '1', '丝印机长信息同步列表', 'fc2673bece', 'Select ID id,rtrim(CartNumber) cart_number FROM SiYinData WHERE bCartInfoSync=0 or bCartInfoSync is Null', '', '', '2019-03-11 17:39:30', '2019-03-13 10:13:45', '1');
INSERT INTO `sys_api` VALUES ('213', '00000000014', '1', '生产信息同步查询', '49bf0d2f04', 'SELECT i.technology_type_name \"techtypename\",b.car_no \"cartnumber\",b.gz_no \"carnumber\",b.dw_no \"gznumber\",c.proc_name \"procname\",G .work_class_name \"workclassname\",f.machine_no \"machinename\",D .user_name \"captainname\",team_name \"teamname\",H .user_name \"monitorname\",prod_num \"printnum\",TO_CHAR ( prod_dt,\'YYYY-MM-DD hh24:mi\' ) \"startdate\",TO_CHAR ( M .end_date,\'YYYY-MM-DD hh24:mi\' ) \"enddate\",E .product_name \"productname\",M .work_info \"workinfo\" FROM tbJt_Produce_Detail A LEFT OUTER JOIN tbJt_Produce_Info b ON A .Car_Id = b.Car_Id LEFT OUTER JOIN tbJt_Day_Rec_Main M ON A .key_recid = M .key_recid LEFT OUTER JOIN tbset_proc_main c ON A .proc_main_id = c.proc_main_id LEFT OUTER JOIN tbbase_user_info D ON A .machine_user_id = D .user_id LEFT OUTER JOIN tbbase_product E ON E .product_id = b.product_id LEFT OUTER JOIN tbbase_machine_info f ON M .machine_id = f.machine_id LEFT OUTER JOIN tbbase_work_class G ON M .work_class_id = G .work_class_id LEFT OUTER JOIN tbbase_user_info H ON M .work_user_id = H .user_id LEFT OUTER JOIN tbbase_technology_type i ON b.technology_type_id = i.technology_type_id WHERE c.proc_main_id NOT IN (10,15) and b.car_no = ?', 'cart', '', '2019-03-11 17:39:30', '2019-03-13 10:13:45', '1');
INSERT INTO `sys_api` VALUES ('214', '00000000002', '1', '丝印机长信息同步写入', '9d927bed0d', 'insert into dbo.cartinfodata(siyinid,cartnumber,carnumber,gznumber,techtypename,procname,workclassname,machinename,captainname,teamname,monitorname,printnum,startdate,enddate,productname,workinfo ) values ?', 'values', '@desc:批量插入数据时，约定使用二维数组values参数，格式为[{siyinid,cartnumber,carnumber,gznumber,techtypename,procname,workclassname,machinename,captainname,teamname,monitorname,printnum,startdate,enddate,productname,workinfo }]，数组的每一项表示一条数据', '2019-03-11 17:39:30', '2019-03-13 10:22:20', '1');
INSERT INTO `sys_api` VALUES ('215', '00000000002', '1', '丝印生产信息同步结果回写', '75e3f42e39', 'update SiYinData set bCartInfoSync=1 where id = ?', '_id', '', '2019-03-11 17:39:30', '2019-03-13 10:22:20', '1');
INSERT INTO `sys_api` VALUES ('216', '00000000002', '1', '码后机长信息同步列表', '141435f4c6', 'Select ID id,rtrim(CartNumber) cart_number FROM MaHouData WHERE bCartInfoSync=0 or bCartInfoSync is Null', '', '', '2019-03-11 17:39:30', '2019-03-13 10:13:46', '1');
INSERT INTO `sys_api` VALUES ('217', '00000000002', '1', '码后生产信息同步结果回写', '8cd0114d8c', 'insert into dbo.cartinfodata(mahouid,cartnumber,carnumber,gznumber,techtypename,procname,workclassname,machinename,captainname,teamname,monitorname,printnum,startdate,enddate,productname,workinfo ) values ?', 'values', '', '2019-03-11 17:39:30', '2019-03-13 10:13:46', '1');
INSERT INTO `sys_api` VALUES ('218', '00000000002', '1', '码后生产信息同步结果回写', '8a343942c8', 'update mahouData set bCartInfoSync=1 where id = ?', '_id', '', '2019-03-11 17:39:30', '2019-03-30 15:35:51', '1');
INSERT INTO `sys_api` VALUES ('219', '00000000002', '1', '人工图像判废结果同步列表', 'e6e7b0b7db', 'SELECT rtrim(CartNumber) cart,errPicIndex1 img1,errPicIndex2 img2,errPicIndex3 img3 FROM mahoudata WHERE bImg = 0 AND errPicIndex1 IS NOT NULL AND errPicIndex2 IS NOT NULL AND errPicIndex3 IS NOT NULL ORDER BY producedate', '', '', '2019-03-11 17:39:30', '2019-03-13 10:13:36', '1');
INSERT INTO `sys_api` VALUES ('220', '00000000003', '1', '人工图像判废结果', 'd2f6b260c7', 'select a .image_index \"image_index\",a .item_flag \"item_flag\" from qfm_qa_inspect_slave a left join qfm_qa_inspect_master b on a .inspectm_id = b.inspectm_id left join qfm_wip_jobs c on c.job_id = b.job_id where b.item_flag=3 and c.cart_number=? and a .image_index in (?)', 'cart_number,imgs', '', '2019-03-11 17:39:30', '2019-03-13 10:13:36', '1');
INSERT INTO `sys_api` VALUES ('221', '00000000002', '1', '回写判废结果', '1f1e612dc9', 'Update mahoudata Set ImgVerify1 = ?,ImgVerify2 = ?,ImgVerify3 = ?,bImg=1 WHERE CartNumber = ?', 'img1,img2,img3,cart_number', '', '2019-03-11 17:39:30', '2019-03-13 10:18:41', '1');
INSERT INTO `sys_api` VALUES ('222', '00000000002', '1', '人工图像判废标志回写', '6a086832a6', 'update mahouData set bImg=1 where cartnumber = ?', 'cart', '', '2019-03-11 17:39:30', '2019-03-13 10:18:41', '1');
INSERT INTO `sys_api` VALUES ('223', '00000000005', '1', '丝印机台生产质量信息', 'c688692d3a', 'SELECT CART_NUMBER \"cart_number\",E .machine_name \"machine_name\",MACHINE_WASTER_NUMBER \"fake_num\",TO_CHAR ( A .start_date,\'YYYY-MM-DD hh24:mi\' ) \"start_date\",COUNT (*) \"real_fake_count\" ,COUNT ( DISTINCT c.convert_sheet_number ) \"convert_sheet_number\" FROM wip_jobs A INNER JOIN QA_INSPECT_MASTER b ON A .JOB_ID = b.JOB_ID LEFT JOIN QA_INSPECT_SLAVE c ON c.inspectm_id = b.inspectm_id AND c.image_blob IS NOT NULL LEFT JOIN WIP_PROD_LOGS D ON A .job_id = D .job_id AND D .operation_id = 11 LEFT JOIN DIC_MACHINES E ON D .machine_id = E .machine_id WHERE TO_CHAR (A .start_date,\'yyyymmdd\') BETWEEN ? AND ? GROUP BY CART_NUMBER,E .machine_name,MACHINE_WASTER_NUMBER,A .start_date having COUNT ( DISTINCT c.convert_sheet_number )>0 ORDER BY 4', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('224', '00000000002', '1', '黑图信息统计历史任务列表', '9a7056fe00', 'SELECT id,cartnumber cart FROM ManualVerifyData where black_img_print=-1 and CONVERT(varchar,ProduceTime,120)>=\'20180101\'', '', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('225', '00000000005', '1', '指定车号查询印码号与大张喷码号', '0a9cb182fd', 'SELECT substr(c.sheet_num,6,4) \"sheet_num\",SUBSTR (c.head,5,4) \"code_num\" FROM QA_RECTIFY_MASTER A INNER JOIN WIP_JOBS b ON A .JOB_ID = b.JOB_ID INNER JOIN QA_RECTIFY_SLAVE c ON A .rectifym_id = c.rectifym_id WHERE CART_NUMBER = ? AND OPERATION_ID = 2', 'cart', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('226', '00000000005', '1', '查询指定车号丝印号码开位及喷码实废信息', '3470daa0be', 'SELECT SUBSTR (c.sheet_num,6,4) \"sheet_num\",SUBSTR (c.head,5,4) \"code_num\",E .convert_sheet_number \"convert_sheet_number\" FROM QA_RECTIFY_MASTER A INNER JOIN WIP_JOBS b ON A .JOB_ID = b.JOB_ID INNER JOIN QA_RECTIFY_SLAVE c ON A .rectifym_id = c.rectifym_id INNER JOIN QA_INSPECT_MASTER D ON A .job_id = D .job_id INNER JOIN QA_INSPECT_SLAVE E ON D .inspectm_id = E .inspectm_id AND SUBSTR (E .sheet_num,6,4) = SUBSTR (c.sheet_num,6,4) WHERE b.cart_number = ? AND E .image_blob IS NOT NULL AND D .ITEM_FLAG = 3 AND A .OPERATION_ID = 2', 'cart', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('227', '00000000005', '1', '丝印黑图查询demo', '217a3ad03d', 'SELECT SUBSTR (c.sheet_num,6,4) \"sheet_num\",SUBSTR (c.head,5,4) \"code_num\",E .convert_sheet_number \"convert_sheet_number\",( CASE WHEN LENGTH (E .image_blob) < 2000 THEN 1 ELSE 0 END ) \"is_black_img\",E .image_blob \"image_blob\" FROM QA_RECTIFY_MASTER A INNER JOIN WIP_JOBS b ON A .JOB_ID = b.JOB_ID INNER JOIN QA_RECTIFY_SLAVE c ON A .rectifym_id = c.rectifym_id INNER JOIN QA_INSPECT_MASTER D ON A .job_id = D .job_id INNER JOIN QA_INSPECT_SLAVE E ON D .inspectm_id = E .inspectm_id AND SUBSTR (E .sheet_num,6,4) = SUBSTR (c.sheet_num,6,4) WHERE b.cart_number =? AND E .image_blob IS NOT NULL AND D .ITEM_FLAG = 3 AND A .OPERATION_ID = 2 ORDER BY 4 desc', 'cart', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('228', '00000000005', '1', 'blob test', '5c135f7a01', 'SELECT c.ROUTE_SHEET_NUMBER \"相机\",c.CONVERT_SHEET_NUMBER \"开位\",c.SHEET_NUM \"印码号\",C.IMAGE_BLOB as \"img_blob\" FROM wip_jobs a INNER JOIN qa_inspect_master b ON a.job_id = b.job_id INNER JOIN qa_inspect_slave c ON b.inspectm_id = c.inspectm_id WHERE a.cart_number =? AND c.image_blob IS NOT NULL ORDER BY SUBSTR ( c.sheet_num,LENGTH (c.sheet_num) - 3,4 ),c.convert_sheet_number,c.route_sheet_number', 'cart', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('229', '00000000005', '1', '丝印产品开包量及黑图统计', 'b8603aa0b3', 'SELECT COUNT (*) \"opennum\",SUM (real_fake) \"real_fake\",( CASE WHEN b.\"check_black_img\" IS NULL THEN 0 ELSE b.\"check_black_img\" END ) \"check_black_img\",( CASE WHEN b.\"machine_black_img\" IS NULL THEN 0 ELSE b.\"machine_black_img\" END ) \"machine_black_img\" FROM ( SELECT G .job_id,COUNT (1) real_fake FROM qa_temp_qatbl G,wip_jobs a1 WHERE G .job_id = a1.job_id AND (a1.cart_number = ?) GROUP BY G .job_id,G .thousand_index,G .convert_num ) A LEFT JOIN ( SELECT b.job_id,SUM ( CASE WHEN LENGTH (E .image_blob) < 1100 THEN  1 ELSE  0 END ) \"check_black_img\",SUM ( CASE WHEN LENGTH (E .image_blob) BETWEEN 1100 AND 1300 THEN  1 ELSE  0 END ) \"machine_black_img\" FROM WIP_JOBS b INNER JOIN QA_INSPECT_MASTER D ON b.job_id = D .job_id INNER JOIN QA_INSPECT_SLAVE E ON D .inspectm_id = E .inspectm_id WHERE b.cart_number = ? AND E .image_blob IS NOT NULL AND D .ITEM_FLAG = 3 AND LENGTH (E .image_blob) < 2000 GROUP BY b.job_id ) b ON A .job_id = b.job_id GROUP BY A .job_id,b.\"check_black_img\",b.\"machine_black_img\"', 'cart,cart2', '', '2019-03-11 17:39:30', '2019-03-13 14:22:19', '1');
INSERT INTO `sys_api` VALUES ('230', '00000000003', '1', '码后票面黑图数查询', 'ad8df011c0', 'SELECT count(*) \"black_img_print\" FROM QFM_WIP_JOBS A INNER JOIN QFM_QA_INSPECT_MASTER b ON A .job_id = b.job_id INNER JOIN QFM_QA_INSPECT_SLAVE c ON b.inspectm_id = c.inspectm_id WHERE c.IMAGE_BLOB IS NOT NULL AND cart_number = ? and a.FINISHED_FLAG>=2 AND LENGTH (c.image_blob) < 1300', 'cart', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('231', '00000000007', '1', '号码黑图统计', 'b774523bf7', 'SELECT SUM (  CASE  WHEN LENGTH (D .image_blob) < 10000 THEN  1  ELSE  0  END ) \"black_img_code\" FROM WIP_JOBS A INNER JOIN WIP_PROD_LOGS b ON A .job_id = b.JOB_ID INNER JOIN QA_INSPECT_MASTER c ON b.log_id = c.log_id INNER JOIN QA_INSPECT_SLAVE D ON c.inspectm_id = D .inspectm_id WHERE CART_NUMBER = ? AND b.OPERATION_ID = 5 AND D .image_blob IS NOT NULL', 'cart', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('232', '00000000005', '1', '丝印黑图统计', 'e3e65e654a', 'SELECT SUM ( CASE WHEN LENGTH (E .image_blob) < 1100 THEN 1 ELSE 0 END ) \"check_black_img\",SUM ( CASE WHEN LENGTH (E .image_blob) BETWEEN 1100 AND 1300 THEN 1 ELSE 0 END ) \"machine_black_img\" FROM WIP_JOBS b INNER JOIN QA_INSPECT_MASTER D ON b.job_id = D .job_id INNER JOIN QA_INSPECT_SLAVE E ON D .inspectm_id = E .inspectm_id WHERE b.cart_number = ? AND E .image_blob IS NOT NULL AND D .ITEM_FLAG = 3 AND LENGTH (E .image_blob) < 2000', 'cart', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('233', '00000000002', '1', '更新黑图统计信息', 'ea308f1623', 'update manualverifydata set black_img_print = ?,black_img_code = ?,black_img_siyin_machine = ?,black_img_siyin_check = ? where id=?', 'black_img_print,black_img_code,black_img_siyin_machine,black_img_siyin_check,_id', '@id:_id. 参数说明：api 索引序号', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('234', '00000000014', '1', '图像判废每日指定品种待判车号列表', '651c80b3b9', 'WITH carts AS ( SELECT A.品种,A.车号,A.工艺,A.机台,A.工序 FROM VIEW_CARTFINDER A WHERE TO_CHAR (A.完成时间,\'YYYYMMDD\') BETWEEN ? AND ? and a.品种 in (?) AND A.工序 = \'印码\' and a.机台 not like \'人工大张班%\' ) SELECT distinct A.品种 \"prod_name\",A.车号 \"cart_number\",A.工艺 \"proc_name\",A.机台 \"machine_name\" FROM carts A INNER JOIN VIEW_CARTFINDER b ON A.车号 = b.车号 AND A.工序 = b.工序 GROUP BY A.品种,A.车号,A.工艺,A.机台 HAVING SUM (B.产量) = 10000', 'tstart,tend,prod', '', '2019-03-11 17:39:30', '2019-04-04 08:38:26', '0');
INSERT INTO `sys_api` VALUES ('235', '00000000003', '1', '指定车号丝印作废信息_码后', '3430c4697d', 'SELECT c.CONVERT_SHEET_NUMBER \"format_pos\",c.SHEET_NUM \"code_num\",0 \"type\" FROM qfm_wip_jobs A INNER JOIN qfm_qa_inspect_master b ON A .job_id = b.job_id AND A.cart_number = ? INNER JOIN qfm_qa_inspect_slave c ON b.inspectm_id = c.inspectm_id AND c.image_blob IS NOT NULL where \"SUBSTR\"(c.route_sheet_number,0,2) in (12,15)', 'cart', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('236', '00000000005', '1', '指定车号丝印作废信息_小核', 'bdcd036fe4', 'SELECT E .convert_sheet_number \"format_pos\",SUBSTR (c.head,5,4) \"code_num\",1 \"type\" FROM QA_RECTIFY_MASTER A INNER JOIN WIP_JOBS b ON A .JOB_ID = b.JOB_ID INNER JOIN QA_RECTIFY_SLAVE c ON A .rectifym_id = c.rectifym_id INNER JOIN QA_INSPECT_MASTER D ON A .job_id = D .job_id INNER JOIN QA_INSPECT_SLAVE E ON D .inspectm_id = E .inspectm_id AND SUBSTR (E .sheet_num,6,4) = SUBSTR (c.sheet_num,6,4) WHERE b.cart_number = ? AND E .image_blob IS NOT NULL AND D .ITEM_FLAG = 3 AND A .OPERATION_ID = 2 AND LENGTH (E .image_blob) > 2000', 'cart', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('237', '00000000003', '1', '指定车号丝印作废信息', 'aee865cf0f', 'select format_pos \"format_pos\",code_num \"code_num\",type \"type\" from ( SELECT DISTINCT c.CONVERT_SHEET_NUMBER format_pos,SUBSTR (SHEET_NUM,7,4) code_num,0 type FROM qfm_wip_jobs A INNER JOIN qfm_qa_inspect_master b ON A .job_id = b.job_id AND A .cart_number =? INNER JOIN qfm_qa_inspect_slave c ON b.inspectm_id = c.inspectm_id AND c.image_blob IS NOT NULL AND LENGTH (c.image_blob) > 1300 WHERE \"SUBSTR\" (c.route_sheet_number,0,2) IN (12,15) UNION ALL SELECT DISTINCT E .convert_sheet_number format_pos,SUBSTR (c.head,5,4) code_num,1 type FROM QA_RECTIFY_MASTER A INNER JOIN WIP_JOBS b ON A .JOB_ID = b.JOB_ID INNER JOIN QA_RECTIFY_SLAVE c ON A .rectifym_id = c.rectifym_id INNER JOIN QA_INSPECT_MASTER D ON A .job_id = D .job_id INNER JOIN QA_INSPECT_SLAVE E ON D .inspectm_id = E .inspectm_id AND SUBSTR (E .sheet_num,6,4) = SUBSTR (c.sheet_num,6,4) WHERE SUBSTR (b.cart_number,0,8) = ? AND E .item_flag = 3 AND D .ITEM_FLAG = 3 AND A .OPERATION_ID = 2 AND LENGTH (E .image_blob) > 2000 ) a order by 2,1', 'cart1,cart2', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('238', '00000000002', '1', '丝印后工序产生丝印实废', '835a5d56f2', 'SELECT top 200 rtrim(cartnumber) cart,id FROM ManualVerifyData a where fake_after_siyin is null and CONVERT(varchar,ProduceTime,120)>=\'20180101\' and mahouid>0 and substring(cartnumber,3,1)>0 order by id desc', '', '', '2019-03-11 17:39:30', '2019-07-24 18:51:58', '1');
INSERT INTO `sys_api` VALUES ('239', '00000000003', '1', '判废是否完成', 'f9b459beb8', 'select * from (SELECT DISTINCT A .cart_number,b.ITEM_FLAG FROM qfm_wip_jobs A INNER JOIN qfm_qa_inspect_master b ON A .job_id = b.job_id AND A .cart_number = ? AND b.ITEM_FLAG = 3 UNION ALL SELECT DISTINCT  b.cart_number, D .ITEM_FLAG FROM  QA_RECTIFY_MASTER A INNER JOIN WIP_JOBS b ON A .JOB_ID = b.JOB_ID INNER JOIN QA_RECTIFY_SLAVE c ON A .rectifym_id = c.rectifym_id INNER JOIN QA_INSPECT_MASTER D ON A .job_id = D .job_id WHERE  SUBSTR (b.cart_number,0,8) = ? AND D.ITEM_FLAG = 3) a', 'cart1,cart2', '', '2019-03-11 17:39:30', '2019-03-13 14:57:08', '1');
INSERT INTO `sys_api` VALUES ('240', '00000000003', '1', '开包量统计所需原始数据', '4ce83034b7', 'SELECT format_pos \"format_pos\",kilo_num \"kilo_num\",MIN (TYPE) \"type\" FROM ( SELECT DISTINCT c.CONVERT_SHEET_NUMBER format_pos,SUBSTR (sheet_num,7,1) kilo_num,0 TYPE FROM qfm_wip_jobs A INNER JOIN qfm_qa_inspect_master b ON A .job_id = b.job_id AND A .cart_number = ? and a.FINISHED_FLAG>=2 INNER JOIN qfm_qa_inspect_slave c ON b.inspectm_id = c.inspectm_id AND c.image_blob IS NOT NULL UNION SELECT DISTINCT E .convert_sheet_number format_pos,SUBSTR (c.head,5,1) kilo_num,1 TYPE FROM QA_RECTIFY_MASTER A INNER JOIN WIP_JOBS b ON A .JOB_ID = b.JOB_ID INNER JOIN QA_RECTIFY_SLAVE c ON A .rectifym_id = c.rectifym_id INNER JOIN QA_INSPECT_MASTER D ON A .job_id = D .job_id INNER JOIN QA_INSPECT_SLAVE E ON D .inspectm_id = E .inspectm_id AND SUBSTR (E .sheet_num,6,4) = SUBSTR (c.sheet_num,6,4) WHERE b.cart_number = ? AND E .item_flag = 3 AND A .OPERATION_ID = 2 ) A GROUP BY format_pos,kilo_num', 'cart1,cart2', '', '2019-03-11 17:39:30', '2019-03-13 14:27:05', '1');
INSERT INTO `sys_api` VALUES ('241', '00000000007', '1', '开包量统计所需号码原始数据', '773bffb950', 'SELECT DISTINCT D .convert_sheet_number \"format_pos\",SUBSTR (D .ex_codenum,7,1) \"kilo_num\",2 \"type\" FROM WIP_JOBS A INNER JOIN WIP_PROD_LOGS b ON A .job_id = b.JOB_ID INNER JOIN QA_INSPECT_MASTER c ON b.log_id = c.log_id INNER JOIN QA_INSPECT_SLAVE D ON c.inspectm_id = D .inspectm_id WHERE CART_NUMBER = ? AND b.OPERATION_ID = 5 AND D .image_blob IS NOT NULL ORDER BY 1', 'cart', '', '2019-03-11 17:39:30', '2019-03-13 14:27:05', '1');
INSERT INTO `sys_api` VALUES ('242', '00000000002', '1', '更新开包量及丝印数据分析结果', 'd4c0e74a28', 'update manualverifydata set fake_after_siyin = ?,fake_not_in_mahou = ?,ex_opennum = ?,ex_siyin_opennum = ?,ex_code_opennum = ? where id=?', 'fake_after_siyin,fake_not_in_mahou,ex_opennum,ex_siyin_opennum,ex_code_opennum,_id', '@id:_id. 参数说明：api 索引序号', '2019-03-11 17:39:30', '2019-03-13 14:27:05', '1');
INSERT INTO `sys_api` VALUES ('243', '00000000002', '1', '插入图像判废同步结果', '15cd589981', 'insert into manualverifydata(mahouid,cartnumber,producttypename,producetime,verifytime,verifyoperatorname,totalcount,vbigpiececount,vkaicount,vrealtotalcount,opennum,opennum_code,realfake_code,opennum_siyin,realfake_siyin ) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)', 'mahouid,cartnumber,producttypename,producetime,verifytime,verifyoperatorname,totalcount,vbigpiececount,vkaicount,vrealtotalcount,opennum,opennum_code,realfake_code,opennum_siyin,realfake_siyin', '', '2019-03-11 17:39:30', '2019-03-13 14:22:19', '1');
INSERT INTO `sys_api` VALUES ('244', '00000000002', '1', '批量更新不需要处理的任务', 'd68e782730', 'update ManualVerifyData set fake_after_siyin=-1 where cartnumber in (?)', 'carts', '', '2019-03-11 17:39:30', '2019-03-13 14:27:05', '1');
INSERT INTO `sys_api` VALUES ('245', '00000000002', '1', 'mahouid为空的车号列表', 'a60886074e', 'SELECT a.id,b.mahouid,rtrim(b.CartNumber) cart FROM MaHouData a INNER JOIN ManualVerifyData b ON a.CartNumber = b.CartNumber WHERE CONVERT (VARCHAR,b.ProduceTime,120) >= \\\'20180101\\\' AND b.mahouid IS NULL', '', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('246', '00000000002', '1', '更新mahouid为空的车号', '15e0869cc9', 'update manualverifydata set mahouid = ? where cartnumber=?', 'mahouid,cartnumber', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('247', '00000000014', '1', '指定车号中已完成抽查的产品', '0e7fc2bfec', 'SELECT DISTINCT 车号 \"carts\" FROM VIEW_CARTFINDER WHERE \"工序\" in (\'抽查\',\'裁封\') AND 车号 IN (?)', 'carts', '', '2019-03-11 17:39:30', '2019-03-14 15:27:07', '1');
INSERT INTO `sys_api` VALUES ('248', '00000000002', '1', '数据修复', '2d4988b35c', 'SELECT id,rtrim(cartnumber) cart FROM ManualVerifyData WHERE black_img_print =0 AND CONVERT (VARCHAR,ProduceTime,120) >= \\\'20181001\\\'', '', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('249', '00000000013', '1', '码后核查在库产品查询', 'f15c70ab61', 'select substr(regexp_replace(c.strbeginno,\'d\') ||        regexp_replace(c.strbeginno,\'D\'),       0,       6) \"gh\",   t.PROD_CODE \"prodid\",   replace(def.strproductname,\'主业品\') \"prodname\",   t.BRANCH_CODE \"tech\",   t.PROC_CODE \"proc\",   t.BATCH_NO \"carno\",   t.seq \"idx\",   t.review \"review\",    o.opennum \"ex_opennum\"  from vw_WIM_WHITELIST t  left join tbcare c   on t.BATCH_NO = c.strcarno  left join vw_wim_tb_black_list bl   on t.BATCH_NO = bl.BATCH_NO inner join tbproductdef def   on t.PROD_CODE = def.intproductid  left join tb_batch_opennum o   on t.BATCH_NO = o.carno  and t.PROD_CODE = o.prodid  and o.status = 1 where t.BRANCH_CODE in (?)  and t.proc_code = \'dzhp\' and bl.reason_desc is null order by t.prod_code,t.proc_code,t.BRANCH_CODE,t.seq', 'proc_type', '', '2019-03-11 17:39:30', '2019-03-13 10:13:23', '1');
INSERT INTO `sys_api` VALUES ('250', '00000000003', '1', '码后核查判废完工车号列表', 'b3d68925f6', 'select distinct cart_number \"cart_number\" from qfm_wip_jobs a where a.cart_number in (?) and finished_flag >=2', 'carts', '', '2019-03-11 17:39:30', '2019-03-13 10:13:24', '1');
INSERT INTO `sys_api` VALUES ('251', '00000000002', '1', '指定车号列表开包量查询', '26ec07bf0d', 'SELECT rtrim(CartNumber) cart,rtrim(ProductTypeName) prodname,ex_opennum,ex_siyin_opennum,ex_code_opennum,OpenNum opennum FROM ManualVerifyData where CartNumber in (?)', 'carts', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('252', '00000000017', '1', '立体库-人员信息', '6951b5f4f4', 'SELECT idx,organization,department,cardno,username FROM V_RSS_USERINFO;', '', '', '2019-03-11 17:39:30', '2019-04-04 13:01:03', '1');
INSERT INTO `sys_api` VALUES ('253', '00000000014', '1', '裁封自动线设备列表', '98ec8b20bd', 'select m.machine_id \"machine_id\",m.machine_no \"machine_no\" from tbbase_machine_info m where m.model_id=17 order by 1', '', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('254', '00000000013', '1', '产品品种列表', 'acb09730b3', 'select goods_code \"prod_id\",replace(goods_name,\'主业品\') \"prod_name\" from vw_wim_tbproductdef where goods_name like \'%主业品\'', '', '', '2019-03-11 17:39:30', '2019-05-25 14:06:53', '1');
INSERT INTO `sys_api` VALUES ('255', '00000000002', '1', '核查排活任务列表', '8d354d317b', 'SELECT a.machine_name,b.* FROM dbo.print_cut_machine AS a LEFT JOIN dbo.print_cut_task AS b ON a.machine_id = b.machine_id where isnull(a.is_delete,0)=0 and isnull(b.is_delete,0)=0', '', '', '2019-03-11 17:39:30', '2019-03-13 10:12:34', '1');
INSERT INTO `sys_api` VALUES ('256', '00000000002', '1', '裁封设备列表', 'cfc055d85b', 'select * from print_cut_machine', '', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('257', '00000000002', '1', '工艺列表', '8cc4ce7bb2', 'SELECT id value,rtrim(proc_type) name FROM print_cut_proc_list', '', '', '2019-03-11 17:39:30', '2019-03-18 08:43:32', '1');
INSERT INTO `sys_api` VALUES ('258', '00000000002', '1', '班次列表', '698d58a01a', 'SELECT a.worktype_id value,a.worktype_name name FROM dbo.print_cut_worktype AS a', '', '', '2019-03-11 17:39:30', '2019-03-18 08:43:33', '1');
INSERT INTO `sys_api` VALUES ('259', '00000000014', '1', '裁封自动线最近10天机台品种列表', 'aa72354335', 'SELECT t.MID \"machine_id\",T.机台 \"machine_name\",T.品种 \"prod_name\",max(to_char(完成时间,\'YYYYMMDD\')) \"last_produce_date\" FROM VIEW_CARTFINDER T WHERE 完成时间 IS NOT NULL and 工序 = \'裁封\' and months_between(完成时间,sysdate) >= -0.33 group by t.MID,T.品种,T.机台 order by 1,2,3', '', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('260', '00000000016', '1', '码后核查在库锁车产品列表', '4c0645f3d4', 'select \'\' gh,\'\' prodname,\'\' tech,a.reason_desc lock_reason,a.batch_no carno,b.opennum open_num from v_Wms_BlackInfo a left join tbl_cbpc_batch_opennum b on a.batch_no=b.cart', '', '', '2019-03-11 17:39:30', '2019-06-24 13:27:40', '1');
INSERT INTO `sys_api` VALUES ('261', '00000000013', '1', '在库产品开包量信息未同步车号列表', 'abf3f3f01d', 'select distinct t.PROD_CODE \"prod_id\",t.BATCH_NO \"car_no\" from vw_WIM_WHITELIST t left join tbcare c  on t.BATCH_NO = c.strcarno left join vw_wim_tb_black_list bl  on t.BATCH_NO = bl.BATCH_NO left join tb_black_reason br  on bl.REASON_DESC = br.reason_code inner join tbproductdef def  on t.PROD_CODE = def.intproductid left join tb_batch_opennum o  on t.BATCH_NO = o.carno and t.PROD_CODE = o.prodid where t.BRANCH_CODE in (\'码后核查\') and t.proc_code = \'dzhp\' and (opennum is null or opennum = 0)', '', '', '2019-03-11 17:39:30', '2019-03-13 10:13:34', '1');
INSERT INTO `sys_api` VALUES ('262', '00000000016', '1', '码后核查在库产品未判废或未同步车号列表', '37762ded85', 'SELECT DISTINCT a.品种 prodname,a.车号 carno,\'\' lock_reason,b.opennum open_num FROM v_cbpc_whitelist a LEFT JOIN tbl_cbpc_batch_opennum b ON a.车号 = b.cart WHERE a.工艺 = \'码后核查\' AND 工序 = \'大张号票\' AND b.opennum IS NULL', '', '', '2019-03-11 17:39:30', '2019-06-24 17:03:50', '1');
INSERT INTO `sys_api` VALUES ('263', '00000000002', '1', '新建排产任务信息', 'ba7f91af1b', 'insert into print_cut_task(prod_id,machine_id,worktype_id,num,proc_type_id,status,remark ) values (?,?,?,?,?,?,?)', 'prod_id,machine_id,worktype_id,num,proc_type_id,status,remark', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('264', '00000000002', '1', '移除排产任务', 'd4ca66f38a', 'update print_cut_task set is_delete=1 where task_id=?', 'task_id', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('265', '00000000002', '1', '更新排产任务', '62d86b30c1', 'update print_cut_task set prod_id = ?,machine_id = ?,worktype_id = ?,num = ?,proc_type_id = ?,status = ?,remark=? where task_id=?', 'prod_id,machine_id,worktype_id,num,proc_type_id,status,remark,task_id', '', '2019-03-11 17:39:30', '2019-03-13 10:13:03', '1');
INSERT INTO `sys_api` VALUES ('266', '00000000013', '1', '立体库查询一组产品锁车状态', 'fb6e7e01eb', 'select tbl.strcarno \"carno\"  from vw_wim_tb_black_list bl inner join tb_black_list tbl   on bl.BATCH_NO = tbl.strcarno  and tbl.intstatus = 1 inner join tbstock st   on bl.BATCH_NO = st.strcarno  and st.intstock > 0  where st.intorgid in    (1445,1446,1447,1448,1449,1450,1451,1452,1453,1454,1460)  and tbl.strcarno in (?)', 'carts', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('267', '00000000002', '1', '检封自动排产任务设置', 'e0cf91d414', 'SELECT * FROM ( SELECT a.task_id,a.machine_id,rtrim(b.ProductName) prod_name,c.machine_name,d.worktype_name,a.num,e.proc_type type,isnull(a.remark,\'\') remark,a.last_update_date,CAST (  LEFT (  CONVERT (VARCHAR,getdate(),114),2  ) AS INT ) curHour FROM print_cut_task a INNER JOIN ProductData b ON a.prod_id = b.ProductID INNER JOIN print_cut_machine c ON a.machine_id = c.machine_id INNER JOIN print_cut_worktype d ON a.worktype_id = d.worktype_id INNER JOIN print_cut_proc_list e ON a.proc_type_id = e.id WHERE a.status = 1 AND isnull(c.is_delete,0) = 0 AND isnull(a.is_delete,0) = 0 and a.num>0 AND CONVERT (VARCHAR,getdate(),112) > isnull(last_update_date,0) ) a WHERE worktype_name IN (?) --=(case when a.curHour between 1 and 7 then \'白班\' when a.curHour between 13 and 16 then \'中班\' else \'\' end)', 'worktypes', '', '2019-03-11 17:39:30', '2019-03-13 14:54:03', '1');
INSERT INTO `sys_api` VALUES ('268', '00000000013', '1', '指定车号在库信息查询', '5c9f14f76f', 'select substr(regexp_replace(c.strbeginno,\'\\d\') ||  regexp_replace(c.strbeginno,\'\\D\'), 0, 6) \"gh\",t.PROD_CODE \"prodid\",replace(def.strproductname,\'主业品\') \"prodname\",t.BRANCH_CODE \"tech\",t.PROC_CODE \"proc\",t.BATCH_NO \"carno\",t.seq \"idx\",t.review \"review\",br.reason_desc \"lock_reason\",o.opennum \"ex_opennum\" from vw_WIM_WHITELIST t left join tbcare c on t.BATCH_NO = c.strcarno left join vw_wim_tb_black_list bl on t.BATCH_NO = bl.BATCH_NO left join tb_black_reason br on bl.REASON_DESC = br.reason_code inner join tbproductdef def on t.PROD_CODE = def.intproductid left join tb_batch_opennum o on t.BATCH_NO = o.carno and t.PROD_CODE = o.prodid and o.status = 1 where t.batch_no in (?) and t.proc_code = \'dzhp\'  order by t.prod_code,t.proc_code,t.BRANCH_CODE,t.seq', 'carts', '', '2019-03-11 17:39:30', '2019-03-13 10:13:24', '1');
INSERT INTO `sys_api` VALUES ('269', '00000000016', '1', '开包量异常产品列表', '15c7b56487', 'select distinct c.[冠字] gh,a.品种 prodname,工艺 tech,a.车号 carno,b.opennum open_num from v_cbpc_whitelist a left join tbl_cbpc_batch_opennum b on a.车号=b.cart left join v_cbpc_cart_lite c on a.[车号]=c.[车号] where a.工艺=\'码后核查\' and 工序=\'大张号票\' and c.冠字<>\'\' and isnull(opennum,0) >= ( CASE WHEN a.品种 = \'9602A\' THEN ? WHEN a.品种 = \'9603A\' THEN ? WHEN a.品种 = \'9604A\' THEN ? WHEN a.品种 = \'9606A\' THEN ? WHEN a.品种 = \'9607T\' THEN ? ELSE 150 END )', 'prod2,prod3,prod4,prod6,prod7', '', '2019-03-11 17:39:30', '2019-06-24 17:04:43', '1');
INSERT INTO `sys_api` VALUES ('270', '00000000002', '1', '批量记录检封排产任务', '6f3ed8e1ec', 'insert into print_cut_prod_log(task_id,type,expect_num,real_num,gh,prodname,tech,carno,ex_opennum,status,rec_date,order_idx ) values ?', 'values', '@desc:批量插入数据时，约定使用二维数组values参数，格式为[{task_id,type,expect_num,real_num,gh,prodname,tech,carno,ex_opennum,status,rec_date }]，数组的每一项表示一条数据', '2019-03-11 17:39:30', '2019-04-09 13:42:37', '1');
INSERT INTO `sys_api` VALUES ('271', '00000000002', '1', '更新任务状态', '790ad70768', 'update print_cut_task set last_update_date = convert(varchar,getdate(),112) where task_id in (?)', 'task_id', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('272', '00000000002', '1', '各品种开包量限额', 'eae49a15d0', 'SELECT rtrim(Productname) prod_name,limit FROM ProductData where status=1', '', '', '2019-03-11 17:39:30', '2019-03-13 10:12:38', '1');
INSERT INTO `sys_api` VALUES ('273', '00000000002', '1', '更新品种开包量阈值设置', '920c2e5dfb', 'update ProductData set limit = ? where ProductName=?', 'limit,prod_name', '', '2019-03-11 17:39:30', '2019-03-13 10:12:57', '1');
INSERT INTO `sys_api` VALUES ('274', '00000000002', '1', '检封排活结果', '9a3ae8bb4b', 'select * from view_print_cut_prod_log where status<>-1 order by machine_id,status,worktype_id,order_idx', '', '', '2019-03-11 17:39:30', '2019-06-28 11:53:19', '1');
INSERT INTO `sys_api` VALUES ('275', '00000000002', '1', '取消单万排活任务', 'd8bbce63ca', 'update print_cut_prod_log set status = -1,update_date=getdate() where rec_id=?', 'rec_id', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('276', '00000000002', '1', '更新车号列表领用状态', '84a244aae0', 'update print_cut_prod_log set status = 1,update_date=getdate() where carno in (?)', 'carts', '', '2019-03-11 17:39:30', '2019-03-13 10:11:04', '1');
INSERT INTO `sys_api` VALUES ('277', '00000000002', '1', 'WMS-裁封机台排活任务列表', '76cac887ff', 'SELECT MAX (a.rec_id) rec_id,a.prod_name,a.machine_name,a.gh,a.tech,a.carno,a.ex_opennum,worktype_name,a.status status_id,(case when a.status=0 then \'未生产\' when a.status=1 then \'已生产\' else \'取消\' end) status,order_idx FROM dbo.view_print_cut_prod_log AS a WHERE a.machine_id =? AND status = 0 AND worktype_id in (?) GROUP BY a.prod_name,a.machine_name,a.gh,a.tech,a.carno,a.ex_opennum,worktype_name,a.status,order_idx ORDER BY worktype_name,order_idx', 'machine_id,worktype_name', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('278', '00000000002', '1', '中班排产前将未完成产品置为取消领用', '8c0a03ef4d', 'update print_cut_prod_log set status = -1,update_date=getdate() where carno in (?)', 'carts', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('279', '00000000002', '1', '手工执行排产任务', '48ac2dc14d', 'SELECT * FROM (  SELECT  a.task_id, a.machine_id, rtrim(b.ProductName) prod_name, c.machine_name, d.worktype_name, a.num, e.proc_type type, isnull(a.remark,\'\') remark, a.last_update_date, CAST (   LEFT (   CONVERT (VARCHAR,getdate(),114),  2   ) AS INT  ) curHour  FROM  print_cut_task a  INNER JOIN ProductData b ON a.prod_id = b.ProductID  INNER JOIN print_cut_machine c ON a.machine_id = c.machine_id  INNER JOIN print_cut_worktype d ON a.worktype_id = d.worktype_id  INNER JOIN print_cut_proc_list e ON a.proc_type_id = e.id  WHERE  a.status = 1  AND isnull(a.is_delete,0) = 0  AND isnull(c.is_delete,0) = 0  AND CONVERT (VARCHAR,getdate(),112) >= isnull(last_update_date,0) ) a WHERE worktype_name IN (?)', 'worktypes', '', '2019-03-11 17:39:30', '2019-03-13 10:13:23', '1');
INSERT INTO `sys_api` VALUES ('280', '00000000002', '1', '当天产品取消生产', 'a267292c67', 'update print_cut_prod_log set status = -1,update_date=getdate() where convert(varchar,rec_date,112) = convert(varchar,GETDATE(),112) and status = 0', '', '', '2019-03-11 17:39:30', '2019-04-09 13:42:37', '1');
INSERT INTO `sys_api` VALUES ('281', '00000000005', '1', '码前分流-丝印工序判废实废数及开包量', '76f6def958', 'SELECT count(distinct E.convert_sheet_number || sheet_num) \"fake_num\" FROM QA_RECTIFY_MASTER A INNER JOIN WIP_JOBS b  ON A.JOB_ID = b.JOB_ID LEFT JOIN QA_INSPECT_MASTER D  ON A.job_id = D.job_id LEFT JOIN QA_INSPECT_SLAVE E  ON D.inspectm_id = E.inspectm_id WHERE b.cart_number = ? AND E.image_blob IS NOT NULL AND D.ITEM_FLAG = 3 AND A.OPERATION_ID = 11', 'cart', '', '2019-03-11 17:39:30', '2019-03-13 13:30:02', '1');
INSERT INTO `sys_api` VALUES ('282', '00000000002', '1', '指定时间内丝印实废百分位30%及70%产品信息', '99d7dadab5', 'WITH realFakeSiyin AS ( SELECT  a.realfake_siyin realfake, order_idx = rank () OVER (ORDER BY realfake_siyin DESC) FROM  dbo.ManualVerifyData AS a WHERE  CONVERT (VARCHAR,ProduceTime,112) BETWEEN ?  AND ?  AND a.ProductTypeName = \'9607T\' AND a.ex_siyin_opennum IS NOT NULL ) select a.realfake seventy_percent,b.realfake thirty_percent from (SELECT  TOP 1 realfake FROM realFakeSiyin WHERE order_idx < (  SELECT  COUNT (*)  FROM  realFakeSiyin ) * 0.7 ORDER BY order_idx DESC) a,(SELECT TOP 1 realfake FROM realFakeSiyin WHERE order_idx < (  SELECT  COUNT (*)  FROM  realFakeSiyin ) * 0.3 ORDER BY order_idx DESC)b', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('283', '00000000013', '1', '立体库过数名单类别', '5bd22f6aeb', 'select distinct v.PROD_CODE \"prodid\",v.PROC_CODE \"proc_code\",def.GOODS_NAME \"prod_name\",proc.PROCESS_NAME \"proc_name\",v.BRANCH_CODE \"branch_code\" from vw_wim_countlist v inner join vw_wim_tbproductdef def on v.PROD_CODE=def.GOODS_CODE inner join vw_wim_tbprocess proc on v.PROC_CODE=proc.PROCESS_CODE order by def.GOODS_NAME,proc.PROCESS_NAME', '', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('284', '00000000002', '1', '核查排产结果汇总', '43aa65d139', 'SELECT c.machine_name AS [裁切机台],a.expect_num AS [预计开包量],a.real_num AS [实际开包量],a.gh AS [冠号],a.carno AS [车号],a.ex_opennum AS [通知开包量],b.productType AS [品种],b.totalPieceCount AS [实废小开],b.totalOpenNum AS [剔废开包量],convert(varchar,a.rec_date,120) 排产时间,(case when a.status=0 then \\\'未生产\\\' when a.status=1 then \\\'已生产\\\' else \\\'其他\\\' end) 生产状态 FROM print_cut_prod_log a LEFT JOIN OCRData b ON a.carno = b.cartNumber  LEFT JOIN print_cut_task d ON a.task_id = d.task_id LEFT JOIN print_cut_machine c ON d.machine_id = c.machine_id WHERE a.tech = \\\'码后核查\\\' and a.status>-1 and convert(varchar,a.rec_date,112) between ? and ?', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-13 10:14:01', '1');
INSERT INTO `sys_api` VALUES ('285', '00000000002', '1', '检封机台实际开包量汇总', '51d816d1fc', 'select 机台,生产日期,班次,机长,品种,sum(totalopennum) 总开包量,count(*) 大万数,avg(totalopennum) 机台平均开包量 from (SELECT distinct a.MachineName 机台,CONVERT (VARCHAR,StartDate,112) 生产日期,a.WorkClassName 班次,a.CaptainName 机长,b.productType AS [品种],b.totalOpenNum ,a.cartnumber FROM CartInfoData a LEFT JOIN OCRData b ON a.CartNumber = b.cartNumber WHERE a.NoteAnayID > 0 AND a.ProcName = \'裁封\' AND CONVERT (VARCHAR,StartDate,112) BETWEEN ? AND ? AND a.TechTypeName = \'码后核查\' ) a group by 机台,生产日期,班次,机长,品种 ORDER BY 2,5 DESC,3,6', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-13 10:14:01', '1');
INSERT INTO `sys_api` VALUES ('286', '00000000002', '1', '近200车产品建议走码后及全检丝印实废条数', 'd4c4ccbed3', 'WITH realFakeSiyin AS ( SELECT  a.realfake_siyin realfake, order_idx = rank () OVER (ORDER BY realfake_siyin DESC) FROM  dbo.ManualVerifyData AS a WHERE  a.id IN (  SELECT   TOP 200 a.id  FROM   dbo.ManualVerifyData AS a  WHERE   a.ProductTypeName = \\\'9607T\\\'  AND a.ex_siyin_opennum IS NOT NULL  ORDER BY   a.MahouID DESC  ) ) SELECT a.realfake mahou,b.realfake allcheck FROM (  SELECT  TOP 1 realfake  FROM  (   SELECT   TOP 60 *   FROM   realFakeSiyin   ORDER BY   order_idx DESC  ) a  ORDER BY  order_idx ) a,(  SELECT  TOP 1 realfake  FROM  (   SELECT   TOP 60 *   FROM   realFakeSiyin   ORDER BY   order_idx  ) a  ORDER BY  order_idx DESC ) b', '', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('287', '00000000002', '1', '码前自动分流-记录自动分流信息', 'ec7940dc77', 'insert into dbo.print_wms_autoproc(cart,rec_time,fake_num,mahou,allcheck,auto_proc_name ) values (?,?,?,?,?,?)', 'cart,rec_time,fake_num,mahou,allcheck,auto_proc_name', '', '2019-03-11 17:39:30', '2019-03-13 13:30:03', '1');
INSERT INTO `sys_api` VALUES ('288', '00000000005', '1', '实时获取丝印近400车产品建议走码后及全检品实废数', '951314319e', 'WITH cartlist AS (SELECT A.* FROM (SELECT b.cart_number,D.inspectm_id FROM QA_RECTIFY_MASTER A INNER JOIN WIP_JOBS b ON A.JOB_ID = b.JOB_ID LEFT JOIN QA_INSPECT_MASTER D ON A.job_id = D.job_id WHERE A.OPERATION_ID = 11 AND D.ITEM_FLAG = 3 ORDER BY b.start_date DESC) A WHERE ROWNUM <= 450),carts_row AS (SELECT ROWNUM row_id,A.fake_num FROM (SELECT b.cart_number,count(distinct a.convert_sheet_number || sheet_num) fake_num FROM QA_INSPECT_SLAVE A INNER JOIN cartlist b ON A.inspectm_id = b.inspectm_id WHERE A.image_blob IS NOT NULL GROUP BY b.cart_number ORDER BY 2) A where rownum<=400),tbl_thread AS (SELECT ROWNUM row_idx,A.fake_num FROM carts_row A INNER JOIN (SELECT CAST(MAX(A.row_id) * 0.25 AS INT) mahou,CAST(MAX(row_id) * 0.8 AS INT) allcheck  FROM carts_row A) b ON A.row_id = b.mahou OR A.row_id = b.allcheck) SELECT SUM(CASE WHEN row_idx = 1 THEN fake_num ELSE 0 END) \"mahou\",SUM(CASE WHEN row_idx = 2 THEN fake_num ELSE 0 END) \"allcheck\" FROM tbl_thread', '', '', '2019-03-11 17:39:30', '2019-07-24 19:32:54', '1');
INSERT INTO `sys_api` VALUES ('289', '00000000002', '1', '码前产品工艺自动优选', 'ee8ec83580', 'SELECT  a.cart 车号,CONVERT (VARCHAR,a.rec_time,120) 工艺变更时间,a.fake_num 丝印实废开数,a.mahou 转码后阈值,a.allcheck 转全检阈值,a.auto_proc_name 工艺设置 FROM print_wms_autoproc a WHERE id IN (  SELECT  MAX (a.id) id  FROM  print_wms_autoproc a  WHERE  CONVERT (VARCHAR,a.rec_time,112) BETWEEN ?  AND ?  GROUP BY  a.cart ) ORDER BY a.id desc', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-13 10:14:03', '1');
INSERT INTO `sys_api` VALUES ('290', '00000000002', '1', '车号列表工艺调整', '61e1d54463', 'SELECT cart FROM print_wms_autoproc where fake_num=897 and id between 100 and 169', '', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('291', '00000000002', '1', '当前车号是否已处理过', '68875f126c', 'select id from print_wms_autoproc where cart=?', 'cart', '', '2019-03-11 17:39:30', '2019-03-13 13:30:03', '1');
INSERT INTO `sys_api` VALUES ('292', '00000000002', '1', '检封排产-记录立体库白名单日志', '24d9222347', 'insert into dbo.print_cut_wms_log(remark,rec_time ) values (?,?)', 'remark,rec_time', '', '2019-03-11 17:39:30', '2019-03-13 10:13:24', '1');
INSERT INTO `sys_api` VALUES ('293', '00000000002', '1', '更新当前班次排产状态', 'ac87697ca1', 'update print_cut_task set last_update_date=convert(varchar,GETDATE(),112) where isnull(is_delete,0)=0 and status = 1 and worktype_id=?', 'worktype', '', '2019-03-11 17:39:30', '2019-04-09 13:42:37', '1');
INSERT INTO `sys_api` VALUES ('294', '00000000018', '1', '修改电话号码', '5aa9a520df', 'update tbl_base_phone set username=?,phone=?,dept_id=?,order_index=? where id=?', 'username,phone,dept_id,order_index,_id', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('295', '00000000019', '1', 'ERP实际发出账户别名查询', 'eeed6b24b3', 'select distinct t.description \"name\" from tberp_payout t where t.description like \'%\'||?||\'%\'', 'q', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('296', '00000000021', '1', '大张离线检测设备开机天数查询', 'e21c795c35', 'SELECT \'胶印\' 工序,b.fname 设备,CONVERT (VARCHAR(6),a.rec_time,112) 月份,COUNT ( DISTINCT CONVERT (VARCHAR,a.rec_time,112) ) 工作日 FROM view_score_offset a LEFT JOIN tEquipmentList b ON a.offset_machine_id = b.FID where CONVERT (VARCHAR,a.rec_time,112) between ? and ? GROUP BY b.fname,CONVERT (VARCHAR(6),a.rec_time,112) UNION ALL SELECT \'凹印\' 工序,b.fname 设备,CONVERT (VARCHAR(6),a.rec_time,112) 月份,COUNT ( DISTINCT CONVERT (VARCHAR,a.rec_time,112) ) 工作日 FROM view_score_intaglio a LEFT JOIN tEquipmentList b ON a.offset_machine_id = b.FID where CONVERT (VARCHAR,a.rec_time,112) between ? and ? GROUP BY b.fname,CONVERT (VARCHAR(6),a.rec_time,112) ORDER BY 1,2', 'tstart,tend,tstart2,tend2', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('297', '00000000004', '1', '我的工作列表', 'cf86aaa28a', 'SELECT top 5 a.id,(case when a.状态=\'未关闭\' then 0 else 1 end) status,(case when 工序=\'其它\' then \'\' else \'【\'+工序+\'】\' end)+a.标题 title,发起人 as \'user\',记录时间 as datetime,set_avatar avatar,avatarkey,阅读数 readnum,已阅人员 readers FROM view_article a where 发起人 like ? and sys_id=? and isnull(is_hide,0)=0 order by 记录时间 desc', 'user,sys_id', '', '2019-03-11 17:39:30', '2019-08-02 10:26:14', '1');
INSERT INTO `sys_api` VALUES ('298', '00000000004', '1', '文章详情', '2011115320', 'SELECT a.id,a.title,a.prod,a.[proc] \"proc\",a.machine,a.operator,a.cartno,c.cate_name category,a.content,a.status,a.uid,a.rec_time,a.attach_list,a.status_username,a.status_rectime,a.reward,a.reward_status,a.reward_user,a.receiver,a.remark,a.readnum,a.commentnum,a.read_users,a.is_hide,a.sys_id,isnull(b.fullName,\'无\') AS \"user\",convert(varchar,rec_time,120) AS datetime,notice_id FROM dbo.tbl_article AS a LEFT JOIN tblUser b ON a.uid = b.id left join tbl_cate_list c on a.cate_id=c.cate_id WHERE a.id=?', 'aid', '', '2019-03-11 17:39:30', '2019-04-18 17:43:48', '1');
INSERT INTO `sys_api` VALUES ('299', '00000000004', '1', '各主题文章列表', 'bcdc7669bf', 'SELECT * FROM ( SELECT row_number () OVER ( partition BY 问题分类 ORDER BY a.id DESC ) rn,a.id,a.问题分类 category,(case when a.状态=\'未关闭\' then 0 else 1 end) status,(case when 工序=\'其它\' then \'\' else \'【\'+工序+\'】\' end)+a.标题 title,发起人 as \'user\',记录时间 as datetime,set_avatar avatar,avatarkey,阅读数 readnum,已阅人员 readers FROM view_article a where sys_id=?) T WHERE rn <= 5', 'sys_id', '', '2019-03-11 17:39:30', '2019-03-13 10:17:40', '1');
INSERT INTO `sys_api` VALUES ('300', '00000000004', '1', '文章评论', '3a4c83f64a', 'SELECT a.comment_id,a.uid,a.username,convert(varchar,a.rec_time,120) rec_time,a.useravatar,a.content FROM dbo.tbl_article_comment AS a where article_id=? order by comment_id', 'aid', '', '2019-03-11 17:39:30', '2019-03-13 10:17:45', '1');
INSERT INTO `sys_api` VALUES ('301', '00000000004', '1', '附件列表', 'e7bf22591e', 'SELECT * FROM tbl_article_attach where id in (?)', 'attachid', '', '2019-03-11 17:39:30', '2019-03-13 10:17:45', '1');
INSERT INTO `sys_api` VALUES ('302', '00000000004', '1', '我的工作列表', '6c3674d6c2', 'SELECT top 5 a.id,(case when a.状态=\'未关闭\' then 0 else 1 end) status,(case when 工序=\'其它\' then \'\' else \'【\'+工序+\'】\' end)+a.标题 title,发起人 as \'user\',记录时间 as datetime,set_avatar avatar,avatarkey,阅读数 readnum,已阅人员 readers FROM view_article a where 发起人 like ? and sys_id=? order by 记录时间 desc', 'user', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('303', '00000000004', '1', '新闻列表', '1dd06c4feb', 'SELECT top 10 a.id,a.状态 status,(case when 工序=\'其它\' then \'\' else \'【\'+工序+\'】\' end)+a.标题 title,发起人 as \'user\',记录时间 as datetime,set_avatar avatar,avatarkey,评论数 commentnum FROM view_article a where 问题分类=? and convert(varchar(4),记录时间,120)>\'2017\' and sys_id=? order by 记录时间 desc', 'listid,sys_id', '', '2019-03-11 17:39:30', '2019-03-13 10:18:08', '1');
INSERT INTO `sys_api` VALUES ('304', '00000000004', '1', '我的工作列表分页', '137aea8cd0', 'SELECT top 20 a.id,a.状态 status,(case when 工序=\'其它\' then \'\' else \'【\'+工序+\'】\' end)+a.标题 title,发起人 as \'user\',记录时间 as datetime,set_avatar avatar,avatarkey,评论数 commentnum FROM view_article a where 发起人 like ? and a.id< ? and convert(varchar(4),记录时间,120) >\'2017\' and sys_id=? order by 记录时间 desc', 'user,aid,sys_id', '', '2019-03-11 17:39:30', '2019-03-13 10:17:49', '1');
INSERT INTO `sys_api` VALUES ('305', '00000000004', '1', '数据分页', 'decabfe0c7', 'SELECT TOP 20 a.id,a.status,a.title,isnull(b.fullName,\'无\') AS \'user\',CONVERT (VARCHAR,a.rec_time,120) AS datetime,b.set_avatar avatar,CAST (b.id AS VARCHAR) + rtrim(b.UserName) AS avatarkey FROM tbl_article AS a LEFT JOIN tblUser b ON a.uid = b.id LEFT JOIN tbl_cate_list c ON a.cate_id = c.cate_id WHERE CONVERT (VARCHAR(4),a.rec_time,120) > \'2017\' AND c.cate_name =? AND a.id < ? AND sys_id =? ORDER BY a.id DESC', 'listid,aid,sys_id', '', '2019-03-11 17:39:30', '2019-06-13 08:30:18', '1');
INSERT INTO `sys_api` VALUES ('306', '00000000004', '1', '媒体库', '136f90d1fd', 'SELECT top 25 a.id,a.name,(case when substring(a.type,8,4)=\\\'webp\\\' then \\\'image\\\' when substring(a.type,1,5)=\\\'audio\\\' then \\\'audio\\\' when substring(a.type,1,5)=\\\'video\\\' then \\\'video\\\' else \\\'other\\\' end) type,a.url,a.width,a.height FROM tbl_article_attach a where a.uid = ? and (case when substring(a.type,8,4)=\\\'webp\\\' then \\\'image\\\' when substring(a.type,1,5)=\\\'audio\\\' then \\\'audio\\\' when substring(a.type,1,5)=\\\'video\\\' then \\\'video\\\' else \\\'other\\\' end)=? order by a.id desc', 'uid,type', '', '2019-03-11 17:39:30', '2019-03-13 10:17:54', '1');
INSERT INTO `sys_api` VALUES ('307', '00000000004', '1', '媒体库载入更多', '3c7dd0e46e', 'SELECT top 25 a.id,a.name,(case when substring(a.type,8,4)=\'webp\' then \'image\' when substring(a.type,1,5)=\'audio\' then \'audio\' when substring(a.type,1,5)=\'video\' then \'video\' else \'other\' end) type,a.url,a.width,a.height FROM tbl_article_attach a where a.uid = ? and (case when substring(a.type,8,4)=\'webp\' then \'image\' when substring(a.type,1,5)=\'audio\' then \'audio\' when substring(a.type,1,5)=\'video\' then \'video\' else \'other\' end)=? and id< ? order by a.id desc', 'uid,type,maxid', '', '2019-03-11 17:39:30', '2019-03-13 10:17:56', '1');
INSERT INTO `sys_api` VALUES ('308', '00000000004', '1', '用户列表', '2076a6d913', 'SELECT a.ID id,rtrim(a.UserName) name,rtrim(a.FullName) username,a.set_avatar avatar,b.DepartMentName dept FROM tblUser a left join tblDepartMent b on a.DepartMent=b.dptid ORDER BY a.id', '', '', '2019-03-11 17:39:30', '2019-03-13 10:17:40', '1');
INSERT INTO `sys_api` VALUES ('309', '00000000004', '1', '文章搜索', '3e91a80017', 'SELECT a.id,a.status,a.category,a.title,isnull(b.fullName,\\\'无\\\') as \\\'user\\\',convert(varchar,a.rec_time,120) as datetime,b.set_avatar avatar,cast(b.id as varchar)+rtrim(b.UserName) as avatarkey FROM dbo.tbl_article AS a left join tblUser b on a.uid = b.id where a.title+a.content LIKE ? order by a.id desc', 'key', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('310', '00000000004', '1', '文章评论数', '0f4099a412', 'update tbl_article set commentnum=(select (ISNULL(commentnum,0))+1 where id=?) where id = ?', 'aid,aid2', '', '2019-03-11 17:39:30', '2019-03-14 11:42:27', '1');
INSERT INTO `sys_api` VALUES ('311', '00000000004', '1', '文章阅读数记录', '39225a57a3', 'update tbl_article set readnum=(select isnull(readnum,0)+1 where id=?) where id = ?', 'aid,aid2', '', '2019-03-11 17:39:30', '2019-03-13 10:17:45', '1');
INSERT INTO `sys_api` VALUES ('312', '00000000004', '1', '密码校验', '203b7261ef', 'SELECT a.ID FROM dbo.tblUser AS a where a.ID = ? and UserPassword=?', 'uid,psw', '', '2019-03-11 17:39:30', '2019-03-13 10:18:13', '1');
INSERT INTO `sys_api` VALUES ('313', '00000000004', '1', '更新阅读者信息', 'b951835b08', 'update tbl_article set read_users = ? where id=?', 'read_users,_id', '@id:_id. 参数说明：api 索引序号', '2019-03-11 17:39:30', '2019-03-13 10:18:21', '1');
INSERT INTO `sys_api` VALUES ('314', '00000000004', '1', '文章类别列表', 'd36c7f1ade', 'select cate_id value,cate_name name from tbl_cate_list where sys_type_id=? order by order_id', 'sys_type_id', '', '2019-03-11 17:39:30', '2019-04-18 13:23:10', '1');
INSERT INTO `sys_api` VALUES ('315', '00000000002', '1', '印钞设备列表', '4b7428141a', 'SELECT MachineID,MachineName FROM MachineData WHERE bHide =0 AND ProcType = ?', 'p', '', '2019-03-11 17:39:30', '2019-03-20 15:17:08', '1');
INSERT INTO `sys_api` VALUES ('316', '00000000004', '1', '新增文章', '523c5e087b', 'insert into tbl_article(uid,rec_time,attach_list,prod,[proc],machine,operator,cartno,cate_id,content,title,receiver,remark,reward,reward_status,reward_user,status_username,sys_id,notice_id ) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)', 'uid,rec_time,attach_list,prod,proc,machine,operator,cartno,cate_id,content,title,receiver,remark,reward,reward_status,reward_user,status_username,sys_id,notice_id', '', '2019-03-11 17:39:30', '2019-04-18 17:25:54', '1');
INSERT INTO `sys_api` VALUES ('317', '00000000004', '1', '更新附件id信息', 'e48847dce3', 'update tbl_article_attach set article_id = ? where id in (?)', 'article_id,_id', '', '2019-03-11 17:39:30', '2019-03-19 13:51:09', '1');
INSERT INTO `sys_api` VALUES ('318', '00000000001', '1', 'RTX是否在线', 'caaabab207', 'http://10.8.2.111:8012/isonline.php?rtxid=?', 'rtxid', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('319', '00000000001', '1', 'RTX消息推送代理', 'b804147c6e', 'http://10.8.2.111:8012/sendnotify.cgi?delaytime=?&title=?&msg=?&receiver=?', 'delaytime,title,msg,receiver', '', '2019-03-11 17:39:30', '2019-03-14 10:58:18', '1');
INSERT INTO `sys_api` VALUES ('320', '00000000004', '1', '添加评论', '7bdb354d30', 'insert into tbl_article_comment(rec_time,content,article_id,username,uid,useravatar ) values (?,?,?,?,?,?)', 'rec_time,content,article_id,username,uid,useravatar', '', '2019-03-11 17:39:30', '2019-03-14 11:42:27', '1');
INSERT INTO `sys_api` VALUES ('321', '00000000004', '1', '删除评论', '8c7c57cc9e', 'delete from tbl_article_comment where comment_id=?', 'comment_id', '', '2019-03-11 17:39:30', '2019-03-19 16:09:51', '1');
INSERT INTO `sys_api` VALUES ('322', '00000000004', '1', '更新文章', 'f6f8711acf', 'update tbl_article set attach_list = ?,prod = ?,[proc] = ?,machine = ?,operator = ?,cartno = ?,content = ?,title = ?,receiver = ?,remark = ?,reward_user = ?,readnum = ?,commentnum = ?,read_users = ?,cate_id = ? where id=?', 'attach_list,prod,proc,machine,operator,cartno,content,title,receiver,remark,reward_user,readnum,commentnum,read_users,cate_id,_id', '@id:_id. 参数说明：api 索引序号', '2019-03-11 17:39:30', '2019-03-19 12:46:05', '1');
INSERT INTO `sys_api` VALUES ('323', '00000000004', '1', '更新阅读状态', '5d0c90b2e3', 'update tbl_article set status = ?,status_username = ?,status_rectime = ?,remark=? where id=?', 'status,status_username,status_rectime,remark,_id', '@id:_id. 参数说明：api 索引序号', '2019-03-11 17:39:30', '2019-03-18 16:53:36', '1');
INSERT INTO `sys_api` VALUES ('324', '00000000017', '1', '立库-请求响应(周期）', '30d9096aae', 'SELECT  v.asrsid,v.recpaytype,v.businesstype,v.isoffline,v.insertat,v.taskstart,v.taskend,v.status,v.pickuplocation,v.prodid,v.processcode,v.techcode,v.reviewtag,v.carno,v.reqquantity,v.applicantname,v.applicantorg,v.executorname,v.executororg,v.asrscell,v.carda,v.cardb,v.appoint FROM V_RSS_REQUEST_API v WHERE CONVERT ( VARCHAR,dateadd ( HOUR,- 3,v.insertat ),112 ) BETWEEN ? AND ? ORDER BY v.insertat', 'sdate,edate', '', '2019-03-11 17:39:30', '2019-03-13 10:11:21', '1');
INSERT INTO `sys_api` VALUES ('325', '00000000007', '1', '数据库硬盘空间占用大小', '028fcde1fe', 'SELECT A .tablespace_name 表空间名,round(total / (1024 * 1024 * 1024),2)||\'G\' 表空间,round(free / (1024 * 1024 * 1024),2)||\'G\' 剩余空间,round((total - free) / (1024 * 1024 * 1024),2)||\'G\' 已使用,ROUND ((total - free)*100 / total,2)||\'%\' 使用率 FROM ( SELECT tablespace_name,SUM (bytes) free FROM dba_free_space GROUP BY tablespace_name ) A LEFT JOIN ( SELECT tablespace_name,SUM (bytes) total FROM dba_data_files GROUP BY tablespace_name ) b ON A .tablespace_name = b.tablespace_name order by total desc', '', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('326', '00000000007', '1', '数据库连接数', '95e994fadf', 'SELECT a.num 会话数,b.ALLOW_CONNECTS 最大连接数,b.ALLOW_CONNECTS-a.num 剩余会话数 FROM (  SELECT  COUNT (A .terminal) num  FROM  v$process A  WHERE  PROGRAM = \\\'ORACLE.EXE (SHAD)\\\' ) A,(  SELECT  VALUE  allow_connects  FROM  v$parameter  WHERE  NAME = \\\'processes\\\' ) b', '', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('327', '00000000017', '1', '立体库-Whitelist', 'dd761fa8db', 'SELECT w.BATCH_NO,g.GOODS_NAME,p.PROCESS_NAME,w.BRANCH_CODE,w.REVIEW,w.SEQ FROM L0378.V_RSS_WHITELIST w LEFT JOIN L0378.V_RSS_GOODS g ON w.PROD_CODE = g.GOODS_CODE LEFT JOIN L0378.V_RSS_PROCESS p ON w.PROC_CODE = p.PROCESS_CODE WHERE w.BATCH_NO NOT IN (SELECT BATCH_NO FROM L0378.V_RSS_BLACKLIST);', '', '', '2019-03-11 17:39:30', '2019-03-29 11:50:52', '1');
INSERT INTO `sys_api` VALUES ('328', '00000000017', '1', '立体库-Countlist', '69edc33858', 'SELECT w.BATCH_NO,g.GOODS_NAME,p.PROCESS_NAME,w.BRANCH_CODE,w.SEQ FROM L0378.V_RSS_COUNTLIST w LEFT JOIN L0378.V_RSS_GOODS g ON w.PROD_CODE = g.GOODS_CODE LEFT JOIN L0378.V_RSS_PROCESS p ON w.PROC_CODE = p.PROCESS_CODE;', '', '', '2019-03-11 17:39:30', '2019-03-13 21:23:12', '1');
INSERT INTO `sys_api` VALUES ('329', '00000000017', '1', '立体库-Blacklist', 'bcba0084da', 'SELECT BATCH_NO FROM L0378.V_RSS_BLACKLIST;', '', '', '2019-03-11 17:39:30', '2019-03-13 21:23:17', '1');
INSERT INTO `sys_api` VALUES ('330', '00000000021', '1', '凹印大张离线检测得分汇总', '26da912feb', 'SELECT a.机长,a.次数 张数,a.机台,a.品种,a.正反面,a.墨色,a.胶凹套印,a.凹印接线,a.总分,a.小开数 * 次数 小张总数,ceiling(  a.小开数 * 次数 * a.总分 / 100 ) 合格小开数 FROM (  SELECT  a.captain_name 机长, COUNT (1) 次数, a.machine_name 机台, a.prod_name 品种, a.sidename 正反面, round(AVG(a.JPIColor),2) 墨色, round(AVG(a.OIOVer),2) 胶凹套印, round(AVG(a.JPICon),2) 凹印接线, round(AVG(a.score),2) 总分, (   CASE   WHEN a.prod_name IN (\\\'9602A\\\',\\\'9603A\\\') THEN   40   ELSE   35   END  ) 小开数  FROM  dbo.view_score_intaglio AS a  WHERE  CONVERT (VARCHAR,rec_time,112) BETWEEN ?  AND ?  AND a.operator_name = \\\'印钞管理部\\\'  GROUP BY  a.captain_name, a.machine_name, a.prod_name, a.sidename ) a order by 4,5,3,1', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('331', '00000000016', '1', '机台作业信息追溯', '8ed6e81fa3', 'SELECT 车号 \"CartNumber\",冠号 \"CarNumber\",字号 \"GzNumber\",工艺 \"TechTypeName\",工序 \"ProcName\",班次 \"WorkClassName\",机台 \"MachineName\",机长 \"CaptainName\",班组 \"TeamName\",班长 \"MonitorName\",产量 \"PrintNum\",convert (varchar, 开始时间, 120 ) \"StartDate\",品种 \"ProductName\",replace(生产记录,\'\"\',\'“\') \"WorkInfo\",MID FROM v_cbpc_cartlist a WHERE a.车号 = ? ORDER BY 12', 'cart', '', '2019-03-11 17:39:30', '2019-03-15 17:06:06', '1');
INSERT INTO `sys_api` VALUES ('332', '00000000016', '1', '机台作业信息冠字模糊匹配', '5c91838515', 'SELECT 车号 CartNumber,冠号 CarNumber,字号 GzNumber,工艺 TechTypeName,工序 ProcName,班次 WorkClassName,机台 MachineName,机长 CaptainName,班组 TeamName,班长 MonitorName,产量 PrintNum,CONVERT (VARCHAR,开始时间,120) StartDate,品种 ProductName,( CASE WHEN 生产记录 IS NULL THEN \'\' ELSE replace(生产记录,\'\"\',\'“\') END ) WorkInfo,MID FROM v_cbpc_cartlist a WHERE a.品种 =? AND ( ( 冠号 = ? AND 字号 BETWEEN ? AND ? ) OR ( 冠号 = ? AND 字号 BETWEEN ? AND ? ) ) ORDER BY 12', 'prod,alpha,start,end,alpha2,start2,end2', '', '2019-03-11 17:39:30', '2019-03-14 15:24:14', '1');
INSERT INTO `sys_api` VALUES ('333', '00000000016', '1', '指定车号作业记录查询', 'de704deffb', 'SELECT distinct a.机长 captain,a.生产记录 comment_text FROM v_cbpc_cartlist a INNER JOIN ( SELECT  plan_id FROM  v_cbpc_cartlist b WHERE  b.车号 = ? AND b.plan_id > 0 ) b ON a.plan_id = b.plan_id and len(a.生产记录)>0', 'cart', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('334', '00000000016', '1', '查询批次状态_MES', 'f47b05f146', 'SELECT v_Storage.StorageDesc AS 库房,replace(udt_tb_WipInventory.ProdTypeDesc,\'品\',\'\') AS 品种,udt_tb_WipInventory.CarNo AS 车号,v_process_path.ShortCode 工序,udt_tb_WipInventory.Total 数量,case when udt_tb_WipInventory.IsLock = 1 then \'锁定\' else \'未锁定\' end 锁车状态,Event_Reasons.Event_Reason_Code 锁车原因,udt_tb_WipInventory.ProcessLine_Desc 工艺 FROM udt_tb_WipInventory INNER JOIN Products on udt_tb_WipInventory.ProdTypeId=Products.Prod_Id inner join Engineering_Unit on udt_tb_WipInventory.Unit=Engineering_Unit.Eng_Unit_Id LEFT JOIN udt_pp_LockCar ON udt_tb_WipInventory.CarNo = udt_pp_LockCar.CarNumber AND udt_pp_LockCar.Event_Status = \'2002\' LEFT JOIN Event_Reasons ON udt_pp_LockCar.Reason = Event_Reasons.Event_Reason_Id INNER JOIN v_Storage ON udt_tb_WipInventory.CurrentUnit_Id = v_Storage.StorageId INNER JOIN v_process_path ON udt_tb_WipInventory.Path_Code = v_process_path.Path_Code WHERE (v_Storage.StorageTypeCode IN (\'ZZPK\',\'BZJGK\',\'ZZPLTK\')) AND (udt_tb_WipInventory.CarNo IN (?))', 'carnos', '', '2019-03-11 17:39:30', '2019-03-13 10:11:06', '1');
INSERT INTO `sys_api` VALUES ('335', '00000000016', '1', '人工拉号准许出库查询_MES', 'ec15e7e3e2', 'SELECT udt_tb_WipInventory.CarNo 车号,v_process_path.Path_Desc 工序,v_process_path.ShortCode 工序编码,DATEADD(HOUR,ISNULL(cast(v_Central_Current_Spec.Target as NUMERIC),0),udt_tb_WipInventory.FinishTime) 准许拉号时间,case when DATEDIFF(SECOND,DATEADD(HOUR,ISNULL(cast(v_Central_Current_Spec.Target as NUMERIC),0),udt_tb_WipInventory.FinishTime),GETDATE())>=0 THEN 1 ELSE 0 END 准许 FROM udt_tb_WipInventory INNER JOIN v_process_path ON udt_tb_WipInventory.Path_Code = v_process_path.Path_Code LEFT JOIN v_Central_Current_Spec ON v_Central_Current_Spec.Tag=\\\'SPV_CountCycle\\\' and udt_tb_WipInventory.ProdTypeId=v_Central_Current_Spec.Prod_Id WHERE udt_tb_WipInventory.CarNo IN ( SELECT  VALUE  FROM  fnGUI_SplitStr (?,\\\',\\\') )', 'carnos', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('336', '00000000016', '1', '在库锁车产品列表_MES', '76c49e3145', 'SELECT wip.CurrentUnit_Desc 库房,replace(wip.ProdTypeDesc,\'品\',\'\') 品种,wip.CarNo 车号,wip.Path_Desc 工序,process.ShortCode 工序编码,wip.Total 数量,u.Eng_Unit_Desc 单位,r.Event_Reason_Name 锁车原因描述,r.Event_Reason_Code 锁车原因 FROM udt_pp_LockCar l INNER JOIN udt_tb_WipInventory wip on l.CarNumber=wip.CarNo INNER JOIN v_process_path process on wip.Path_Code=process.Path_Code INNER JOIN Engineering_Unit u ON wip.Unit = u.Eng_Unit_Id LEFT JOIN Event_Reasons r ON l.Reason = r.Event_Reason_Id WHERE wip.UserDefine2 = \'ZZP\' AND l.Event_Status IN (\'2002\')', '', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('337', '00000000016', '1', '在库产品锁车列表_MES', '8762d07182', 'SELECT wip.CarNo carno,wip.StartCWNo SN,replace(wip.ProdTypeDesc,\\\'品\\\',\\\'\\\') prodName,wip.Total quantity,u.Eng_Unit_Desc unit,process.ShortCode pscode,wip.Path_Desc psname,l.LockTime lockedAt,CONVERT(VARCHAR,l.LockTime,20) lockedAtStr,r.Event_Reason_Code lockReason,r.Event_Reason_Name lockReasonStr,case when wip.ProcessLine_Id=27 then \\\'码后核查\\\' when wip.ProcessLine_Id=28 then \\\'全检品\\\' else \\\'不分工艺\\\' end tech,wip.CurrentUnit_Id orgid,wip.CurrentUnit_Desc orgName FROM udt_pp_LockCar l INNER JOIN udt_tb_WipInventory wip on l.CarNumber=wip.CarNo INNER JOIN v_process_path process on wip.Path_Code=process.Path_Code INNER JOIN Engineering_Unit u ON wip.Unit = u.Eng_Unit_Id LEFT JOIN Event_Reasons r ON l.Reason = r.Event_Reason_Id WHERE wip.UserDefine2 = \\\'ZZP\\\' AND l.Event_Status IN (\\\'2002\\\')', '', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('338', '00000000016', '1', 'MES 分库房、分产品月收付存台帐', '0a421fa2c2', 'with vars as (select ? as storage,? as product,concat(?,\'-01\') as startdate,eomonth(concat(?,\'-01\')) enddate) select t.ExcuteDate,t.Product_Desc,t.Storage_Desc,t.Location_Desc,sum(t.StartCValue) beginning,sum(t.EndValue) ending,sum(t.InValue) receipts,sum(t.OutValue) payments,(sum(t.StartCValue)+sum(t.InValue)-sum(t.OutValue)-sum(t.EndValue)) balance from udt_Report_Close_Account_All t inner join vars on t.Storage_Id = vars.storage and t.Product_Id = vars.product and t.ExcuteDate between vars.startdate and vars.enddate group by t.Storage_Desc,t.Location_Desc,t.Product_Desc,t.ExcuteDate order by t.Storage_Desc,t.Location_Desc,t.Product_Desc,t.ExcuteDate', 'storage,product,month1,month2', '', '2019-03-11 17:39:30', '2019-03-13 10:12:24', '1');
INSERT INTO `sys_api` VALUES ('339', '00000000016', '1', 'MES 库房清单', '05396e36d6', 'select s.StorageId,s.StorageDesc,s.StorageCode,s.StorageTypeId,s.StorageTypeDesc,s.StorageTypeCode from v_Storage s where s.StorageTypeCode in (\'BZJGK\',\'CPK\',\'DHK\',\'FPK\',\'HPK\',\'YZK\',\'ZZPLTK\',\'ZZPK\') and s.StorageDesc not like \'%终端%\' order by s.StorageTypeDesc,s.StorageDesc', '', '', '2019-03-11 17:39:30', '2019-03-13 10:12:08', '1');
INSERT INTO `sys_api` VALUES ('340', '00000000016', '1', 'MES 产品目录', '1eb8240396', 'SELECT p.Prod_Id,dbo.fnGUI_GetSplitString (p.Prod_Desc,\'.\',2) Prod_Desc,p.Prod_Code,CAST(u.slope as int) slope FROM Products p INNER JOIN v_Prod_Eng_Unit_Conversion u ON p.Prod_Id=u.Prod_Id WHERE Product_Family_Id IN (3212) and From_Eng_Unit_Id=51006 and To_Eng_Unit_Id=51082 ORDER BY dbo.fnGUI_GetSplitString (p.Prod_Desc,\'.\',2) DESC', '', '', '2019-03-11 17:39:30', '2019-04-02 10:36:01', '1');
INSERT INTO `sys_api` VALUES ('341', '00000000016', '1', '生产信息同步查询', '6ed5208ead', 'SELECT a.[工艺] techtypename,a.[车号] cartnumber,a.[冠号] carnumber,a.[字号] gznumber,a.[工序] procname,a.[班次] workclassname,a.[机台] machinename,a.[机长] captainname,a.[班组] teamname,a.[班长] monitorname,a.[产量] printnum,a.[开始时间] startdate,a.[完成时间] enddate,a.[品种] productname,a.[生产记录] workinfo FROM dbo.v_cbpc_cartlist AS a WHERE a.车号=?', 'cart', '', '2019-03-11 17:39:30', '2019-03-13 10:13:45', '1');
INSERT INTO `sys_api` VALUES ('342', '00000000016', '1', '指定车号中已完成抽查的产品', '8aa04d0a03', 'SELECT DISTINCT 车号 \"carts\" FROM v_cbpc_cartlist WHERE \"工序\" in (\\\'抽查\\\',\\\'裁封\\\') AND 车号 IN (?)', 'carts', '', '2019-03-11 17:39:30', '2019-03-14 15:27:07', '1');
INSERT INTO `sys_api` VALUES ('343', '00000000016', '1', '指定车号列表中全检品', '16231d052e', 'select distinct 车号 \"carts\" from v_cbpc_cartlist where \"工艺\"=\\\'全检品\\\' and 车号 IN (?)', 'carts', '', '2019-03-11 17:39:30', '2019-03-13 10:13:36', '1');
INSERT INTO `sys_api` VALUES ('344', '00000000016', '1', '图像判废每日待判车号列表(丝印印刷完毕判废)', 'a8ea958d2b', 'WITH CARTS AS ( SELECT  车号 FROM  v_cbpc_cartlist a WHERE  CONVERT (VARCHAR,a.完成时间,112) BETWEEN ? AND ? AND a.工序 IN (\'印码\',\'丝印\') AND a.机台 NOT LIKE \'人工大张班%\' AND a.机台 NOT LIKE \'M97%\' ),temp AS ( SELECT  A.品种 prod_name, A.车号 cart_number, MAX (  CASE A.工艺  WHEN \'码后核查\' THEN   2  WHEN \'全检品\' THEN   1  ELSE   0  END  ) proc_name, A.机台 machine_name FROM  v_cbpc_cartlist a WHERE  车号 IN (SELECT 车号 FROM CARTS) AND 工序 IN (\'印码\',\'丝印\') AND (  工艺 = \'不分工艺\'  OR (  工艺 = \'码后核查\'  AND 冠字 <> \'\'  )  OR 品种 = \'9606T\' ) GROUP BY  a.品种, a.车号, a.机台 HAVING  SUM (a.产量) = 10000 ) SELECT b.prod_name,b.cart_number,(  CASE b.proc_name  WHEN 2 THEN  \'码后核查\'  WHEN 1 THEN  \'全检品\'  ELSE  \'\'  END ) proc_name,b.machine_name FROM (  SELECT  cart_number, MAX (proc_name) proc_name  FROM  temp  GROUP BY  cart_number ) a INNER JOIN temp b ON a.cart_number = b.cart_number AND a.proc_name = b.proc_name', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-06-14 20:29:42', '1');
INSERT INTO `sys_api` VALUES ('345', '00000000016', '1', '图核指定品种每日待判车号列表(丝印印刷后判废)', 'b78e6ce4d7', 'WITH CARTS AS ( SELECT 车号 FROM v_cbpc_cartlist a WHERE CONVERT (VARCHAR,a.完成时间,112) BETWEEN ? AND ? AND a.品种 IN (?) AND a.工序 IN (\'印码\',\'丝印\') AND a.机台 NOT LIKE \'人工大张班%\' AND a.机台 NOT LIKE \'M97%\' ),temp AS ( SELECT A.品种 prod_name,A.车号 cart_number,MAX ( CASE A.工艺 WHEN \'码后核查\' THEN  2 WHEN \'全检品\' THEN  1 ELSE  0 END ) proc_name,A.机台 machine_name FROM v_cbpc_cartlist a WHERE 车号 IN (SELECT 车号 FROM CARTS) AND 工序 IN (\'印码\',\'丝印\') AND ( 工艺 = \'不分工艺\' OR ( 工艺 = \'码后核查\' AND 冠字 <> \'\' ) OR 品种 = \'9606T\' ) GROUP BY a.品种,a.车号,a.机台 HAVING SUM (a.产量) >= 10000 ) SELECT b.prod_name,b.cart_number,( CASE b.proc_name WHEN 2 THEN \'码后核查\' WHEN 1 THEN \'全检品\' ELSE \'\' END ) proc_name,b.machine_name FROM ( SELECT cart_number,MAX (proc_name) proc_name FROM temp GROUP BY cart_number ) a INNER JOIN temp b ON a.cart_number = b.cart_number AND a.proc_name = b.proc_name', 'tstart,tend,prod', '', '2019-03-11 17:39:30', '2019-08-02 14:01:31', '1');
INSERT INTO `sys_api` VALUES ('346', '00000000016', '1', '车号最近生产工序', 'd46d77fb86', 'SELECT 车号 cart_number,工序 last_proc,机台 machine_name,convert(varchar, 开始时间, 120 ) rec_time FROM v_cbpc_cartlist WHERE key_recid IN (  SELECT  MAX (key_recid) key_recid  FROM  v_cbpc_cartlist t  WHERE  车号 IN (?)  GROUP BY  车号 ) AND 车号 IN (?)', 'cart1,cart2', '', '2019-03-11 17:39:30', '2019-03-13 10:10:19', '1');
INSERT INTO `sys_api` VALUES ('347', '00000000016', '1', '车号查冠字', 'd0fdd5b3d1', 'select distinct 车号 cart_number,冠号+字号 gz_num from v_cbpc_cartlist t where t.车号 in (?)', 'carnos', '', '2019-03-11 17:39:30', '2019-03-13 18:52:03', '1');
INSERT INTO `sys_api` VALUES ('348', '00000000016', '1', '产品抽检车号原始记录', '1a2c75e162', 'SELECT a.车号,a.冠号,a.字号,a.工序,a.班次,a.机台,a.机长,CONVERT (  VARCHAR (10), a.开始时间, 120 ) 生产日期,RIGHT (  CONVERT (VARCHAR,a.开始时间,120), 8 ) 开始时间,\\\'星期\\\' + (  CASE  WHEN DATEPART(weekday,a.开始时间) = 1 THEN  \\\'一\\\'  WHEN DATEPART(weekday,a.开始时间) = 2 THEN  \\\'二\\\'  WHEN DATEPART(weekday,a.开始时间) = 3 THEN  \\\'三\\\'  WHEN DATEPART(weekday,a.开始时间) = 4 THEN  \\\'四\\\'  WHEN DATEPART(weekday,a.开始时间) = 5 THEN  \\\'五\\\'  WHEN DATEPART(weekday,a.开始时间) = 6 THEN  \\\'六\\\'  ELSE  \\\'七\\\'  END ) 星期,DATEPART(weekday,a.开始时间) dayIdx,a.品种 FROM v_cbpc_cartlist a WHERE LEFT (a.工序,1) IN (\\\'胶\\\',\\\'凹\\\',\\\'印\\\',\\\'丝\\\',\\\'涂\\\') AND a.车号 IN ( SELECT  a.车号 FROM  v_cbpc_cartlist a WHERE  CONVERT (VARCHAR,a.开始时间,120) BETWEEN ?  AND ? AND a.工艺 = \\\'码后核查\\\' AND a.工序 = \\\'印码\\\' ) AND ( a.工序 <> \\\'印码\\\' OR (  a.工序 = \\\'印码\\\'  AND CONVERT (VARCHAR,a.开始时间,120) BETWEEN ?  AND ? ) ) order by 4,6,11,9', 'tstart,tend,tstart2,tend2', '', '2019-03-11 17:39:30', '2019-03-13 10:10:34', '1');
INSERT INTO `sys_api` VALUES ('349', '00000000016', '1', '指定车号列表生产原始信息', '1d1b6023fb', 'SELECT a.车号,a.冠号,a.字号,a.工序,a.班次,a.机台,a.机长,CONVERT (  VARCHAR (10), a.开始时间, 120 ) 生产日期,RIGHT (  CONVERT (VARCHAR,a.开始时间,120), 8 ) 开始时间,\\\'星期\\\' + (  CASE  WHEN DATEPART(weekday,a.开始时间) = 1 THEN  \\\'一\\\'  WHEN DATEPART(weekday,a.开始时间) = 2 THEN  \\\'二\\\'  WHEN DATEPART(weekday,a.开始时间) = 3 THEN  \\\'三\\\'  WHEN DATEPART(weekday,a.开始时间) = 4 THEN  \\\'四\\\'  WHEN DATEPART(weekday,a.开始时间) = 5 THEN  \\\'五\\\'  WHEN DATEPART(weekday,a.开始时间) = 6 THEN  \\\'六\\\'  ELSE  \\\'七\\\'  END ) 星期,DATEPART(weekday,a.开始时间) dayIdx,a.品种 FROM v_cbpc_cartlist a WHERE LEFT (a.工序,1) IN (\\\'胶\\\',\\\'凹\\\',\\\'印\\\',\\\'丝\\\',\\\'涂\\\') AND a.车号 IN (?) ORDER BY 4,6,11,9', 'carts', '', '2019-03-11 17:39:30', '2019-03-13 10:10:36', '1');
INSERT INTO `sys_api` VALUES ('350', '00000000016', '1', '根据车号查询生产信息', 'e20e9bbe6e', 'SELECT DISTINCT 工序 proc_name,机台 machine_name,机长 captain_name,convert(varchar,开始时间,112) start_time FROM v_cbpc_cartlist t WHERE t.车号 =? ORDER BY 4 DESC', 'cart', '', '2019-03-11 17:39:30', '2019-03-21 08:55:39', '1');
INSERT INTO `sys_api` VALUES ('351', '00000000016', '1', '车号信息查询', '982001ccc7', 'SELECT 车号 cartNumber,冠号 carNumber,字号 gzNumber,工艺 techTypeName,工序 procName,班次 workClassName,机台 machineName,机长 captainName,班组 teamName,班长 monitorName,产量 printNum,convert (varchar, 开始时间, 120 ) startDate,品种 productName FROM v_cbpc_cartlist a WHERE 车号 = ? ORDER BY 开始时间', 'cart', '', '2019-03-11 17:39:30', '2019-03-12 17:34:33', '0');
INSERT INTO `sys_api` VALUES ('352', '00000000016', '1', '裁封自动线最近10天机台品种列表', 'e0653f0146', 'SELECT t.MID machine_id,T.机台 machine_name,T.品种 prod_name,MAX (  convert (varchar,完成时间,112) ) last_produce_date FROM v_cbpc_cartlist T WHERE 完成时间 IS NOT NULL AND 工序 = \\\'裁封\\\' AND datediff(day,完成时间,GETDATE())<=10 GROUP BY t.MID,T.品种,T.机台 ORDER BY 1,2,3', '', '', '2019-03-11 17:39:30', '2019-03-13 10:12:35', '1');
INSERT INTO `sys_api` VALUES ('353', '00000000016', '1', '冠字查车号', '6a7cbf14d5', 'SELECT 车号 cartNumber,冠号 carNumber,字号 gzNumber,工艺 techTypeName,工序 procName,班次 workClassName,机台 machineName,机长 captainName,班组 teamName,班长 monitorName,产量 printNum,convert (varchar, 开始时间, 120 ) startDate,品种 productName FROM v_cbpc_cartlist A WHERE 品种 = ? AND ( (  冠号 = ?  AND 字号 BETWEEN ?  AND ? ) OR (  冠号 = ?  AND 字号 BETWEEN ?  AND ? ) ) ORDER BY 开始时间', 'prod,alpha,start,end,alpha2,start2,end2', '', '2019-03-11 17:39:30', '2019-03-13 10:12:11', '1');
INSERT INTO `sys_api` VALUES ('354', '00000000014', '1', '机检弱项录入_车号查询', '2b31102d60', 'SELECT 车号 \"cartNumber\",冠号 carNumber,字号 gzNumber,工艺 techTypeName,工序 \"procName\",班次 workClassName,机台 \"machineName\",机长 \"captainName\",班组 teamName,班长 monitorName,产量 printNum,to_char(开始时间,\\\'YYYY-MM-DD hh24:mi:ss\\\') \"startDate\",品种 productName FROM CDYC_USER.VIEW_CARTFINDER A WHERE 车号=? ORDER BY 开始时间', 'cart', '', '2019-03-11 17:39:30', '2019-03-13 10:12:12', '1');
INSERT INTO `sys_api` VALUES ('355', '00000000016', '1', 'MES_图像判废每日待判车号列表', '7721da8f39', 'WITH carts AS ( SELECT A.品种,A.车号,A.工艺,A.机台,A.工序 FROM v_cbpc_cartlist A WHERE convert (varchar,A.完成时间,112) BETWEEN ? AND ? AND A.工序 = \'印码\' ) SELECT DISTINCT A.品种 \"prod_name\",A.车号 \"cart_number\",A.工艺 \"proc_name\",A.机台 \"machine_name\" FROM carts A INNER JOIN v_cbpc_cartlist b ON A.车号 = b.车号 AND A.工序 = b.工序 GROUP BY A.品种,A.车号,A.工艺,A.机台 HAVING SUM (B.产量) = 10000', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('356', '00000000004', '1', '与我有关的工作', '751db37ab1', 'SELECT top 5 a.id,(case when a.状态=\\\'未关闭\\\' then 0 else 1 end) status,(case when 工序=\\\'其它\\\' then \\\'\\\' else \\\'【\\\'+工序+\\\'】\\\' end)+a.标题 title,发起人 as \\\'user\\\',记录时间 as datetime,set_avatar avatar,avatarkey,阅读数 readnum,已阅人员 readers FROM view_article a where 处理人员 like ? and sys_id=? order by 记录时间 desc', 'user,sys_id', '', '2019-03-11 17:39:30', '2019-03-13 10:17:40', '1');
INSERT INTO `sys_api` VALUES ('357', '00000000004', '1', '与我相关的工作列表分页', '4ad6aa3afb', 'SELECT top 20 a.id,a.状态 status,(case when 工序=\\\'其它\\\' then \\\'\\\' else \\\'【\\\'+工序+\\\'】\\\' end)+a.标题 title,发起人 as \\\'user\\\',记录时间 as datetime,set_avatar avatar,avatarkey,评论数 commentnum FROM view_article a where 处理人员 like ? and a.id< ? and convert(varchar(4),记录时间,120) >\\\'2017\\\' and sys_id=? order by 记录时间 desc', 'user,aid,sys_id', '', '2019-03-11 17:39:30', '2019-03-13 10:17:48', '1');
INSERT INTO `sys_api` VALUES ('358', '00000000002', '1', '单开分析仪车号同步列表', 'cbe3358deb', 'SELECT DATE,ID AS \"NoteAnayID\",LEFT (GZNum,6) AS code,rtrim(ProductType) AS prod,(  CASE  WHEN SUBSTRING (gznum,7,1) BETWEEN 0  AND 4 THEN  \'0-4\'  ELSE  \'5-9\'  END ) kilo FROM NoteAysData WHERE bCartInfoSync <> 1 AND GZNum <> \'0\' AND GZNum <> \' \' AND (ProductType <> \'\') AND (ProductType <> \'0\') AND DATE / 100 > 201900 ORDER BY DATE DESC', '', '', '2019-03-11 17:39:30', '2019-03-13 10:13:34', '1');
INSERT INTO `sys_api` VALUES ('359', '00000000016', '1', '单开仪_冠号查车号', 'dc3beb8ad3', 'SELECT a.[工艺] \"TechTypeName\",a.[车号] \"CartNumber\",a.[冠号] \"CarNumber\",a.[字号] \"GzNumber\",a.[工序] \"ProcName\",a.[班次] \"WorkClassName\",a.[机台] \"MachineName\",a.[机长] \"CaptainName\",a.[班组] \"TeamName\",a.[班长] \"MonitorName\",a.[产量] \"PrintNum\",a.[开始时间] \"StartDate\",a.[完成时间] \"EndDate\",a.[品种] \"ProductName\",\'\' \"cutOperatorName\" FROM dbo.v_cbpc_cartlist a WHERE a.车号 IN ( SELECT TOP 1 a.[车号] cart FROM dbo.v_cbpc_cartlist a WHERE a.品种 = ? AND ( (  a.字号 BETWEEN ?  AND ?  AND a.冠号 = ? ) OR (  a.字号 BETWEEN ?  AND ?  AND a.冠号 = ? ) ) ) AND a.产量 > 0 ORDER BY a.开始时间', 'prod,start,end,alpha,start2,end2,alpha2', '', '2019-03-11 17:39:30', '2019-07-11 13:23:47', '1');
INSERT INTO `sys_api` VALUES ('360', '00000000016', '1', '单开仪_2A3A快速查车号', '62b90c9429', 'SELECT a.[工艺] \"TechTypeName\",a.[车号] \"CartNumber\",a.[冠号] \"CarNumber\",a.[字号] \"GzNumber\",a.[工序] \"ProcName\",a.[班次] \"WorkClassName\",a.[机台] \"MachineName\",a.[机长] \"CaptainName\",a.[班组] \"TeamName\",a.[班长] \"MonitorName\",a.[产量] \"PrintNum\",a.[开始时间] \"StartDate\",a.[完成时间] \"EndDate\",a.[品种] \"ProductName\",\'\' \"cutOperatorName\" FROM dbo.v_cbpc_cartlist a WHERE a.车号 IN (  SELECT  TOP 1 车号  FROM  v_cbpc_cartlist a  WHERE  a.品种 = ?  AND a.字号 = ?  AND a.冠号 =?  ORDER BY  a.冠字 DESC ) AND a.产量 > 0 ORDER BY a.开始时间', 'prod,code,alpha', '', '2019-03-11 17:39:30', '2019-05-31 12:18:50', '1');
INSERT INTO `sys_api` VALUES ('361', '00000000014', '1', '单开仪_车号查生产记录', '7385a4281a', 'SELECT i.technology_type_name AS \"TechTypeName\",b.car_no AS \"CartNumber\",b.gz_no AS \"CarNumber\",b.dw_no AS \"GzNumber\",c.proc_name AS \"ProcName\",G .work_class_name AS \"WorkClassName\",f.machine_no AS \"MachineName\",D .user_name AS \"CaptainName\",team_name AS \"TeamName\",H .user_name AS \"MonitorName\",prod_num AS \"PrintNum\",TO_CHAR ( prod_dt,\'YYYY-MM-DD hh24:mi\' ) AS \"StartDate\",TO_CHAR ( M .end_date,\'YYYY-MM-DD hh24:mi\' ) AS \"EndDate\",E .product_name AS \"ProductName\",NVL (j.垛纸,\' \') \"cutOperatorName\" FROM tbJt_Produce_Detail A INNER JOIN tbJt_Produce_Info b ON A .Car_Id = b.Car_Id INNER JOIN tbJt_Day_Rec_Main M ON A .key_recid = M .key_recid INNER JOIN tbset_proc_main c ON A .proc_main_id = c.proc_main_id INNER JOIN tbbase_user_info D ON A .machine_user_id = D .user_id INNER JOIN tbbase_product E ON E .product_id = b.product_id INNER JOIN tbbase_machine_info f ON M .machine_id = f.machine_id INNER JOIN tbbase_work_class G ON M .work_class_id = G .work_class_id INNER JOIN tbbase_user_info H ON M .work_user_id = H .user_id LEFT JOIN tbbase_technology_type i ON b.technology_type_id = i.technology_type_id LEFT JOIN VIEW_CBPC_CUT_RECORD j ON j.冠字 = (b.gz_NO || b.dw_NO) AND j.品种 = E .product_name AND j.千位 =? WHERE b.car_no=? ORDER BY prod_dt', 'kilo,cart', '', '2019-03-11 17:39:30', '2019-05-31 12:36:15', '1');
INSERT INTO `sys_api` VALUES ('362', '00000000014', '1', '单开仪_冠号查生产记录', 'f008e16b48', 'SELECT i.technology_type_name AS \"TechTypeName\",b.car_no AS \"CartNumber\",b.gz_no AS \"CarNumber\",b.dw_no AS \"GzNumber\",c.proc_name AS \"ProcName\",G .work_class_name AS \"WorkClassName\",f.machine_no AS \"MachineName\",D .user_name AS \"CaptainName\",team_name AS \"TeamName\",H .user_name AS \"MonitorName\",prod_num AS \"PrintNum\",TO_CHAR ( prod_dt,\'YYYY-MM-DD hh24:mi\' ) AS \"StartDate\",TO_CHAR ( M .end_date,\'YYYY-MM-DD hh24:mi\' ) AS \"EndDate\",E .product_name AS \"ProductName\",NVL (j.垛纸,\' \') \"cutOperatorName\" FROM tbJt_Produce_Detail A INNER JOIN tbJt_Produce_Info b ON A .Car_Id = b.Car_Id INNER JOIN tbJt_Day_Rec_Main M ON A .key_recid = M .key_recid INNER JOIN tbset_proc_main c ON A .proc_main_id = c.proc_main_id INNER JOIN tbbase_user_info D ON A .machine_user_id = D .user_id INNER JOIN tbbase_product E ON E .product_id = b.product_id INNER JOIN tbbase_machine_info f ON M .machine_id = f.machine_id INNER JOIN tbbase_work_class G ON M .work_class_id = G .work_class_id INNER JOIN tbbase_user_info H ON M .work_user_id = H .user_id LEFT JOIN tbbase_technology_type i ON b.technology_type_id = i.technology_type_id LEFT JOIN VIEW_CBPC_CUT_RECORD j ON j.冠字 = (b.gz_NO || b.dw_NO) AND j.品种 = E .product_name AND j.千位 = ? WHERE e.product_name=? and ((b.gz_no=? and b.dw_no BETWEEN ? and ?) or (b.gz_no=? and b.dw_no BETWEEN ? and ?)) ORDER BY prod_dt', 'kilo,prod,alpha,start,end,alpha2,start2,end2', '', '2019-03-11 17:39:30', '2019-03-22 16:24:03', '1');
INSERT INTO `sys_api` VALUES ('363', '00000000002', '1', '单开仪_同步生产信息', 'c94c80c446', 'insert into cartinfodata(NoteAnayID,TechTypeName,CartNumber,CarNumber,GzNumber,ProcName,WorkClassName,MachineName,CaptainName,TeamName,MonitorName,PrintNum,StartDate,EndDate,ProductName,cutOperatorName ) values ?', 'values', '@desc:批量插入数据时，约定使用二维数组values参数，格式为[{noteanayid,techtypename,cartnumber,carnumber,gznumber,procname,workclassname,machinename,captainname,teamname,monitorname,printnum,startdate,enddate,productname,cutoperatorname }]，数组的每一项表示一条数据', '2019-03-11 17:39:30', '2019-03-13 15:42:05', '1');
INSERT INTO `sys_api` VALUES ('364', '00000000002', '1', '单开仪_更新车号同步状态', '2f106006f5', 'Update NoteAysData Set bCartInfoSync = 1,CartNumber =? WHERE id=?', 'cart,note_id', '', '2019-03-11 17:39:30', '2019-03-13 15:42:05', '1');
INSERT INTO `sys_api` VALUES ('365', '00000000016', '1', '图核排产_人员列表', '2f288db095', 'SELECT USERNAME user_name,code user_no,1 work_long_time FROM user_all a where DEPARTMENT=\\\'印码制作部\\\' and class=\\\'图像核查班\\\'', '', '', '2019-03-11 17:39:30', '2019-03-13 10:11:01', '1');
INSERT INTO `sys_api` VALUES ('366', '00000000002', '1', '记录核查任务信息', 'f34a198b23', 'insert into print_hechatask(task_info,rec_time ) values (?,?)', 'task_info,rec_time', '', '2019-03-11 17:39:30', '2019-03-14 08:11:43', '1');
INSERT INTO `sys_api` VALUES ('367', '00000000002', '1', '读取最近排产任务', 'ffd6916add', 'SELECT top 1 a.task_info,convert(varchar,a.rec_time,120) rec_time FROM dbo.print_hechatask AS a order by id desc', '', '', '2019-03-11 17:39:30', '2019-03-13 10:11:01', '1');
INSERT INTO `sys_api` VALUES ('368', '00000000016', '1', 'MES 工序目录', '933a099a7a', 'select dept_id,dept_desc,proc_path_id,proc_path_desc from v_Dept_Process', '', '', '2019-03-11 17:39:30', '2019-03-12 14:58:30', '0');
INSERT INTO `sys_api` VALUES ('369', '00000000016', '1', '质量平台_物资更换记录', '46711c29b7', 'SELECT DISTINCT 工序,CONVERT (  VARCHAR (10), 开始时间, 120 ) 生产日期,(case min( case when 班次=\'中班\' then 1 else 0 end) when 1 then \'中班\' else \'白班\' end) 班次,机台,机长,品种,[生产记录] FROM v_cbpc_cartlist WHERE CONVERT (VARCHAR,开始时间,112) = (  SELECT  MAX (   CONVERT (VARCHAR,开始时间,112)  )  FROM  v_cbpc_cartlist  WHERE  开始时间 <? ) AND replace( replace(  replace(  replace(   生产记录,  \'换压印\',  \'\'  ), \'换辊子\', \'\'  ), \'换棍子\', \'\' ),\'换擦\',\'\' ) LIKE (\'%换%\') group by 工序,CONVERT (  VARCHAR (10), 开始时间, 120 ) , 机台,机长,品种,[生产记录] ORDER BY 1,3,4,5,6', 'tstart', '', '2019-03-11 17:39:30', '2019-06-13 08:10:24', '1');
INSERT INTO `sys_api` VALUES ('370', '00000000004', '1', '消息机器人是否已推送换修记录', 'b210f0b4cd', 'SELECT id FROM tbl_article where convert(varchar,rec_time,112)=convert(varchar,getdate(),112) and uid=248 and title like \'%维修记录%\'', '', '', '2019-03-11 17:39:30', '2019-03-14 05:54:02', '1');
INSERT INTO `sys_api` VALUES ('371', '00000000016', '1', '质量平台_设备维修记录', 'aaa388f8fd', 'SELECT DISTINCT 工序, (case min( case when 班次=\'中班\' then 1 else 0 end) when 1 then \'中班\' else \'白班\' end) 班次,机台,机长,品种,CONVERT (VARCHAR,开始时间,112) 生产日期,[生产记录] FROM v_cbpc_cartlist WHERE CONVERT (VARCHAR,开始时间,112) = (  SELECT  MAX (   CONVERT (VARCHAR,开始时间,112)  )  FROM  v_cbpc_cartlist  WHERE  CONVERT (VARCHAR,开始时间,112) <= (   SELECT   MAX (    CONVERT (VARCHAR,开始时间,112)   )   FROM   v_cbpc_cartlist   WHERE   开始时间 <?   ) ) AND ( 生产记录 LIKE (\'%电工%\') OR 生产记录 LIKE (\'%钳工%\') OR 生产记录 LIKE (\'%修%\') ) group by 工序, CONVERT (VARCHAR,开始时间,112) , 机台,机长,品种,[生产记录] ORDER BY 1,2,3', 'tstart', '', '2019-03-11 17:39:30', '2019-06-13 08:12:17', '1');
INSERT INTO `sys_api` VALUES ('372', '00000000004', '1', '更新自动推送消息阅读状态', 'ee25f02ee2', 'update tbl_article set status=1 where status=0 and uid=248 and title like \'%维修记录%\'', '', '', '2019-03-11 17:39:30', '2019-03-14 05:54:02', '1');
INSERT INTO `sys_api` VALUES ('373', '00000000016', '1', '图核排产_全检品产品列表', 'c990d890b4', 'SELECT a.品种,a.车号,a.工艺,a.冠字,a.机台,SUM (CAST(a.产量 AS INT)) 产量,完成时间 FROM v_cbpc_cartlist a WHERE 车号 IN ( SELECT 车号 FROM v_cbpc_cartlist a WHERE 工序 IN (\'印码\',\'丝印\') AND CONVERT (VARCHAR,a.完成时间,112) BETWEEN ? AND ? ) AND 工序 IN (\'印码\',\'丝印\') and 工艺 = \'全检品\' and 冠字 is not null GROUP BY a.品种,a.车号,a.工艺,a.冠字,a.机台,完成时间 HAVING SUM (CAST(a.产量 AS INT)) > 5000 AND CONVERT (VARCHAR,a.完成时间,112) BETWEEN ? AND ? ORDER BY 1,5,4', 'tstart,tend,tstart2,tend2', '', '2019-03-11 17:39:30', '2019-05-23 17:22:32', '1');
INSERT INTO `sys_api` VALUES ('374', '00000000016', '1', 'MES 总帐（按货位）', '3c607c566e', 'WITH vars AS ( SELECT ? AS product,concat (?,\'-01\') AS startdate,eomonth (concat(?,\'-01\')) AS enddate ) SELECT t.ExcuteDate,t.Product_Desc,proce.process Location_Desc,SUM (t.StartCValue) beginning,SUM (t.EndValue) ending,SUM (t.InValue) receipts,SUM (t.OutValue) payments,( SUM (t.StartCValue) + SUM (t.InValue) - SUM (t.OutValue) - SUM (t.EndValue) ) balance FROM udt_Report_Close_Account_All t LEFT JOIN udt_tb_wms_process proce ON t.Location_Id = proce.locationid INNER JOIN (select distinct LocationId,LocationDesc from v_Storage_Location_Prod loc where loc.PU_Code IN (\'HPK\',\'ZZPK\',\'ZZPLTK\',\'DHK\',\'FPK\',\'YZK\')) loc ON t.Location_Id = loc.LocationId INNER JOIN vars ON t.Product_Id = vars.product AND t.ExcuteDate BETWEEN vars.startdate AND vars.enddate WHERE proce.locationid IS NOT NULL AND t.Location_Desc <> \'NULL\' GROUP BY proce.process,t.Product_Desc,t.ExcuteDate ORDER BY proce.process,t.Product_Desc,t.ExcuteDate', 'product,month1,month2', '', '2019-03-11 17:39:30', '2019-04-02 21:02:42', '1');
INSERT INTO `sys_api` VALUES ('375', '00000000016', '1', '质量推送_中途换压印记录', 'e08968b889', 'SELECT DISTINCT 工序,CONVERT (  VARCHAR (10), 开始时间, 120 ) 生产日期,(case min( case when 班次=\'中班\' then 1 else 0 end) when 1 then \'中班\' else \'白班\' end) 班次,机台,机长,品种,[生产记录] FROM v_cbpc_cartlist WHERE CONVERT (VARCHAR,开始时间,112) = (  SELECT  MAX (   CONVERT (VARCHAR,开始时间,112)  )  FROM  v_cbpc_cartlist  WHERE  开始时间 <? ) AND 生产记录 LIKE \'%中途%压印%\' group by 机台,工序,CONVERT (  VARCHAR (10), 开始时间, 120 ) ,机长,品种,[生产记录] ORDER BY 1,3,4', 'tstart', '', '2019-03-11 17:39:30', '2019-06-18 19:00:20', '1');
INSERT INTO `sys_api` VALUES ('376', '00000000016', '1', '当日产量情况', '3abfbd8652', 'WITH lastdate AS ( SELECT  MAX (  CONVERT (   VARCHAR,  开始时间,  112  )  ) as datename FROM  v_cbpc_cartlist WHERE  CONVERT (VARCHAR,开始时间,112) <= (  SELECT   MAX (   CONVERT (VARCHAR,开始时间,112)   )  FROM   v_cbpc_cartlist  WHERE   开始时间 < ?  ) ) SELECT a.*,b.总产量 月度总产量 FROM (  SELECT  replace(   replace(工序,\'一\',\'\'),  \'二\',  \'\'  ) 工序, 机台, CONVERT (VARCHAR,开始时间,112) 生产日期, COUNT (DISTINCT 班次) 当日台班数, CAST (SUM(产量) AS FLOAT) / 10000 日产量  FROM  v_cbpc_cartlist  WHERE  CONVERT (VARCHAR,开始时间,112) in (SELECT * FROM lastdate)  AND 产量 > 0  GROUP BY  replace(   replace(工序,\'一\',\'\'),  \'二\',  \'\'  ), 机台, CONVERT (VARCHAR,开始时间,112) ) a INNER JOIN ( SELECT  机台, CAST (SUM(产量) AS FLOAT) / 10000 总产量 FROM  v_cbpc_cartlist WHERE  CONVERT (  VARCHAR (6), 开始时间, 112  ) in (SELECT left(datename,6) FROM lastdate) AND 产量 > 0 GROUP BY  机台 ) b ON a.机台 = b.机台 ORDER BY 1,6 DESC,3', 'tstart', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('377', '00000000021', '1', '离线检测每日得分情况', '32ecb8e275', 'WITH lastdate AS ( SELECT  MAX (  CONVERT (VARCHAR,rec_time,112)  ) datename FROM  view_score_intaglio WHERE  CONVERT (VARCHAR,rec_time,112) <= (  SELECT   MAX (   CONVERT (VARCHAR,rec_time,112)   )  FROM   view_score_intaglio  WHERE   rec_time < ?  ) ) SELECT \\\'凹印\\\' 工序,machine_name 机台,round(AVG(jpicolor),2) 墨色平均,round(AVG(score),2) 总分平均,COUNT (DISTINCT cart_number) 大万数,count(*) 检测张数 FROM view_score_intaglio WHERE CONVERT (VARCHAR,rec_time,112) in(select * from lastdate) GROUP BY machine_name having count(*)>10 union  SELECT \\\'胶印\\\' 工序,machine_name 机台,round(AVG(jpicolor),2) 墨色平均,round(AVG(score),2) 总分平均,COUNT (DISTINCT cart_number) 大万数,count(*) 检测张数 FROM view_score_offset WHERE CONVERT (VARCHAR,rec_time,112) in(select * from lastdate) GROUP BY machine_name having count(*)>10', 'tstart', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('378', '00000000016', '1', '机台某段时间生产的车号列表', 'd87d44951c', 'SELECT 车号 FROM v_cbpc_cartlist a WHERE key_recid IN (  SELECT  min(key_recid) key_recid  FROM  v_cbpc_cartlist a  WHERE  a.机台 = ?  AND CONVERT (VARCHAR,开始时间,112) BETWEEN ?  AND ?  GROUP BY  车号  HAVING  SUM (产量) > 9000 ) ORDER BY 开始时间', 'machine_name,rec_date1,rec_date2', '', '2019-03-11 17:39:30', '2019-04-04 10:53:34', '1');
INSERT INTO `sys_api` VALUES ('379', '00000000016', '1', '某冠字号段车号列表', 'f2de4b5faf', 'SELECT DISTINCT 车号,a.字号 FROM v_cbpc_cartlist a WHERE key_recid IN (  SELECT  MIN (key_recid) key_recid  FROM  v_cbpc_cartlist a  WHERE  a.品种 = ?  AND a.冠号 = ?  AND a.字号 BETWEEN ?  AND ?  AND len(冠号) > 0  GROUP BY  车号  having SUM (产量) > 9000 )', 'prod_name,gz,start_no,end_no', '', '2019-03-11 17:39:30', '2019-04-04 11:11:47', '0');
INSERT INTO `sys_api` VALUES ('380', '00000000016', '1', '机台从某天起生产的指定万数产品列表', 'a84b055e1d', 'SELECT TOP ? 车号 FROM v_cbpc_cartlist a WHERE key_recid IN (  SELECT  min(key_recid) key_recid  FROM  v_cbpc_cartlist a  WHERE  a.机台 = ?  AND CONVERT (VARCHAR,开始时间,112) > ?  GROUP BY  车号  HAVING  SUM (产量) > 9000 ) ORDER BY 开始时间', 'max_carts,machine_name,rec_date', '', '2019-03-11 17:39:30', '2019-04-04 11:13:32', '1');
INSERT INTO `sys_api` VALUES ('381', '00000000002', '1', '异常品列表状态标记为完成', '1bde8d8f88', 'update print_wms_proclist set complete_status=1 where cart_number=? and task_id=?', 'cart_number,task_id', '', '2019-03-11 17:39:30', '2019-03-13 11:17:04', '1');
INSERT INTO `sys_api` VALUES ('382', '00000000002', '1', '清除单开仪重新同步的作业记录', '81eba8c03b', 'delete from CartInfoData where NoteAnayID in (select distinct NoteAnayID from CartInfoData where NoteAnayID>0 and NoteAnayID not in (select id from NoteAysData))', '', '', '2019-03-11 17:39:30', '2019-03-11 17:40:08', '0');
INSERT INTO `sys_api` VALUES ('383', '00000000003', '1', '图像判废产量原始记录', '7f95a2c2a7', 'select a.operator_name \"操作员\",cart_number 车号,to_char(start_date,\'yyyy-mm-dd hh24:mi:ss\') 开始时间,to_char(end_date,\'yyyy-mm-dd hh24:mi:ss\') 结束时间,check_num 抽查量,pf_num 判废量 from (SELECT D.operator_name,b.cart_number,a.start_date,a.end_date,0 check_num,prod_qty pf_num FROM qfm_wip_prod_logs A inner join dic_operators D on D.operator_id = A.operator_id inner join qfm_wip_jobs b on a.job_id = b.job_id WHERE TO_CHAR(a.start_date,\'YYYYMMDD\') between ? and ? and a.operation_id = 8 union all SELECT D.operator_name,b.cart_number,a.start_date,a.end_date,count(b.item_flag) check_num,0 pf_num FROM qfm_wip_prod_logs A inner join dic_operators D on D.operator_id = A.operator_id inner join qfm_qa_inspect_master c on a.job_id = c.job_id inner join qfm_qa_inspect_slave b on c.inspectm_id = b.inspectm_id inner join qfm_wip_jobs b on a.job_id = b.job_id WHERE TO_CHAR(a.start_date,\'YYYYMMDD\') between ? and ? and a.operation_id = 9 and b.item_flag <> 3 group by b.cart_number,a.start_date,a.end_date,D.operator_name union all SELECT D.operator_name,b.cart_number,a.start_date,a.end_date,0 check_num,prod_qty pf_num FROM wip_prod_logs A inner join dic_operators@XZHC_DBLINK D on D.operator_id = A.operator_id inner join wip_jobs b on a.job_id = b.job_id WHERE TO_CHAR(A.start_date,\'YYYYMMDD\') between ? and ? and a.operation_id = 8 union all SELECT D.operator_name,b.cart_number,a.start_date,a.end_date,count(b.item_flag) check_num,0 pf_num FROM wip_prod_logs A inner join dic_operators@XZHC_DBLINK D on D.operator_id = A.operator_id inner join qa_inspect_master c on a.job_id = c.job_id inner join qa_inspect_slave b on c.inspectm_id = b.inspectm_id inner join wip_jobs b on a.job_id = b.job_id WHERE TO_CHAR(A.start_date,\'YYYYMMDD\') between ? and ? and a.operation_id = 9 and b.item_flag <> 3 group by b.cart_number,a.start_date,a.end_date,D.operator_name) a order by 1,3', 'tstart,tend,tstart2,tend2,tstart3,tend3,tstart4,tend4', '', '2019-03-11 17:39:30', '2019-03-13 10:11:02', '1');
INSERT INTO `sys_api` VALUES ('384', '00000000003', '1', 'db_link列表', '97bc09709d', 'select * from dba_db_links', '', '', '2019-03-11 17:39:30', '2019-03-13 10:16:53', '1');
INSERT INTO `sys_api` VALUES ('385', '00000000007', '1', '号码判废量原始记录', '29fd5573a4', 'select a.operator_name \"操作员\", cart_number 车号, to_char(start_date,\'yyyy-mm-dd hh24:mi:ss\') 开始时间, to_char(end_date,\'yyyy-mm-dd hh24:mi:ss\') 结束时间, 0 抽查量,0 判废量,code_num 号码量 from (SELECT D.operator_name,   b.cart_number,   a.start_date,   a.end_date,   a.qawasternum code_num   FROM wip_prod_logs A   inner join dic_operators D    on D.operator_id = A.operator_id   inner join wip_jobs b    on a.job_id = b.job_id   WHERE TO_CHAR(A.end_date,\'YYYYMMDD\') between ? and    ?   and a.operation_id = 14   and b.item_flag <> 3) a order by 1,3', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-13 10:11:02', '1');
INSERT INTO `sys_api` VALUES ('386', '00000000007', '1', '号码判废量汇总', '666b98f1d1', 'select a.operator_name \"operator_name\",count(*) \"cart_nums\",sum(code_num) \"code_num\" from (SELECT D.operator_name,b.cart_number,a.start_date,a.end_date,a.qawasternum code_num FROM wip_prod_logs A inner join dic_operators D on D.operator_id = A.operator_id inner join wip_jobs b on a.job_id = b.job_id WHERE TO_CHAR(A.end_date,\'YYYYMMDD\') between ? and ? and a.operation_id = 14 and b.item_flag <> 3) a group by a.operator_name order by 3 desc', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-13 10:11:02', '1');
INSERT INTO `sys_api` VALUES ('387', '00000000016', '1', '质量推送_产量汇总', '57bd15d543', 'WITH cartinfo AS ( SELECT  班次, 品种, 产量, 工序 FROM  v_cbpc_cartlist WHERE  CONVERT (VARCHAR,开始时间,112) between ? and ?  AND 工序 <> \'抽查\' AND 产量 > 0 ) SELECT 班次,品种,SUM (胶印) 胶印,SUM (凹印) 凹印,SUM (丝印) 丝印,SUM (涂布) 涂布,SUM (印码) 印码,SUM (裁封) 裁封,SUM (裁切) 裁切 FROM (  SELECT  班次, 品种, CAST (SUM(产量) AS FLOAT) / 10000 AS 胶印, 0 凹印, 0 丝印, 0 涂布, 0 印码, 0 裁封, 0 裁切  FROM  cartinfo  WHERE  工序 LIKE \'胶%\'  GROUP BY  品种, 班次  UNION  SELECT   班次,  品种,  0 胶印,  CAST (SUM(产量) AS FLOAT) / 10000 AS 凹印,  0 丝印,  0 涂布,  0 印码,  0 裁封,  0 裁切  FROM   cartinfo  WHERE   工序 LIKE \'凹%\'  GROUP BY   品种,  班次  UNION   SELECT   班次,  品种,  0 胶印,  0 凹印,  CAST (SUM(产量) AS FLOAT) / 10000 AS 丝印,  0 涂布,  0 印码,  0 裁封,  0 裁切   FROM   cartinfo   WHERE   工序 LIKE \'丝%\'   GROUP BY   品种,  班次   UNION   SELECT    班次,   品种,   0 胶印,   0 凹印,   0 AS 丝印,   CAST (SUM(产量) AS FLOAT) / 10000 涂布,   0 印码,   0 裁封,   0 裁切   FROM    cartinfo   WHERE    工序 LIKE \'涂%\'   GROUP BY    品种,   班次   UNION    SELECT    班次,   品种,   0 胶印,   0 凹印,   0 AS 丝印,   0 涂布,   CAST (SUM(产量) AS FLOAT) / 10000 印码,   0 裁封,   0 裁切    FROM    cartinfo    WHERE    工序 LIKE \'印%\'    GROUP BY    品种,   班次    UNION    SELECT     班次,    品种,    0 胶印,    0 凹印,    0 AS 丝印,    0 涂布,    0 印码,    CAST (SUM(产量) AS FLOAT) 裁封,    0 裁切    FROM     cartinfo    WHERE     工序 LIKE \'裁封%\'    GROUP BY     品种,    班次    UNION     SELECT     班次,    品种,    0 胶印,    0 凹印,    0 AS 丝印,    0 涂布,    0 印码,    0 裁封,    CAST (SUM(产量) AS FLOAT) 裁切     FROM     cartinfo     WHERE     工序 LIKE \'裁切%\'     GROUP BY     品种,    班次 ) a GROUP BY 班次,品种 ORDER BY 2,1', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-30 14:39:26', '1');
INSERT INTO `sys_api` VALUES ('388', '00000000021', '1', '质量推送_过程质量控制水平', '45fc6ef43e', 'select * from (SELECT prod_name 品种,\'胶印\' 工序,round(AVG(jpicolor),2) 墨色,round(AVG(score),2) 平均总分 FROM [dbo].[view_score_offset] WHERE CONVERT (VARCHAR,rec_time,112) between ? and ? GROUP BY prod_name UNION SELECT prod_name 品种,\'凹印\' 工序,round(AVG(jpicolor),2) 墨色,round(AVG(score),2) 平均总分 FROM [dbo].[view_score_intaglio] WHERE CONVERT (VARCHAR,rec_time,112) between ? and ? GROUP BY prod_name ) a order by 2,1', 'tstart,tend,tstart2,tend2', '', '2019-03-11 17:39:30', '2019-03-30 14:39:26', '1');
INSERT INTO `sys_api` VALUES ('389', '00000000002', '1', '质量推送_图核判废开包量', 'ffa8c1781e', 'SELECT a.producttypename 品种,round(  AVG (CAST(a.opennum AS FLOAT)), 1 ) [票面开包量],round(  AVG (  CAST (a.[opennum_siyin] AS FLOAT)  ), 1 ) 丝印开包量,round(  AVG (  CAST (a.[opennum_code] AS FLOAT)  ), 1 ) 号码开包量,AVG (  CAST (  a.[black_img_code] + a.[black_img_print] + a.[black_img_siyin_check] + a.[black_img_siyin_machine] AS FLOAT  ) ) 黑图数,COUNT (*) 大万数 FROM ManualVerifyData a WHERE CONVERT (VARCHAR,VerifyTime,112) between ? and ? GROUP BY producttypename', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-30 14:39:26', '1');
INSERT INTO `sys_api` VALUES ('390', '00000000002', '1', '质量推送_OCR开包量', 'e1478d14d1', 'SELECT 品种,AVG (开包量) OCR开包量 FROM (  SELECT  (   CASE   WHEN SUBSTRING (a.cartNumber,3,1) = 8 THEN   \\\'9607T\\\'   ELSE   \\\'960\\\' + SUBSTRING (a.cartNumber,3,1) + \\\'A\\\'   END  ) 品种, a.totalOpenNum 开包量  FROM  dbo.OCRData AS a  WHERE  CONVERT (VARCHAR,a.scanDate,112) between ? and ?  AND a.totalPieceCount > 0  AND (  (   SUBSTRING (a.cartNumber,3,1) = 8   AND a.totalOpenNum >= 20  )  OR SUBSTRING (a.cartNumber,3,1) <> 8  ) ) a GROUP BY 品种;', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-30 14:39:26', '1');
INSERT INTO `sys_api` VALUES ('391', '00000000002', '1', '质量推送_各机台机检平均好品率', '1ef1f7c474', 'SELECT 机台,品种,round(AVG(好品率),2) 平均好品率,AVG(缺陷条数) 平均缺陷数,round(  AVG (CAST(未检条数 AS FLOAT)), 2 ) 平均未检 FROM view_print_hecha WHERE [生产日期] between ? and ? GROUP BY 机台,品种;', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-30 14:39:26', '1');
INSERT INTO `sys_api` VALUES ('392', '00000000002', '1', '质量推送_品种平均好品率', '2b97e128e2', 'SELECT 品种,round(AVG(好品率),2) 平均好品率,round( AVG (CAST(未检条数 AS FLOAT)),2 ) 平均未检 FROM view_print_hecha WHERE [生产日期] between ? and ? GROUP BY 品种;', 'tstart,tend', '', '2019-03-11 17:39:30', '2019-03-30 14:39:26', '1');
INSERT INTO `sys_api` VALUES ('393', '00000000002', '1', '质量推送_好品率', '5159ad865e', 'SELECT 品种,SUM (上一工作日) 上一工作日,SUM (本月) 本月 FROM ( SELECT 品种,round(AVG(好品率),2) AS 上一工作日,0 本月 FROM [dbo].[view_print_hecha] WHERE 生产日期 = ? GROUP BY 品种,生产日期 UNION ALL SELECT 品种,0 上一工作日,round(AVG(好品率),2) AS 本月 FROM [dbo].[view_print_hecha] WHERE 生产日期 / 100 = left(?,6) GROUP BY 品种,生产日期 / 100 ) a GROUP BY (品种)', 'tstart,tstart2', '', '2019-03-11 17:39:30', '2019-03-30 14:39:26', '1');
INSERT INTO `sys_api` VALUES ('394', '00000000002', '1', '质量推送_平均未检最多的机台', '65b192eaae', 'SELECT 机台,round( AVG (CAST(未检条数 AS FLOAT)),2 ) AS 平均未检数 FROM [dbo].[view_print_hecha] WHERE 生产日期 = ( SELECT TOP 1 producedate FROM MaHouData WHERE ProduceDate < (  SELECT  MAX (ProduceDate)  FROM  mahoudata ) ORDER BY ProduceDate DESC ) GROUP BY 机台 ORDER BY round( AVG (CAST(未检条数 AS FLOAT)),2 ) DESC', '', '', '2019-03-11 17:39:30', '2019-03-30 14:39:26', '1');
INSERT INTO `sys_api` VALUES ('395', '00000000002', '1', '质量推送_钞纸封包率', '678b35c2e6', 'SELECT a.品种,round( CAST ( SUM (a.[封包重量]) AS FLOAT ) * 100 / SUM (a.[裁切重量]),2 ) AS 封包率,round( CAST ( SUM ( CASE WHEN 是否放行 = \\\'返工\\\' THEN 1 ELSE 0 END ) AS FLOAT ) * 100 / COUNT (*),2 ) AS 返工率 FROM dbo.view_paper_validate AS a WHERE 是否放行 IN (\\\'放行\\\',\\\'返工\\\') AND ( a.[记录日期]/100 = convert(varchar,GETDATE(),112)/100 ) GROUP BY a.品种', '', '', '2019-03-11 17:39:30', '2019-03-30 14:39:26', '1');
INSERT INTO `sys_api` VALUES ('396', '00000000002', '1', '质量推送_钞纸过程质量控制水平', '431c2272ce', 'SELECT a.品种,ROUND( SUM ( CASE WHEN type = 0 THEN 得分 ELSE 0 END ),2 ) AS 物理指标,ROUND( SUM ( CASE WHEN type = 1 THEN 得分 ELSE 0 END ),2 ) AS 外观指标,ROUND( SUM ( CASE WHEN type = 2 THEN 得分 ELSE 0 END ),2 ) AS 非常规物理指标,round(100-((SUM ( CASE WHEN type = 0 THEN 100-得分 ELSE 0 END) +SUM ( CASE WHEN type = 1 THEN 100-得分 ELSE 0 END) +SUM ( CASE WHEN type = 2 THEN 100-得分 ELSE 0 END))),2) AS 总分 FROM ( SELECT a.[品种],AVG (a.[得分]) AS 得分,1 AS Type FROM dbo.view_paper_surface AS a WHERE REPLACE(a.记录日期,\'/\',\'\') BETWEEN ? AND ? GROUP BY a.[品种] UNION ALL SELECT a.[品种],AVG (a.[得分]) AS 得分,0 AS Type FROM dbo.view_paper_psc AS a WHERE REPLACE(a.检测日期,\'/\',\'\') BETWEEN ? AND ? GROUP BY a.[品种] UNION ALL SELECT a.[品种],AVG (a.[得分]) AS 得分,2 AS Type FROM dbo.view_paper_para_abnormal AS a WHERE REPLACE(a.日期,\'/\',\'\') BETWEEN ? AND ? and a.品种<>\'实验品\' GROUP BY a.[品种] ) a GROUP BY a.品种', 'tstart,tend,tstart2,tend2,tstart3,tend3', '', '2019-03-11 17:39:30', '2019-03-30 14:39:26', '1');
INSERT INTO `sys_api` VALUES ('397', '00000000002', '1', '质量推送_钞纸机检好品率', '945eac2102', 'SELECT a.[产品名称],a.[机台],SUM (昨日) 昨日,SUM (本月) 本月 FROM ( SELECT a.[产品名称],a.[机台],round(  CAST (  SUM (a.[好纸总数]) AS FLOAT  ) * 100 / SUM (a.[纸张总数]),2 ) AS 昨日,0 AS 本月 FROM dbo.view_paper_quality AS a WHERE a.纸张总数 >= 4000 AND 好品率 >= 70 AND CONVERT ( VARCHAR,a.[开始时间],112 ) between ? and ? GROUP BY a.[产品名称],a.[机台] UNION ALL SELECT  a.[产品名称],a.[机台],0 AS 昨日,round(  CAST (  SUM (a.[好纸总数]) AS FLOAT  ) * 100 / SUM (a.[纸张总数]),2  ) AS 本月 FROM  dbo.view_paper_quality AS a WHERE  a.纸张总数 >= 4000 AND 好品率 >= 70 AND CONVERT (  VARCHAR (6),a.[开始时间],112 ) = LEFT (?,6) GROUP BY  a.[产品名称],a.[机台] ) a GROUP BY a.[产品名称],a.[机台]', 'tstart,tend,tstart2', '', '2019-03-11 17:39:30', '2019-05-24 21:44:59', '1');
INSERT INTO `sys_api` VALUES ('398', '00000000016', '1', '图像判废产品列表', '34494e6626', 'SELECT a.品种,a.车号,a.工艺,a.冠字,a.工序,a.机台,sum(cast(a.产量 as int)) 产量 FROM v_cbpc_cartlist a WHERE 车号 in (select 车号 FROM v_cbpc_cartlist a WHERE 工序 in(\'印码\',\'丝印\') and CONVERT (VARCHAR,a.完成时间,112) BETWEEN ? and ? ) and 工序 in(\'印码\',\'丝印\') group by a.品种,a.车号,a.工艺,a.冠字,a.工序,a.机台 having sum(cast(a.产量 as int))>5000 order by 1,2', 'tstart,tend', '', '2019-03-12 08:31:09', '2019-05-23 17:22:20', '1');
INSERT INTO `sys_api` VALUES ('399', '00000000016', '1', '图像判废产品列表', 'a68a39de7f', 'SELECT a.品种,a.车号,a.工艺,a.冠字,a.工序,a.机台,sum(cast(a.产量 as int)) 产量 FROM v_cbpc_cartlist a WHERE 车号 in (select 车号 FROM v_cbpc_cartlist a WHERE 工序 in(\'印码\',\'丝印\') and CONVERT (VARCHAR,a.完成时间,112) BETWEEN ? and ? ) and 工序 in(\'印码\',\'丝印\') group by a.品种,a.车号,a.工艺,a.冠字,a.工序,a.机台 having sum(cast(a.产量 as int))>5000 order by 1,2', 'tstart,tend', '', '2019-03-12 08:55:51', '2019-05-23 17:22:10', '1');
INSERT INTO `sys_api` VALUES ('400', '00000000016', '1', 'MES生产作业记录', '239115b144', 'SELECT a.车号,a.工艺,a.冠字,a.工序,a.班次,a.机台,a.机长,a.产量,生产记录,CONVERT (VARCHAR,开始时间,120) AS 开始时间 ,CONVERT (VARCHAR,完成时间,120) AS 完工时间,datediff(MINUTE,开始时间,完成时间) 印刷时长 FROM v_cbpc_cartlist a WHERE CONVERT (VARCHAR,开始时间,112) BETWEEN ? AND ? and 品种=? and a.产量>0', 'tstart,tend,prod', '', '2019-03-12 09:08:43', '2019-04-11 14:38:31', '1');
INSERT INTO `sys_api` VALUES ('401', '00000000002', '1', '产品品种', 'f14b661ec8', 'SELECT rtrim(ProductName) value ,rtrim(ProductName) name FROM ProductData a WHERE status = 1 ORDER BY 2', '', '', '2019-03-12 13:30:41', '2019-03-13 10:16:26', '1');
INSERT INTO `sys_api` VALUES ('402', '00000000016', '1', 'MES 批次在制品印刷上下机跟踪', 'e525459039', 'select carno 车号,mp.Product_Desc 产品,mp.Target_Path_Desc 工序,REPLACE(mes_date,\'-\',\'\') 上机日期,start_date 开印时间,mp.Equ_Desc 设备,mp.MachineTeam_Desc 机台,isneedcount 需要过数,exchange_num 换票数量,sample_times 抽样次数,sample_count 抽样数量,guoban_count 过版纸数量,othercart_count 第三仓计数 from udt_wms_zxqs_batchs b inner join v_Machine_Process mp on b.event_id=mp.event_id where carno =?', 'carno', '', '2019-03-12 15:06:16', '2019-03-13 10:16:26', '1');
INSERT INTO `sys_api` VALUES ('403', '00000000016', '1', 'MES 在制品批次上下机跟踪', 'e61b927c76', 'select carno 车号,mp.Product_Desc Prod_Desc,mp.Target_Path_Desc,mes_date 上机日期,start_date 开印时间,mp.Equ_Desc,mp.MachineTeam_Desc,isneedcount 需要过数,exchange_num 换票数量,sample_times 抽样次数,sample_count 抽样数量,guoban_count 过版纸数量,othercart_count 第三仓计数  from udt_wms_zxqs_batchs b inner join v_Machine_Process mp on b.event_id=mp.event_id where carno =?', 'cano', '', '2019-03-12 15:46:20', '2019-03-13 10:16:26', '1');
INSERT INTO `sys_api` VALUES ('404', '00000000016', '1', '连续废信息通知_车号信息查询', 'afe4110b5e', 'SELECT 车号 \"CARTNUMBER\",冠号 CARNUMBER,字号 GZNUMBER,工艺 TECHTYPENAME,工序 PROCNAME,班次 WORKCLASSNAME,机台 MACHINENAME,机长 CAPTAINNAME,班组 TEAMNAME,班长 MONITORNAME,产量 PRINTNUM,CONVERT (VARCHAR,开始时间,120 ) STARTDATE,品种 PRODUCTNAME FROM V_CBPC_CARTLIST A WHERE 车号 = ? ORDER BY 开始时间', 'cart', '', '2019-03-12 17:36:18', '2019-03-13 10:16:26', '1');
INSERT INTO `sys_api` VALUES ('405', '00000000016', '1', 'MES 指定库房、产品的期初库存', 'fe433c5932', 'WITH vars AS ( SELECT   ? AS storage ,? AS product, eomonth (  dateadd(   MONTH ,- 1,  CAST (? AS VARCHAR) + \'01\'  )  ) enddate,1 as unit ) SELECT t.ExcuteDate,t.Product_Desc,t.Storage_Desc,t.Location_Desc,SUM (t.StartCValue)*vars.unit beginning,SUM (t.EndValue)*vars.unit ending,SUM (t.InValue)*vars.unit receipts,SUM (t.OutValue)*vars.unit payments,(  SUM (t.StartCValue) + SUM (t.InValue) - SUM (t.OutValue) - SUM (t.EndValue) )*vars.unit balance FROM udt_Report_Close_Account_All t INNER JOIN vars ON t.Storage_Id = vars.storage AND t.Product_Id = vars.product AND t.ExcuteDate = vars.enddate GROUP BY t.Storage_Desc,t.Location_Desc,t.Product_Desc,t.ExcuteDate,vars.unit ORDER BY t.Storage_Desc,t.Location_Desc,t.Product_Desc,t.ExcuteDate', 'storage,product,tstart', '', '2019-03-13 08:42:19', '2019-12-13 11:08:40', '1');
INSERT INTO `sys_api` VALUES ('406', '00000000016', '1', '检封兑换详细记录查询', 'bcd7fc16fd', 'SELECT pb.Prod_Type_Desc prod,a.CarNumber cart_number,replace(loc.PU_Desc,\'兑换品\',\'\') AS location,tp.PU_Desc AS class,( CASE WHEN len(ep.PU_Desc) - PATINDEX(\'%型%\',ep.PU_Desc) > 5 THEN SUBSTRING (  ep.pu_desc,PATINDEX(\'%型%\',ep.PU_Desc) + 1,len(ep.PU_Desc) ) ELSE ep.pu_desc END ) AS equipment,a.Business_Desc business,eu.Eng_Unit_Desc unit,a.Quantity exchange_quantity,u.User_Desc AS operator,a.ExCarNumber ex_carnumber,a.ExchangeTime rec_time,er.Event_Reason_Name AS remark FROM udt_ps_Exchange a INNER JOIN v_Prod_BaseInfo pb ON pb.Prod_Id = a.Prod_Id LEFT JOIN Prod_Units_Base loc ON loc.PU_Id = a.Location LEFT JOIN Engineering_Unit eu ON eu.Eng_Unit_Id = a.Unit LEFT JOIN dbo.Users_Base AS u ON u.User_Id = a.Operator LEFT JOIN Event_Reasons er ON a.Reason = er.Event_Reason_Id LEFT JOIN Prod_Units_Base tp ON tp.PU_Id = a.MachineTeam LEFT JOIN Prod_Units_Base ep ON ep.PL_Id = 55 AND ep.PU_Id = a.Equipment WHERE a.CarNumber =? ORDER BY ExchangeTime', 'cart', '', '2019-03-13 11:02:16', '2019-03-13 11:09:02', '0');
INSERT INTO `sys_api` VALUES ('407', '00000000016', '1', '指定日期检封小张兑换记录', '815a404938', 'WITH change_record AS ( SELECT  replace(pb.Prod_Type_Desc,\'品\',\'\') prod, a.CarNumber AS cart_number, CONVERT (  VARCHAR, CAST (a.ExchangeTime AS datetime), 112  ) rec_date, SUM (CAST(a.Quantity AS INT)) exchange_quantity FROM  udt_ps_Exchange a LEFT JOIN v_Prod_BaseInfo pb ON pb.Prod_Id = a.Prod_Id WHERE  a.unit = 51082 AND CONVERT (  VARCHAR, CAST (a.ExchangeTime AS datetime), 112 ) between ? and ? GROUP BY  pb.Prod_Type_Desc, a.CarNumber, CONVERT (  VARCHAR, CAST (a.ExchangeTime AS datetime), 112  ) ) SELECT DISTINCT b.*,(  CASE  WHEN wipInv.ProcessLine_Desc = \'码后核查工艺\' THEN  \'码后核查\'  WHEN wipInv.ProcessLine_Desc = \'清分机全检工艺\' THEN  \'全检品\'  ELSE  wipInv.ProcessLine_Desc  END ) AS procname,LEFT (CrownWordStartNum,6) AS gz_num FROM change_record b LEFT JOIN dbo.udt_pp_MachineProcess a ON b.cart_number = a.CarNumber LEFT JOIN udt_tb_WipInventory wipInv ON wipInv.WI_Id = a.BusinessWiid WHERE CrownWordStartNum IS NOT NULL AND wipInv.ProcessLine_Desc IS NOT NULL', 'tstart,tend', '', '2019-03-13 11:49:18', '2019-03-13 11:50:29', '0');
INSERT INTO `sys_api` VALUES ('408', '00000000002', '1', '锁车原因查询', 'fdb27181fc', 'WITH cartlist AS (SELECT ? cartnumber) SELECT type locktype,username,reason,CONVERT (VARCHAR,rec_time,120) rec_time FROM (  SELECT  (   CASE   WHEN only_lock_cart = 1 THEN   \'批量锁车.不拉号\'   ELSE   \'异常品\'   END  ) type, isnull(machine_name,\'\') + \' \' + reason AS reason, (   CASE   WHEN user_name IS NOT NULL THEN   user_name   ELSE   \'\'   END  ) username, a.rec_date rec_time  FROM  Print_Abnormal_Prod a  WHERE  cart_number = (SELECT * FROM cartlist)  UNION ALL  SELECT DISTINCT   \'人工大张日常抽检\' type,  \'\' AS reason,  \'\' AS username,  a.rec_time  FROM   print_sample_cartlist a  WHERE   cart_number = (SELECT * FROM cartlist)  UNION ALL   SELECT DISTINCT   原因 type,  备注 reason,  记录人 username,  记录时间 rec_time   FROM   view_print_wms_proclist a   WHERE   车号 = (SELECT * FROM cartlist)  ) a ORDER BY 4', 'cart', '', '2019-03-15 11:19:08', '2019-04-08 13:31:54', '0');
INSERT INTO `sys_api` VALUES ('409', '00000000002', '1', '车号追溯_印码同一天生产产品质量信息', '7a696b8571', 'SELECT a.id,a.CartNumber 车号,round(GoodRate,2) 好品率 ,FormatPos1 开位,ErrCount1 缺陷数,ImgVerify1 判废结果 FROM MaHouData a INNER JOIN ( SELECT MachineID,producedate FROM mahoudata WHERE CartNumber = ? ) b ON a.MachineID = b.MachineID AND a.ProduceDate = b.producedate ORDER BY a.id', 'cart', '', '2019-03-15 12:20:08', '2019-03-15 12:37:30', '0');
INSERT INTO `sys_api` VALUES ('410', '00000000003', '1', '图核完工状态查询', '4a590004c6', 'with cart as (select ? from dual) select cart_number \"cart_number\", \'码后\' \"type\", (case   when b.item_flag = 3 then   1   else   0  end) \"status\" from qfm_wip_jobs a inner join qfm_qa_inspect_master b  on a.job_id = b.job_id where cart_number in (select * from cart) union all select cart_number \"cart_number\", \'丝印\' \"type\", (case   when b.item_flag = 3 then   1   else   0  end) \"status\" from wip_jobs a inner join qa_inspect_master b  on a.job_id = b.job_id where cart_number in (select * from cart)', 'cart', '', '2019-03-15 13:45:33', '2019-03-30 15:08:32', '0');
INSERT INTO `sys_api` VALUES ('411', '00000000003', '1', '码后完工状态', 'c99936e709', 'select cart_number,(case  when b.item_flag = 3 then  1  else  0 end) status from qfm_wip_jobs a inner join qfm_qa_inspect_master b on a.job_id = b.job_id where cart_number in (?) and b.item_flag=3', 'cart', '', '2019-03-15 14:24:43', '2019-03-18 08:54:13', '0');
INSERT INTO `sys_api` VALUES ('412', '00000000003', '1', '丝印完工状态', 'ad90d24113', 'select cart_number,(case  when b.item_flag = 3 then  1  else  0 end) status from wip_jobs a inner join qa_inspect_master b on a.job_id = b.job_id where cart_number in (?) and item_flag=3', 'cart', '', '2019-03-15 14:27:55', '2019-03-25 18:19:53', '0');
INSERT INTO `sys_api` VALUES ('413', '00000000021', '1', '凹印离线原始记录', '615bb8b273', 'SELECT a.cart_number 车号,a.machine_name 设备,a.captain_name 机长,a.operator_name 操作人员,a.sidename 正反面,convert(varchar,a.rec_time ,120) 检测时间,a.JPIColor 墨色,a.OIOVer 胶凹套印,a.JPICon 接线,a.score 总分 FROM dbo.view_score_intaglio AS a WHERE a.cart_number =?', 'cart', '', '2019-03-15 16:21:42', '2019-03-15 16:21:42', '0');
INSERT INTO `sys_api` VALUES ('414', '00000000021', '1', '胶印离线原始记录', 'ff15f9dad5', 'SELECT a.cart_number AS [车号],a.machine_name AS [设备],a.captain_name AS [机长],a.operator_name AS [操作人员],a.sidename AS [正反面],convert(varchar,a.rec_time ,120) AS [检测时间],a.JPIColor AS [墨色],a.distance 规矩,a.safe_circle 防复印圈,a.mix_color 混色,a.over_print 对印,a.score AS [总分] FROM dbo.view_score_offset AS a WHERE a.cart_number =?', 'cart', '', '2019-03-15 16:22:04', '2019-03-15 16:22:04', '0');
INSERT INTO `sys_api` VALUES ('415', '00000000016', '1', '机台作业追溯', '9bdb2caa53', 'WITH carts AS ( SELECT a.[车号] AS CartNumber,a.[冠字] AS GzNumber,a.[工艺] AS TechTypeName,a.[工序] AS ProcName,a.[班次] AS WorkClassName,a.[机台] AS MachineName,a.[机长] AS CaptainName,a.[班组] AS TeamName,a.[班长] AS MonitorName,a.[产量] AS PrintNum,CONVERT (VARCHAR,开始时间,120) AS StartDate,a.[品种] AS ProductName,( CASE WHEN 生产记录 IS NULL THEN  \'\' ELSE  replace(生产记录,\'\"\',\'“\') END ) AS WorkInfo,b.remark_type,b.remark,a.mid,a.key_recid,CONVERT (VARCHAR,完成时间,120) AS EndDate,DATEPART(dw,开始时间) - 1 AS weekName,( CASE WHEN c.[是否锁车] = 1 THEN  \'已锁车\' ELSE  \'未锁车\' END ) lockStatus,( CASE WHEN c.[是否人工复查] = 1 THEN  \'人工复查\' ELSE  \'\' END ) checkStatus,c.[付出人员] payOperator,c.[接收方] rcvOperator,c.[库管员] rcvUser FROM v_cbpc_cartlist a LEFT JOIN v_cbpc_cartcare b ON a.车号 = b.cart_number AND a.process = b.process left join v_cbpc_wip_inventory c on a.车号=b.cart_number and a.process=c.CarNo WHERE a.车号 = ? AND a.产量 > 0 ) SELECT * FROM carts WHERE procname <> \'人工拉号\' UNION ALL SELECT cartnumber,gznumber,techtypename,procname,workclassname,machinename,captainname,teamname,monitorname,SUM (printnum) printnum,MIN (startdate) startdate,ProductName,workinfo,\'\' remark_type,\'\' remark,mid,MIN (key_recid) key_recid,MAX (enddate) enddate,weekname,lockstatus,checkstatus,payoperator,rcvoperator,rcvuser FROM carts WHERE procname = \'人工拉号\' GROUP BY cartnumber,gznumber,techtypename,procname,workclassname,machinename,captainname,teamname,monitorname,ProductName,workinfo,mid,weekname,lockstatus,checkstatus,payoperator,rcvoperator,rcvuser ORDER BY 11', 'cart', '', '2019-03-15 17:08:34', '2019-05-24 22:17:32', '0');
INSERT INTO `sys_api` VALUES ('416', '00000000016', '1', '当天生产车号信息追溯', '26a8faebbe', 'SELECT a.车号,冠字,a.班次,a.机台,a.机长,a.产量,CONVERT (VARCHAR,开始时间,120) 开始时间,CONVERT (VARCHAR,[完成时间],120) 完成时间,datediff(MINUTE,开始时间,完成时间) 印刷时长 FROM v_cbpc_cartlist a WHERE CONVERT (VARCHAR(10),开始时间,112) BETWEEN ? and ? AND mid =? AND 产量 > 0 ORDER BY 7', 'tstart,tend,mid', '', '2019-03-15 17:31:34', '2019-04-08 11:51:38', '0');
INSERT INTO `sys_api` VALUES ('417', '00000000016', '1', '车号追溯_兑换记录', 'f1b906ddf9', 'SELECT   replace(tp.PU_Desc,\\\'机台\\\',\\\'\\\') AS 机台,(  CASE  WHEN len(ep.PU_Desc) - PATINDEX(\\\'%型%\\\',ep.PU_Desc) > 5 THEN  SUBSTRING (   ep.pu_desc,  PATINDEX(\\\'%型%\\\',ep.PU_Desc) + 1,  len(ep.PU_Desc)  )  ELSE  ep.pu_desc  END ) AS 设备, a.Quantity 数量,eu.Eng_Unit_Desc 单位,u.User_Desc AS 操作员,a.ExCarNumber 兑换号,a.ExchangeTime 时间 FROM udt_ps_Exchange a  LEFT JOIN Engineering_Unit eu ON eu.Eng_Unit_Id = a.Unit LEFT JOIN dbo.Users_Base AS u ON u.User_Id = a.Operator LEFT JOIN Prod_Units_Base tp ON tp.PU_Id = a.MachineTeam LEFT JOIN Prod_Units_Base ep ON ep.PL_Id = 55 AND ep.PU_Id = a.Equipment WHERE a.CarNumber = ? ORDER BY ExchangeTime', 'cart', '', '2019-03-15 18:41:31', '2019-03-15 18:41:31', '0');
INSERT INTO `sys_api` VALUES ('418', '00000000007', '1', '号码缺陷类型分布', '35e72b945b', 'SELECT faketype as 类型,   (CASE     WHEN type = 1 AND reason = 1 THEN      \\\'串色\\\'     WHEN type = 1 AND reason = 2 THEN      \\\'接线漏白\\\'     WHEN type = 1 AND reason = 3 THEN      \\\'接线串色\\\'     WHEN type = 1 AND reason = 4 THEN      \\\'墨点\\\'     WHEN type = 1 AND reason = 5 THEN      \\\'墨浓\\\'     WHEN type = 1 AND reason = 6 THEN      \\\'墨浅\\\'     WHEN type = 1 AND reason = 7 THEN      \\\'骑码\\\'     WHEN type = 1 AND reason = 8 THEN      \\\'墨脏\\\'     WHEN type = 1 AND reason = 9 THEN      \\\'墨浓\\\'     WHEN type = 1 AND reason = 10 THEN      \\\'花白\\\'     WHEN type = 1 AND reason = 11 THEN      \\\'骑码\\\'     WHEN reason = 12 THEN      \\\'墨脏\\\'     WHEN type = 1 AND reason = 13 THEN      \\\'漏印\\\'     WHEN type = 1 AND reason = 14 THEN      \\\'保险\\\'     WHEN type = 1 AND reason = 20 THEN      \\\'错号0\\\'     WHEN type = 1 AND reason = 21 THEN      \\\'错号1\\\'     WHEN type = 1 AND reason = 22 THEN      \\\'错号2\\\'     WHEN type = 1 AND reason = 23 THEN      \\\'错号3\\\'     WHEN type = 1 AND reason = 24 THEN      \\\'错号4\\\'     WHEN type = 1 AND reason = 25 THEN      \\\'错号5\\\'     WHEN reason = 26 THEN      \\\'错号6\\\'     WHEN type = 1 AND reason = 27 THEN      \\\'错号7\\\'     WHEN type = 1 AND reason = 28 THEN      \\\'错号8\\\'     WHEN type = 1 AND reason = 29 THEN      \\\'错号9\\\'     WHEN type = 1 AND reason = 30 THEN      \\\'可疑\\\'     WHEN type = 2 AND reason = 10 THEN      \\\'待定\\\'     WHEN type = 2 AND reason = 11 THEN      \\\'串色\\\'     WHEN type = 2 AND reason = 12 THEN      \\\'墨脏\\\'     WHEN type = 2 AND reason = 13 THEN      \\\'墨脏\\\'     WHEN type = 2 AND reason = 14 THEN      \\\'走版\\\'     WHEN type = 2 AND reason = 15 THEN      \\\'可疑\\\'     WHEN type = 2 AND reason = 16 THEN      \\\'墨脏\\\'     WHEN type = 2 AND reason = 17 THEN      \\\'走版\\\'     WHEN type = 2 AND reason = 18 THEN      \\\'漏印\\\'     WHEN type = 2 AND reason = 19 THEN      \\\'折角\\\'     WHEN type = 2 AND reason = 20 THEN      \\\'整列走版\\\'     WHEN type = 2 AND reason = 21 THEN      \\\'整列错号\\\'     WHEN type = 2 AND reason = 22 THEN      \\\'整列错号\\\'     WHEN type = 2 AND reason = 23 THEN      \\\'整列错号\\\'     WHEN type = 2 AND reason = 24 THEN      \\\'整列单号\\\'     WHEN type = 2 AND reason = 25 THEN      \\\'整列错号\\\'     WHEN type = 2 AND reason = 26 THEN      \\\'整列漏印\\\'     WHEN type = 2 AND reason = 27 THEN      \\\'待定\\\'     WHEN type = 2 AND reason = 40 THEN      \\\'待定\\\'     WHEN type = 2 AND reason = 41 THEN      \\\'荧光走版\\\'     WHEN type = 2 AND reason = 42 THEN      \\\'荧光断线\\\'     WHEN type = 2 AND reason = 43 THEN      \\\'荧光蹭脏\\\'     WHEN type = 2 AND reason = 44 THEN      \\\'荧光墨淡\\\'     WHEN type = 2 AND reason = 45 THEN      \\\'荧光残缺\\\'     WHEN type = 2 AND reason = 46 THEN      \\\'荧光走板\\\'     WHEN type = 2 AND reason = 47 THEN      \\\'荧光整列走板\\\'     WHEN type = 2 AND reason = 48 THEN      \\\'荧光蹭脏\\\'     WHEN type = 2 AND reason = 49 THEN      \\\'荧光墨淡\\\'     WHEN type = 2 AND reason = 50 THEN      \\\'荧光缺印\\\'     WHEN type = 2 AND reason = 51 THEN      \\\'荧光整列墨淡\\\'     WHEN type = 2 AND reason = 52 THEN      \\\'荧光缺印\\\'     WHEN type = 2 AND reason = 53 THEN      \\\'墨脏\\\'     WHEN type = 2 AND reason = 61 THEN      \\\'水印走板\\\'     WHEN type = 2 AND reason = 62 THEN      \\\'水印无\\\'     WHEN type = 2 AND reason = 63 THEN      \\\'水印浅\\\'     WHEN type = 2 AND reason = 64 THEN      \\\'水印其他\\\'     WHEN type = 2 AND reason = 65 THEN      \\\'水印其他\\\'     WHEN type = 2 AND reason = 66 THEN      \\\'水印未查\\\'     WHEN type = 2 AND reason = 67 THEN      \\\'水印倒头\\\'     WHEN type = 0 AND reason = 1 THEN      \\\'错号\\\'     WHEN type = 0 AND reason = 2 THEN      \\\'串色\\\'     WHEN type = 0 AND reason = 3 THEN      \\\'接线漏白\\\'     WHEN type = 0 AND reason = 4 THEN      \\\'接线串色\\\'     WHEN type = 0 AND reason = 5 THEN      \\\'墨浓\\\'     WHEN type = 0 AND reason = 6 THEN      \\\'墨浅\\\'     WHEN type = 0 AND reason = 7 THEN      \\\'骑码\\\'     WHEN type = 0 AND reason = 8 THEN      \\\'墨脏\\\'     WHEN type = 0 AND reason = 9 THEN      \\\'嵌墨\\\'     WHEN type = 0 AND reason = 10 THEN      \\\'花白\\\'     WHEN type = 0 AND reason = 11 THEN      \\\'走版\\\'     WHEN type = 0 AND reason = 12 THEN      \\\'漏印\\\'     WHEN type = 0 AND reason = 13 THEN      \\\'保险\\\'     WHEN type = 0 AND reason = 14 THEN      \\\'可疑\\\'     WHEN type = 0 AND reason = 15 THEN      \\\'折角\\\'     WHEN type = 0 AND reason = 16 THEN      \\\'荧光走版\\\'     WHEN type = 0 AND reason = 17 THEN      \\\'荧光断线\\\'     WHEN type = 0 AND reason = 18 THEN      \\\'荧光蹭脏\\\'     WHEN type = 0 AND reason = 19 THEN      \\\'荧光墨淡\\\'     WHEN type = 0 AND reason = 20 THEN      \\\'荧光残缺\\\'     WHEN type = 0 AND reason = 21 THEN      \\\'荧光缺印\\\'     WHEN type = 0 AND reason = 22 THEN      \\\'荧光其他\\\'     WHEN type = 0 AND reason = 23 THEN      \\\'水印走版\\\'     WHEN type = 0 AND reason = 24 THEN      \\\'水印无\\\'     WHEN type = 0 AND reason = 25 THEN      \\\'水印印浅\\\'     WHEN type = 0 AND reason = 26 THEN      \\\'水印其它\\\'     WHEN type = 0 AND reason = 27 THEN      \\\'水印未检\\\'     WHEN type = 0 AND reason = 28 THEN      \\\'水印倒头\\\'     WHEN type = 0 AND reason = 29 THEN      \\\'墨点\\\'     WHEN type = 0 AND reason = 99 THEN      \\\'其他\\\'     ELSE      \\\'待定\\\'    END) AS 错误描述,   NUM as 缺陷条数  FROM (SELECT b.waster_reason_id AS ID,       COUNT(*) AS Num,       (CASE         WHEN b.waster_reason_id > 10000 THEN          0         WHEN b.waster_reason_id < 10000 THEN          (CASE           WHEN trunc(b.waster_reason_id / 100) IN (13,16) THEN           1           ELSE           2          END)        END) AS Type,       (CASE         WHEN b.waster_reason_id > 10000 THEN          trunc(b.waster_reason_id / 10000)         WHEN b.waster_reason_id < 10000 THEN          (CASE           WHEN trunc(b.waster_reason_id / 100) IN (13,16) THEN           mod(b.waster_reason_id,100)           ELSE           trunc(b.waster_reason_id / 100)          END)        END) AS Reason,       (CASE         WHEN b.waster_reason_id > 10000 THEN          trunc(b.waster_reason_id / 10000)         WHEN b.waster_reason_id < 10000 THEN          (CASE           WHEN trunc(b.waster_reason_id / 100) IN (13,16) THEN           mod(b.waster_reason_id,100)           ELSE           trunc(b.waster_reason_id / 100)          END)        END) AS Descr,       (CASE         WHEN b.item_flag = 1 THEN          \\\'误废\\\'         WHEN b.item_flag in (2,3) THEN          \\\'实废\\\'         ELSE          \\\'未知类型\\\'        END) as fakeType      FROM qa_inspect_slave b     INNER JOIN qa_inspect_master a       ON b.inspectm_id = a.inspectm_id     INNER JOIN wip_prod_logs t       ON t.log_id = a.log_id     INNER JOIN WIP_JOBS e       on e.job_id = t.job_id     WHERE e.CART_NUMBER = ?     GROUP BY b.waster_reason_id,         (CASE           WHEN b.item_flag = 1 THEN           \\\'误废\\\'           WHEN b.item_flag in (2,3) THEN           \\\'实废\\\'           ELSE           \\\'未知类型\\\'          END)     ORDER BY b.waster_reason_id) t ORDER BY 1,3 desc', 'cart', '', '2019-03-15 18:58:32', '2019-03-15 18:58:32', '0');
INSERT INTO `sys_api` VALUES ('419', '00000000012', '1', '码后特征缺陷图像读取', '82d05d05ed', 'SELECT ErrImage1,ErrImage2,ErrImage3 FROM ImageData WHERE MahouID =?', 'mahouid', '', '2019-03-15 19:01:34', '2019-03-15 19:01:34', '0');
INSERT INTO `sys_api` VALUES ('420', '00000000002', '1', '人工图像判废结果', 'ce6e8bb0ec', 'SELECT a.[车号],a.[生产日期],a.[工艺],a.[品种],a.[机台],a.[缺陷条数],a.[号码开包量],a.[号码实废],a.[丝印开包量],a.[丝印实废],a.[实废大张数],a.[实废小开数],a.[实废条数],a.[开包量],a.判废人员 FROM dbo.view_print_hecha_image_check AS a where a.[车号]=?', 'cart', '', '2019-03-15 19:05:49', '2019-03-15 19:05:49', '0');
INSERT INTO `sys_api` VALUES ('421', '00000000002', '1', '码后核查质量信息查询', '5c62aa7417', 'SELECT a.id,c.MachineName AS [机台],a.ProduceDate AS [生产日期],a.GoodRate AS [好品率],(a.pmcount+a.ygcount+a.hmcount+a.swcount) AS [缺陷条数],a.PMCount AS [票面条数],a.TSCount AS [透视条数],a.NoCheckCount AS [未检条数],a.HMCount AS [号码条数],a.YGCount AS [荧光条数],a.FrontCount AS [正面缺陷数],a.BackCount AS 背面缺陷数,a.SWCount AS [丝网缺陷数],a.TSCount AS [透视缺陷数],a.BlackImgCount AS 黑图数,a.FakePieceCount AS 大张废,a.Mac1 AS [宏区1],a.FormatPos1 AS [开位1],a.ErrCount1 AS [报错条数1],a.ImgVerify1 AS [判废结果1],a.Mac2 AS [宏区2],a.FormatPos2 AS [开位2],a.ErrCount2 AS [报错条数2],a.ImgVerify2 AS [判废结果2],a.Mac3 AS [宏区3],a.FormatPos3 AS [开位3],a.ErrCount3 AS [报错条数3],a.ImgVerify3 AS [判废结果3],a.F1Count AS [正1],a.F2Count AS [正2],a.F3Count AS [正3],a.F4Count AS [正4],a.F5Count AS [正5],a.BS1Count AS 精1,a.BS2Count AS 精2,a.BS3Count AS 精3,a.BS4Count AS 精4 FROM dbo.MaHouData AS a INNER JOIN dbo.MachineData AS c ON a.MachineID = c.ID where CartNumber = ?', 'cart', '', '2019-03-15 19:07:31', '2019-03-15 19:07:31', '0');
INSERT INTO `sys_api` VALUES ('422', '00000000002', '1', 'OCR信息查询', '0361b10a4e', 'SELECT a.车号,a.品种,convert(varchar,a.采集时间,120) 采集时间,a.小开总数,a.已取出,a.多取出,a.开包量,a.机检开包量,0 as 票面开包量,a.小开作废率 FROM dbo.VIEW_PRINT_OCR AS a where a.车号 = ?', 'cart', '', '2019-03-15 19:09:40', '2019-03-15 19:10:21', '0');
INSERT INTO `sys_api` VALUES ('423', '00000000002', '1', '印钞特抽信息', '31cffa2713', 'SELECT DISTINCT B.CartNumber 车号,a.GZNum 印码号,a.Date 上传日期,a.FakeDesc 备注,a.FingerLine 手感线,a.WSignal W信号,a.SMSignal SM信号,a.YG 荧光,a.VCode 号码,a.OVMI OVMI,a.TotalScore 总分,a.OfstFSub 胶正总分,a.OfstFInk 胶正墨色,a.OfstFLineWidth 胶正线宽,a.OfstFSafeCircle 胶正安全圆,a.OfstFLineConn 胶正接线,a.OfstFMix 胶正混色,a.OfstFDuiYin 胶正对印,a.OfstBSub 胶背总分,a.OfstBInk 胶背墨色,a.OfstBLineWidth 胶背线宽,a.OfstBSafeCircle 胶背安全线,a.OfstBOIOver 胶背接线,a.OfstBMix 胶背混色,a.OfstBDuiYin 胶背对印,a.ItgFSub 凹正总分,a.ItgFInk 凹正墨色,a.ItgFOIOver 凹正套印,a.ItgFLineConn 凹正接线,a.ItgBSub 凹背总分,a.ItgBMix 凹背混色,a.ItgBOIOver 凹背套印,a.ItgBLineConn 凹背接线,a.CodeSub 印码总分,a.CodeDistance 印码规矩,a.CodeInk 印码墨色,a.CodeMixColor 印码混色,a.CodeFake 印码缺陷,a.CodeYG 印码荧光,a.CutDistance 裁切得分,a.PaperSub 纸张分数,a.PaperWarterMark 纸张水印,a.PaperSafeLine 纸张安全线,c.edge 边缘,c.squareness 方正度,c.size_length 长度,c.size_width 宽度,c.white_edge_tb 白边上下,c.white_edge_lr 白边左右,c.score 裁切总分 FROM dbo.NoteAysData a INNER JOIN CartInfoData b on a.id=b.NoteAnayID LEFT JOIN NoteAysCutManulData c on a.id = c.note_ays_id where b.CartNumber=?', 'cart', '', '2019-03-15 19:12:44', '2019-03-15 19:12:44', '0');
INSERT INTO `sys_api` VALUES ('424', '00000000006', '1', '在线清数记录', '871cf71675', 'select c.operation_name 工序,    to_char(a.start_date,\\\'yyyy-mm-dd hh24:mm:ss\\\') 印刷开始,   a.rectify_num       识码总数,   a.exchange_num      换票,   a.reprint_count      重印,   a.reject_count      拒识,   a.unnormal_count     异常数,   a.false_recognition_count 识错,   a.wpexchange_count    白纸兑换,   a.sample_count      抽样张数,   a.sample_times      抽样次数,   a.guoban_count      过版纸  from qm_rectify_master a inner join wip_jobs b   on a.job_id = b.job_id inner join DIC_OPERATIONS c   on c.operation_id = a.operation_id where b.cart_number =?   order by 2', 'cart', '', '2019-03-15 19:22:55', '2019-03-15 19:22:55', '0');
INSERT INTO `sys_api` VALUES ('425', '00000000006', '1', '胶凹工序大张废兑换记录', '2ffba3df49', 'select e.operation_name 工序,d.sheet_num 大张号,(case when d.item_flag=1 then \'换出\' else \'换入\' end) 状态 from qm_rectify_master a inner join wip_jobs b  on a.job_id = b.job_id inner join qm_exchange_master c on c.rectifym_id_in = a.rectifym_id inner join qm_exchange_slave d on d.exchangem_id = c.exchangem_id inner join DIC_OPERATIONS e  on e.operation_id = a.operation_id where  b.cart_number=? order by a.start_date,2', 'cart', '', '2019-03-15 19:36:02', '2019-03-15 19:36:37', '0');
INSERT INTO `sys_api` VALUES ('426', '00000000003', '1', '人工漏判小开列表', '1110c3beee', 'SELECT distinct A.cart_number 车号,c.ROUTE_SHEET_NUMBER 相机,c.CONVERT_SHEET_NUMBER 开位,c.SHEET_NUM 印码号,( CASE WHEN c.item_flag = 1 THEN \\\'误废\\\' WHEN c.item_flag = 0 THEN \\\'未判废\\\' WHEN c.item_flag = 2 THEN \\\'机检误废\\\' ELSE \\\'实废\\\' END ) 判废类型,d.status OCR状态,TO_CHAR (d.date_time,\\\'YYYY-MM-DD hh24:mi:ss\\\') 扫描时间 FROM qfm_wip_jobs A INNER JOIN qfm_qa_inspect_master b ON A.job_id = b.job_id INNER JOIN qfm_qa_inspect_slave c ON b.inspectm_id = c.inspectm_id INNER JOIN OCR_CONTRAST_RESULT d on d.cart_num = a.cart_number and c.sheet_num=d.code_num WHERE d.CART_NUM = ? AND d.STATUS = \\\'多取出\\\'', 'cart', '', '2019-03-18 12:33:59', '2019-03-18 12:33:59', '0');
INSERT INTO `sys_api` VALUES ('427', '00000000003', '1', '印码大张废列表', '83e210ff42', 'select a.cart_number 车号,b.CODE_NUM 印码号,\"SUBSTR\"(CODE_NUM,5,4) 大张号 FROM qfm_wip_jobs A INNER JOIN QFM_QA_TEMP_NCKTBL b on a.JOB_ID=b.job_id where a.CART_NUMBER=?', 'cart', '', '2019-03-18 12:34:35', '2019-03-18 12:34:35', '0');
INSERT INTO `sys_api` VALUES ('428', '00000000003', '1', '码后机检原始数据', '9713336765', 'SELECT A.cart_number 车号,c.ROUTE_SHEET_NUMBER \"相机\",c.CONVERT_SHEET_NUMBER \"开位\",c.SHEET_NUM \"印码号\",(case when c.item_flag=1 then \\\'误废\\\' when c.item_flag=0 then \\\'未判废\\\' when c.item_flag=2 then \\\'机检误废\\\' else \\\'实废\\\' end) 判废类型 FROM qfm_wip_jobs A INNER JOIN qfm_qa_inspect_master b ON A .job_id = b.job_id AND A.cart_number = ? INNER JOIN qfm_qa_inspect_slave c ON b.inspectm_id = c.inspectm_id ORDER BY SUBSTR ( c.sheet_num,LENGTH (c.sheet_num) - 3,4 ),c.convert_sheet_number,c.route_sheet_number', 'cart', '', '2019-03-18 12:35:30', '2019-03-18 12:35:30', '0');
INSERT INTO `sys_api` VALUES ('429', '00000000003', '1', 'OCR原始数据', 'f4bdde145a', 'SELECT A.CART_NUM 车号,A.GUANZI_CODE 冠字,to_char(A.DATE_TIME,\\\'yyyy-mm-dd hh24:mi:ss\\\') 扫描时间,A.CODE_NUM 印码号,A.POSITION 正背面,A.IMG_ID 图像ID,A.STATUS 状态 FROM OCR_CONTRAST_RESULT a where a.cart_num= ?', 'cart', '', '2019-03-18 12:35:51', '2019-03-18 12:35:51', '0');
INSERT INTO `sys_api` VALUES ('430', '00000000007', '1', '号码三合一原始数据', '7a36766779', 'SELECT A.cart_number 车号,c.ROUTE_SHEET_NUMBER 相机,c.CONVERT_SHEET_NUMBER 开位,c.ex_codenum 期望号,c.ac_codenum 实际号,( CASE WHEN c.item_flag = 1 THEN \\\'误废\\\' WHEN c.item_flag in (2,3) THEN \\\'实废\\\' ELSE \\\'未知类型\\\' END ) 判废类型 FROM wip_jobs A INNER JOIN WIP_PROD_LOGS l on a.job_id = l.job_id INNER JOIN qa_inspect_master b ON b .log_id = l.log_id INNER JOIN qa_inspect_slave c ON b.inspectm_id = c.inspectm_id where a.cart_number=?', 'cart', '', '2019-03-18 12:36:17', '2019-03-18 12:36:17', '0');
INSERT INTO `sys_api` VALUES ('431', '00000000005', '1', '丝印原始记录', '5527a0d74e', 'SELECT A.cart_number 车号,   c.ROUTE_SHEET_NUMBER \"相机\",   c.CONVERT_SHEET_NUMBER \"开位\",   c.SHEET_NUM \"印码号\",   (case     when c.item_flag = 1 then      \'误废\'     when c.item_flag = 0 then      \'未判废\'     when c.item_flag = 2 then      \'机检误废\'     else      \'实废\'    end) 判废类型  FROM wip_jobs A INNER JOIN qa_inspect_master b   ON A.job_id = b.job_id  INNER JOIN qa_inspect_slave c   ON b.inspectm_id = c.inspectm_id  where A.cart_number =? ORDER BY SUBSTR(c.sheet_num,LENGTH(c.sheet_num) - 3,4),     c.convert_sheet_number,     c.route_sheet_number', 'cart', '', '2019-03-18 13:22:13', '2019-03-18 13:44:07', '0');
INSERT INTO `sys_api` VALUES ('432', '00000000005', '1', '印码识码信息查询', 'a3094edd8b', 'select c.sheet_num 大张喷码号,substr(c.head,5,4) 印码号  from wip_jobs a inner join QA_RECTIFY_MASTER b   on a.job_id = b.job_id  left join qa_rectify_slave c   on c.rectifym_id = b.rectifym_id where a.cart_number = ?  and operation_id = 2', 'cart', '', '2019-03-18 13:41:27', '2019-08-12 09:46:41', '0');
INSERT INTO `sys_api` VALUES ('433', '00000000002', '1', '工艺调整记录', '6c3298675c', 'WITH cartList AS (SELECT ? cart) SELECT * FROM (  SELECT  a.[记录时间], a.[异常类型] 原因, a.[工艺], a.[完成状态], a.解锁状态, a.[备注], a.记录人  FROM  view_print_abnormal_prod a  WHERE  a.车号 = (SELECT * FROM cartList)  UNION  SELECT   记录时间,  原因,  实际执行工艺 工艺,  (   CASE   WHEN 完工状态 = 1 THEN    \'已完成\'   ELSE    \'未完成\'   END   ) 完工状态,  \'\' 解锁状态,  isnull(备注,\'\') 备注,  isnull(记录人,\'\') 记录人  FROM   [dbo].[view_print_wms_proclist] a  WHERE   a.车号 = (SELECT * FROM cartList)  and a.备注 is not null  UNION  SELECT   convert(varchar,rec_time,120) 记录时间,  \'智能精品线\' 原因,  \'\' 工艺,  \'已完成\' 完工状态,  \'\' 解锁状态,  remark 备注,  \'智能精品线\' 记录人  FROM   print_wms_autoproc a  WHERE   a.cart = (SELECT * FROM cartList)  ) a ORDER BY 1', 'cart', '', '2019-03-18 17:25:25', '2019-05-29 10:44:14', '0');
INSERT INTO `sys_api` VALUES ('434', '00000000003', '1', '印码大张未检数据查询', '3c096724a7', 'SELECT a.CART_NUMBER 车号,b.code_num as 印码号,THOUSAND_INDEX as 千位  FROM qfm_wip_jobs A INNER JOIN QFM_QA_TEMP_NCKTBL b   ON A.job_id = b.job_id  AND A.cart_number = ?', 'cart', '', '2019-03-18 17:41:19', '2019-03-18 17:41:19', '0');
INSERT INTO `sys_api` VALUES ('435', '00000000014', '1', '机台作业生产信息查询', 'a11dfa47fb', 'SELECT a.车号 AS \"CartNumber\",   concat(a.冠号,a.字号) AS \"GzNumber\",   a.工艺 AS \"TechTypeName\",   a.工序 AS \"ProcName\",   a.班次 AS \"WorkClassName\",   a.机台 AS \"MachineName\",   a.机长 AS \"CaptainName\",   a.班组 AS \"TeamName\",   a.班长 AS \"MonitorName\",   a.产量 AS \"PrintNum\",   to_char(开始时间,\\\'YYYY-MM-DD hh24:mi:ss\\\') AS \"StartDate\",   a.品种 AS \"ProductName\",    a.生产记录 AS \"WorkInfo\",   a.mid \"mid\",   a.key_recid \"key_recid\",   to_char(完成时间,\\\'YYYY-MM-DD hh24:mi:ss\\\') AS \"EndDate\",   mod(to_char( 开始时间-1,\\\'d\\\'),7) AS \"weekName\",   \\\'\\\' \"checkStatus\",   \\\'\\\' \"payOperator\",   \\\'\\\' \"rcvOperator\",  \\\'\\\' \"rcvUser\"  FROM view_cartfinder a WHERE a.车号 = ?  and 产量 > 0  ORDER BY a.key_recid', 'cart', '', '2019-03-18 20:03:40', '2019-03-18 20:03:40', '0');
INSERT INTO `sys_api` VALUES ('436', '00000000016', '1', '冠字信息追溯', '9480add1f2', 'SELECT a.[车号] AS CartNumber,a.[冠字] AS GzNumber,a.[工艺] AS TechTypeName,a.[工序] AS ProcName,a.[班次] AS WorkClassName,a.[机台] AS MachineName,a.[机长] AS CaptainName,a.[班组] AS TeamName,a.[班长] AS MonitorName,a.[产量] AS PrintNum,CONVERT (VARCHAR,开始时间,120) AS StartDate,a.[品种] AS ProductName,(  CASE  WHEN 生产记录 IS NULL THEN  \'\'  ELSE  replace(生产记录,\'\"\',\'“\')  END ) AS WorkInfo,b.remark_type,b.remark,a.mid,a.key_recid,CONVERT (VARCHAR,完成时间,120) AS EndDate,DATEPART(dw,开始时间) - 1 AS weekName,(  CASE  WHEN c.IsLock = 1 THEN  \'已锁车\'  ELSE  \'未锁车\'  END ) lockStatus,(  CASE  WHEN c.IsCheck = 1 THEN  \'人工复查\'  ELSE  \'\'  END ) checkStatus,c.CurrentUnit_Desc payOperator,c.SourceUnit_Desc rcvOperator,c.OperatorName rcvUser FROM v_cbpc_cartlist a LEFT JOIN v_cbpc_cartcare b ON a.车号 = b.cart_number AND a.process = b.process LEFT JOIN udt_tb_WipInventory c ON c.WI_Id = a.wipinv_id WHERE 车号 in (select 车号 from v_cbpc_cart_lite where 品种 =? AND ( ( 冠号 =? AND 字号 BETWEEN ? AND ? ) OR ( 冠号 =? AND 字号 BETWEEN ? AND ? ) )) AND 产量 > 0 ORDER BY a.key_recid', 'prod,alpha,start,end,alpha2,start2,end2', '', '2019-03-18 20:24:21', '2019-05-23 16:59:07', '0');
INSERT INTO `sys_api` VALUES ('437', '00000000014', '1', '冠字查机台作业信息', '1a5ba9765d', 'SELECT a.车号 AS \"CartNumber\",concat(a.冠号,a.字号) AS \"GzNumber\",a.工艺 AS \"TechTypeName\",a.工序 AS \"ProcName\",a.班次 AS \"WorkClassName\",a.机台 AS \"MachineName\",a.机长 AS \"CaptainName\",a.班组 AS \"TeamName\",a.班长 AS \"MonitorName\",a.产量 AS \"PrintNum\",to_char(开始时间,\\\'YYYY-MM-DD hh24:mi:ss\\\') AS \"StartDate\",a.品种 AS \"ProductName\",a.生产记录 AS \"WorkInfo\",a.mid \"mid\",a.key_recid \"key_recid\",to_char(完成时间,\\\'YYYY-MM-DD hh24:mi:ss\\\') AS \"EndDate\",mod(to_char( 开始时间-1,\\\'d\\\'),7) AS \"weekName\",\\\'\\\' \"checkStatus\",\\\'\\\' \"payOperator\",\\\'\\\' \"rcvOperator\",\\\'\\\' \"rcvUser\" FROM view_cartfinder a WHERE 品种=? and(( 冠号=? and 字号 between ? and ?) or ( 冠号=? and 字号 between ? and ?)) ORDER BY a.key_recid', 'prod,alpha,start,end,alpha2,start2,end2', '', '2019-03-18 20:29:48', '2019-03-18 20:29:48', '0');
INSERT INTO `sys_api` VALUES ('438', '00000000003', '1', '票面实废图像信息查询', '49a52af747', 'SELECT c.ROUTE_SHEET_NUMBER \"camera\",c.CONVERT_SHEET_NUMBER \"pos\",(case when c.SHEET_NUM is null then c.ex_codenum else c.SHEET_NUM end) \"code\",C.IMAGE_BLOB AS \"image\",(case  when b.operation_id = 10 then  \'tubu\'  else  \'mahou\' end) \"type\",c.error_site \"macro_id\" FROM qfm_wip_jobs A INNER JOIN qfm_qa_inspect_master b ON A.job_id = b.job_id AND A.cart_number = ? INNER JOIN qfm_qa_inspect_slave c ON b.inspectm_id = c.inspectm_id and c.image_blob IS NOT NULL ORDER BY c.error_site,SUBSTR(c.sheet_num,LENGTH(c.sheet_num) - 3,4),c.convert_sheet_number,c.route_sheet_number', 'cart', '', '2019-03-18 21:16:41', '2019-05-17 08:24:03', '0');
INSERT INTO `sys_api` VALUES ('439', '00000000005', '1', '丝印实废图像信息查询', 'e6ccdf08a7', 'select d.ROUTE_SHEET_NUMBER \"camera\",       d.CONVERT_SHEET_NUMBER \"pos\",       b.code_num \"code\",               d.IMAGE_BLOB as \"image\",       \'silk\' \"type\",       d.error_site \"macro_id\",               d.SHEET_NUM \"sheet_num\"  from wip_jobs a inner join qa_inspect_master c   on c.job_id = a.job_id inner join qa_inspect_slave d   on c.inspectm_id = d.inspectm_id inner join qa_temp_qatbl b   on a.job_id = b.job_id  and b.inspects_id = d.inspects_id where cart_number =?', 'cart', '', '2019-03-18 21:16:56', '2019-08-14 08:41:14', '0');
INSERT INTO `sys_api` VALUES ('440', '00000000007', '1', '号码实废图像信息查询', '4b255e8000', 'SELECT c.route_sheet_number AS \"camera\",c.convert_sheet_number AS \"pos\",c.EX_CODENUM AS \"code\",c.image_blob AS \"image\",\'code\' \"type\",\' \' as \"macro_id\" FROM wip_jobs T INNER JOIN wip_prod_logs A ON A .job_id = T .job_id and T.cart_number = ? INNER JOIN qa_inspect_master b ON b.log_id = A .log_id INNER JOIN qa_inspect_slave c ON b.inspectm_id = c.inspectm_id AND c.item_flag IN (2,3)', 'cart', '', '2019-03-18 21:17:11', '2019-05-17 08:16:48', '0');
INSERT INTO `sys_api` VALUES ('441', '00000000017', '1', '立体库-LED显示', '1b423e7261', 'SELECT vl.LedNo,vl.LedUniteId,vl.RunInfo,vl.FaultMessage,vl.DoingTransferlog FROM V_LEDINFO vl;', '', '', '2019-03-25 10:09:58', '2019-03-25 10:41:18', '0');
INSERT INTO `sys_api` VALUES ('442', '00000000016', '1', '数数机过数记录_日期', '62b08c4d55', 'SELECT C.CPCH,C.UserDefine2 AS \'PROC\',(SELECT U.User_Desc FROM Users_Base U WHERE C.CZYKH = U.Username) AS GSY,C.XH,C.JSJG,C.BCZS,C.JSQR,C.KSSJ,C.JSSJ,C.IPDZ,C.ID FROM SHUSHUJI_COUNT C WHERE KSSJ BETWEEN ? AND ?;', 'tstart,tend', '', '2019-03-25 11:51:53', '2019-08-31 13:07:23', '0');
INSERT INTO `sys_api` VALUES ('443', '00000000016', '1', '数数机过数记录_车号', '822f135431', 'SELECT C.CPCH,C.UserDefine2 AS \'PROC\',(SELECT U.User_Desc FROM Users_Base U WHERE C.CZYKH = U.Username) AS GSY,C.XH,C.JSJG,C.BCZS,C.JSQR,C.KSSJ,C.JSSJ,C.IPDZ,C.ID FROM SHUSHUJI_COUNT C WHERE CPCH LIKE ?;', 'cpch', '', '2019-03-25 16:59:11', '2019-08-31 13:07:16', '0');
INSERT INTO `sys_api` VALUES ('444', '00000000002', '1', '是否需要同步图核完工记录', '6078facd84', 'SELECT top 1 id FROM print_mes_auto_waster_complete WHERE CONVERT (VARCHAR,rec_date,112) = CONVERT (VARCHAR,GETDATE(),112)', '', '', '2019-03-25 17:29:41', '2019-03-25 18:40:12', '0');
INSERT INTO `sys_api` VALUES ('445', '00000000003', '1', '指定日期判废完工产品列表', 'cfb8828229', 'with carts as (select distinct cart_number  from qfm_wip_jobs a inner join qfm_qa_inspect_master b  on a.job_id = b.job_id inner join qfm_wip_prod_logs c  on a.job_id = c.job_id where b.item_flag = 3  and to_char(c.end_date,\'YYYYMMDD\') between ? and ?) select distinct a.cart_number \"cart_number\" from (select c.*,substr(c.cart_number,3,1) prod_id,b.item_flag from carts c left join wip_jobs a  on a.cart_number = c.cart_number left join qa_inspect_master b  on a.job_id = b.job_id) a where (a.prod_id=8 and item_flag=3 )or prod_id<>8 order by substr(a.cart_number,3,1),1', 'tstart,tend', '', '2019-03-25 18:32:31', '2019-03-25 19:10:55', '0');
INSERT INTO `sys_api` VALUES ('446', '00000000002', '1', '记录图核完工产品列表', 'aa7e9a1779', 'insert into dbo.print_mes_auto_waster_complete(rec_date,carts,mes_id ) values (?,?,?)', 'rec_date,carts,mes_id', '', '2019-03-25 18:41:27', '2019-03-25 18:41:27', '0');
INSERT INTO `sys_api` VALUES ('447', '00000000016', '1', '记录图像完工产品列表', 'f204c36e17', 'insert into udt_di_wasterlog(excutetime,strcarno ) values (?,?)', 'excutetime,strcarno', '', '2019-03-25 18:42:59', '2019-03-25 18:42:59', '0');
INSERT INTO `sys_api` VALUES ('448', '00000000016', '1', '数数机过数记录_日期机型', '608bea6a60', 'SELECT C.CPCH,C.UserDefine2 AS \'PROC\',(SELECT U.User_Desc FROM Users_Base U WHERE C.CZYKH = U.Username) AS GSY,C.XH,C.JSJG,C.BCZS,C.JSQR,C.KSSJ,C.JSSJ,C.IPDZ,C.ID FROM SHUSHUJI_COUNT C WHERE KSSJ BETWEEN ? AND ? AND IPDZ LIKE ?;', 'tstart,tend,ipdz', '', '2019-03-26 08:49:43', '2019-08-31 13:07:11', '0');
INSERT INTO `sys_api` VALUES ('449', '00000000003', '1', 'oracle blob测试', 'c255d45cc9', 'SELECT C.IMAGE_BLOB AS \"image\" FROM qfm_qa_inspect_slave c where inspects_id in (442635306,442635310)', '', '', '2019-03-26 12:54:21', '2019-03-26 17:16:57', '0');
INSERT INTO `sys_api` VALUES ('450', '00000000016', '1', '主业及有价证券过版纸收付月报表', '09dd48a10a', 'SELECT  replace(a.Product_Desc,\\\'品\\\',\\\'\\\') 品种,a.LastMonthBalance 上月结存,a.MonthIn 本月收入,a.JiaoYin 胶印,a.SiYin 丝印,a.WaYin 凹印,a.YinMa 印码,a.TuBu 涂布,(  a.JiaoYin + a.SiYin + a.WaYin + a.YinMa + a.TuBu ) 付出小计,a.MonthBalance 本月结存,(  CASE  WHEN a.Remark IS NULL THEN  \\\'\\\'  ELSE  a.remark  END ) 备注 FROM dbo.udt_report_Storage_InOut_GuoBanZhi AS a WHERE a.Location_Desc = \\\'白过版纸\\\' and replace(a.YYYY_MM,\\\'-\\\',\\\'\\\') between left(?,6) and left(?,6)', 'tstart,tend', '', '2019-03-26 13:30:16', '2019-03-26 13:30:16', '0');
INSERT INTO `sys_api` VALUES ('451', '00000000005', '1', '丝印平均实废统计', '314ce68cc4', 'select d.product_name 品种,a.平均实废,a.大万数 from (select a.product_id,   round(count(c.inspects_id) / count(distinct a.job_id),2) 平均实废,   count(distinct a.job_id) 大万数  from wip_jobs a inner join qa_inspect_master b   on a.job_id = b.job_id inner join qa_inspect_slave c   on b.inspectm_id = c.inspectm_id  where to_char(start_date,\\\'yyyymmdd\\\') between ? and ?  and c.image_blob is not null group by a.product_id) a  left join dic_products d   on a.product_id = d.product_id', 'tstart,tend', '', '2019-03-26 16:25:24', '2019-03-26 16:26:15', '0');
INSERT INTO `sys_api` VALUES ('452', '00000000007', '1', '号码平均实废统计', '7eb1df0ce0', 'SELECT d.product_name 品种,round(count(c.inspects_id)/count(distinct a.job_id),2) 平均号码实废,count(distinct a.job_id) 大万数 FROM wip_jobs T INNER JOIN wip_prod_logs A ON A.job_id = T.job_id INNER JOIN qa_inspect_master b ON b.log_id = A.log_id INNER JOIN qa_inspect_slave c ON b.inspectm_id = c.inspectm_id AND c.item_flag IN (2,3) inner join dic_products d on d.product_id=t.product_id where to_char(a.start_date,\'yyyymmdd\') between ? and ? group by d.product_name', 'tstart,tend', '', '2019-03-26 16:35:45', '2019-03-29 18:25:19', '0');
INSERT INTO `sys_api` VALUES ('453', '00000000003', '1', '票面平均实废统计', '6cb6fb0025', 'select d.product_name 品种,a.平均实废,a.大万数  from (select a.product_id,       round(count(c.inspects_id) / count(distinct a.job_id),2) 平均实废,       count(distinct a.job_id) 大万数      from qfm_wip_jobs a     inner join qfm_qa_inspect_master b       on a.job_id = b.job_id     inner join qfm_qa_inspect_slave c       on b.inspectm_id = c.inspectm_id     where to_char(start_date,\\\'yyyymmdd\\\') between ? and ?       and c.image_blob is not null     group by a.product_id) a  left join dic_products d   on a.product_id = d.product_id', 'tstart,tend', '', '2019-03-26 16:42:45', '2019-03-26 16:42:45', '0');
INSERT INTO `sys_api` VALUES ('454', '00000000016', '1', '数数机过数记录_车号2', 'badaad5c71', 'SELECT C.CPCH,C.UserDefine2 AS \'PROC\',(SELECT U.User_Desc FROM Users_Base U WHERE C.CZYKH = U.Username) AS GSY,C.XH,C.JSJG,C.BCZS,C.JSQR,C.KSSJ,C.JSSJ,C.IPDZ,C.ID FROM SHUSHUJI_COUNT C WHERE CPCH LIKE \'%?%\';', 'cpch', '', '2019-03-27 08:18:48', '2019-08-31 13:07:04', '0');
INSERT INTO `sys_api` VALUES ('455', '00000000016', '1', 'MES 总帐（按货位）期初', 'baa38ba149', 'WITH vars AS ( SELECT ? AS product,dateadd(day,-1,concat(?,\'-01\')) AS enddate ) SELECT t.ExcuteDate,t.Product_Desc,proce.process Location_Desc,SUM (t.StartCValue) beginning,SUM (t.EndValue) ending,SUM (t.InValue) receipts,SUM (t.OutValue) payments,( SUM (t.StartCValue) + SUM (t.InValue) - SUM (t.OutValue) - SUM (t.EndValue) ) balance FROM udt_Report_Close_Account_All t LEFT JOIN udt_tb_wms_process proce ON t.Location_Id = proce.locationid INNER JOIN ( SELECT DISTINCT LocationId,LocationDesc FROM v_Storage_Location_Prod loc WHERE loc.PU_Code IN (\'HPK\',\'ZZPK\',\'ZZPLTK\',\'DHK\',\'FPK\',\'YZK\') ) loc ON t.Location_Id = loc.LocationId INNER JOIN vars ON t.Product_Id = vars.product AND t.ExcuteDate =vars.enddate WHERE proce.locationid IS NOT NULL AND t.Location_Desc <> \'NULL\' GROUP BY proce.process,t.Product_Desc,t.ExcuteDate ORDER BY proce.process,t.Product_Desc,t.ExcuteDate', 'product,month', '', '2019-03-27 10:15:46', '2019-04-02 21:03:47', '0');
INSERT INTO `sys_api` VALUES ('456', '00000000016', '1', '库房列表', '2d61c884e5', 'select s.StorageId value,s.StorageDesc name from v_Storage s where s.StorageTypeCode in (\\\'BZJGK\\\',\\\'CPK\\\',\\\'DHK\\\',\\\'FPK\\\',\\\'HPK\\\',\\\'YZK\\\',\\\'ZZPLTK\\\',\\\'ZZPK\\\') and s.StorageDesc not like \\\'%终端%\\\' order by s.StorageTypeDesc,s.StorageDesc', '', '', '2019-03-27 16:37:05', '2019-03-27 16:37:05', '0');
INSERT INTO `sys_api` VALUES ('457', '00000000016', '1', '品种列表', '9291f508b7', 'select Prod_Id value,dbo.fnGUI_GetSplitString(Prod_Desc,\\\'.\\\',2) name from Products where Product_Family_Id in (3212) order by dbo.fnGUI_GetSplitString(Prod_Desc,\\\'.\\\',2) desc', '', '', '2019-03-27 16:40:25', '2019-03-27 16:40:25', '0');
INSERT INTO `sys_api` VALUES ('458', '00000000016', '1', 'MES 分库房、分产品月收付存台帐', '29a1a81b23', 'WITH vars AS ( SELECT  ? AS storage ,? AS product ,? AS startdate ,? AS enddate,1 as unit ) SELECT t.ExcuteDate,t.Product_Desc,t.Storage_Desc,t.Location_Desc,SUM (t.StartCValue)*vars.unit beginning,SUM (t.EndValue)*vars.unit ending,SUM (t.InValue)*vars.unit receipts,SUM (t.OutValue)*vars.unit payments,(  SUM (t.StartCValue) + SUM (t.InValue) - SUM (t.OutValue) - SUM (t.EndValue) )*vars.unit balance FROM udt_Report_Close_Account_All t INNER JOIN vars ON t.Storage_Id = vars.storage AND t.Product_Id = vars.product AND CONVERT ( VARCHAR (6),CAST (t.ExcuteDate AS datetime),112 ) BETWEEN vars.startdate AND vars.enddate GROUP BY t.Storage_Desc,t.Location_Desc,t.Product_Desc,t.ExcuteDate,vars.unit ORDER BY t.Storage_Desc,t.Location_Desc,t.Product_Desc,t.ExcuteDate', 'storage,product,tstart,tend', '', '2019-03-27 16:42:22', '2019-12-13 11:06:53', '0');
INSERT INTO `sys_api` VALUES ('459', '00000000022', '1', '周转库及成品库入库操作', '928c4da250', 'WITH srcData AS ( select PZ,GZ,xwdah,xwdh,xh,hw,MXZS,rq,temp.CZ,SCXMC as scline,Email as kgcodeun,ROW_NUMBER() over(order by temp.CZ,temp.PZ,temp.GZ,temp.rq,SCXMC,Email,temp.xh) as rownum from( (SELECT distinct PZ,GZ,xh,MXZS,c.XID,( CASE WHEN c.CZ = \'D\' THEN \'16502\' ELSE \'11112\' END ) AS hw,c.CZ,xwdh,xwdah,CONVERT ( VARCHAR,CAST ( DATEADD(HOUR ,- 3,c.RQ) AS DATE ),112 ) AS rq FROM dbo.B_CZ c LEFT JOIN (SELECT a.XID,a.xh,a.PZ,a.GZ,a.MXZS,b.xwdh,b.xwdah FROM dbo.B_XQ a INNER JOIN dbo.B_GZ b ON a.PZ = b.PZ AND a.GZ = b.GZ) x ON c.XID=x.XID WHERE c.CZ in (\'D\',\'R\') AND c.ZTBM=0 AND CONVERT( VARCHAR,CAST ( DATEADD(HOUR ,-3,c.RQ) AS DATE ),112 ) BETWEEN ? AND ?  GROUP BY PZ,GZ,xh,MXZS,xwdh,xwdah,CONVERT( VARCHAR,CAST ( DATEADD(HOUR ,-3,c.RQ) AS DATE ),112 ),( CASE WHEN c.CZ = \'D\' THEN \'16502\' ELSE \'11112\' END ),c.CZ,c.XID) ) as temp LEFT JOIN (SELECT a.XID,d.SCXMC FROM dbo.B_XQ a INNER JOIN dbo.B_SCX d ON a.SCXID = d.SCXID) y ON temp.XID=y.XID LEFT JOIN ( select XID,CZ,Email,UserName,RY1 from (SELECT XID,CZ,RY1 FROM dbo.B_CZ c1 WHERE RQ>=DATEADD(DAY,-2,GETDATE()) AND c1.CZ IN (\'D\',\'R\') AND c1.ZTBM=0 AND RQ=(SELECT MAX(RQ) FROM dbo.B_CZ WHERE XID=c1.XID AND CZ=c1.CZ)) AS t INNER JOIN (SELECT u.UserName,r.Email FROM dbo.aspnet_Users u INNER JOIN dbo.aspnet_Membership r ON u.UserId = r.UserId) AS w ON t.RY1 = w.UserName ) AS k ON temp.XID=k.XID AND temp.CZ=k.CZ )  SELECT kgcodeun,\'\' as kgcode,(replace(convert(nvarchar(10),cast(rq as datetime),111),\'/\',\'-\')+\' 12:00:00.000\') as rq,a.PZ product,MIN (a.XH) boxid_start,SUM (a.MXZS) mxzs,a.GZ gz,scline,a.XWDAH boxgz,a.XWDH xwdh,\'\' as plancode,\'\' as plancodeun,\'\' as printcode,\'\' as printcodeun,\'\' as zxcode,\'\' as zxcodeun,a.hw as hw,\'\' as Sources ,MAX (a.XH) boxid_end,DATEADD(HOUR,-3,GETDATE()) as rec_time FROM srcData a GROUP BY a.PZ,a.GZ,a.xwdah,a.xwdh,a.hw,xh-rownum,rq,scline,kgcodeun order by PZ,GZ,hw,boxid_start;', 'tstart,tend', '', '2019-03-28 17:18:11', '2019-09-25 17:04:25', '0');
INSERT INTO `sys_api` VALUES ('460', '00000000022', '1', '周转库及成品库出库操作', 'da7906012f', 'WITH srcData AS ( select PZ,GZ,xwdah,xwdh,xh,hw,MXZS,rq,temp.CZ,SCXMC as scline,Email as kgcodeun,ROW_NUMBER() over(order by temp.CZ,temp.PZ,temp.GZ,temp.rq,SCXMC,Email,temp.xh) as rownum from( (SELECT distinct PZ,GZ,xh,MXZS,c.XID,( CASE WHEN c.cz = \'R\' THEN \'16502\' ELSE \'11112\' END ) AS hw,c.CZ,xwdh,xwdah,CONVERT ( VARCHAR,CAST ( DATEADD(HOUR ,- 3,c.RQ) AS DATE ),112 ) AS rq FROM dbo.B_CZ c LEFT JOIN (SELECT a.XID,a.xh,a.PZ,a.GZ,a.MXZS,b.xwdh,b.xwdah FROM dbo.B_XQ a INNER JOIN dbo.B_GZ b ON a.PZ = b.PZ AND a.GZ = b.GZ) x ON c.XID=x.XID WHERE c.CZ in (\'C\',\'R\') AND c.ZTBM=0 AND CONVERT( VARCHAR,CAST ( DATEADD(HOUR ,-3,c.RQ) AS DATE ),112 ) BETWEEN ? AND ?  GROUP BY PZ,GZ,xh,MXZS,xwdh,xwdah,CONVERT( VARCHAR,CAST ( DATEADD(HOUR ,-3,c.RQ) AS DATE ),112 ),( CASE WHEN c.cz = \'R\' THEN \'16502\' ELSE \'11112\' END ),c.CZ,c.XID) ) as temp LEFT JOIN (SELECT a.XID,d.SCXMC FROM dbo.B_XQ a INNER JOIN dbo.B_SCX d ON a.SCXID = d.SCXID) y ON temp.XID=y.XID LEFT JOIN ( select XID,CZ,Email,UserName,RY1 from (SELECT XID,CZ,RY1 FROM dbo.B_CZ c1 WHERE RQ>=DATEADD(DAY,-2,GETDATE()) AND c1.CZ IN (\'C\',\'R\') AND c1.ZTBM=0 AND RQ=(SELECT MAX(RQ) FROM dbo.B_CZ WHERE XID=c1.XID AND CZ=c1.CZ)) as t INNER JOIN (SELECT u.UserName,r.Email FROM dbo.aspnet_Users u INNER JOIN dbo.aspnet_Membership r ON u.UserId = r.UserId) AS w ON t.RY1 = w.UserName ) AS k ON temp.XID=k.XID AND temp.CZ=k.CZ )  SELECT kgcodeun,\'\' as kgcode,(replace(convert(nvarchar(10),cast(rq as datetime),111),\'/\',\'-\')+\' 12:00:00.000\') as rq,a.PZ product,MIN (a.XH) boxid_start,SUM (a.MXZS) mxzs,a.GZ gz,scline,a.XWDAH boxgz,a.XWDH xwdh,\'\' as jjycode,\'\' as jjycodeun,\'\' as Sources,a.hw as hw,\'\' as OutWeiZhiDesc ,MAX (a.XH) boxid_end,DATEADD(HOUR,-3,GETDATE()) as rec_time FROM srcData a GROUP BY a.PZ,a.GZ,a.xwdah,a.xwdh,a.hw,xh-rownum,rq,scline,kgcodeun order by PZ,GZ,hw,boxid_start;', 'tstart,tend', '', '2019-03-29 10:18:41', '2019-09-25 17:05:45', '0');
INSERT INTO `sys_api` VALUES ('461', '00000000022', '1', '周转库、成品库在库情况', '559fbdddf6', 'SELECT a.PZ product,a.GZ gz,MIN (a.XH) boxid_start,MAX (a.xh) boxid_end,a.XWDAH boxgz,a.XWDH xwdh,SUM (a.MXZS) mxzs,\'\' rq,hw,CONVERT (VARCHAR,getdate(),120) rec_time FROM (  SELECT  *  FROM  dbo.V_LK AS a  UNION ALL  SELECT   *  FROM   dbo.V_CPK AS a ) a GROUP BY a.PZ,a.GZ,a.XWDAH,a.XWDH,a.hw ORDER BY 8,1,2,3', '', '', '2019-03-29 10:26:33', '2019-06-11 16:17:27', '0');
INSERT INTO `sys_api` VALUES ('462', '00000000016', '1', '记录装箱入库数据', 'f297e52768', 'insert into dbo.udt_tb_ewminstorage(product,gz,boxid_start,boxid_end,boxgz,xwdh,mxzs,rq,scline,kgcodeun,hw,rec_time ) values ?', 'values', '@desc:批量插入数据时，约定使用二维数组values参数，格式为[{product,gz gz,boxid_start,boxid_end,boxgz,xwdh xwdh,mxzs mxzs,rq rq,scline,kgcodeun,hw hw, rec_time }]，数组的每一项表示一条数据', '2019-03-29 10:41:32', '2019-03-29 11:13:14', '0');
INSERT INTO `sys_api` VALUES ('463', '00000000016', '1', '记录装箱出库数据', '24f104813a', 'insert into dbo.udt_tb_ewmoutstorage(product,gz,boxid_start,boxid_end,boxgz,xwdh,mxzs,rq,scline,kgcodeun,hw,rec_time ) values ?', 'values', '@desc:批量插入数据时，约定使用二维数组values参数，格式为[{product,gz gz,boxid_start,boxid_end,boxgz,xwdh xwdh,mxzs mxzs,rq rq,scline,kgcodeun,hw hw, rec_time }]，数组的每一项表示一条数据', '2019-03-29 10:43:28', '2019-03-29 11:12:54', '0');
INSERT INTO `sys_api` VALUES ('464', '00000000016', '1', '记录装箱当前库存', 'e6e57257b3', 'insert into dbo.udt_tb_ewmstorageinfo(product,gz,boxid_start,boxid_end,boxgz,xwdh,mxzs,rq,hw,rec_time ) values ?', 'values', '@desc:批量插入数据时，约定使用二维数组values参数，格式为[{product,gz gz,boxid_start,boxid_end,boxgz,xwdh xwdh,mxzs mxzs,rq rq,hw hw, rec_time }]，数组的每一项表示一条数据', '2019-03-29 10:44:45', '2019-03-29 11:12:28', '0');
INSERT INTO `sys_api` VALUES ('465', '00000000016', '1', '清除当前库存', '7e06d2db7e', 'delete from dbo.udt_tb_ewmstorageinfo', '', '', '2019-03-29 10:45:17', '2019-03-29 10:45:17', '0');
INSERT INTO `sys_api` VALUES ('466', '00000000016', '1', '清除装箱今日入库数据', '4de12c9317', 'delete FROM dbo.udt_tb_EwmInStorage where convert(varchar,rec_time,112) = convert(varchar,GETDATE(),112)', '', '', '2019-03-29 10:46:34', '2019-03-29 10:46:34', '0');
INSERT INTO `sys_api` VALUES ('467', '00000000016', '1', '清除装箱今日出库数据', 'f5562a0731', 'delete FROM dbo.udt_tb_EwmOutStorage where convert(varchar,rec_time,112) = convert(varchar,GETDATE(),112)', '', '', '2019-03-29 10:46:58', '2019-03-29 10:46:58', '0');
INSERT INTO `sys_api` VALUES ('469', '00000000016', '1', '精品线_机台质量排名', '7e43522457', 'WITH prod_list AS ( SELECT prod_id FROM Products_Base WHERE SUBSTRING (prod_desc,4,5) IN ( SELECT  SUBSTRING (prod_desc,4,5) prod_desc FROM  Products_Base WHERE  prod_id = ? ) ),change_log AS ( SELECT a.CarNumber AS cart_number,SUM (CAST(a.Quantity AS INT)) exchange_quantity FROM udt_ps_Exchange a INNER JOIN prod_list b ON a.prod_id = b.prod_id WHERE a.unit = 51082 AND CONVERT ( VARCHAR,CAST (a.ExchangeTime AS datetime),112 ) BETWEEN CONVERT ( VARCHAR,dateadd(MONTH ,- 1,getdate()),112 ) AND CONVERT (VARCHAR,GETDATE(),112) GROUP BY a.CarNumber ),change_record AS ( SELECT DISTINCT b.* FROM change_log b LEFT JOIN dbo.udt_pp_MachineProcess a ON b.cart_number = a.CarNumber LEFT JOIN udt_tb_WipInventory wipInv ON wipInv.WI_Id = a.BusinessWiid WHERE CrownWordStartNum IS NOT NULL AND wipInv.ProcessLine_Desc = \'码后核查工艺\' ),fakeList AS ( SELECT b.工序 proc_name,b.erp_code,b.pu_desc,AVG (exchange_quantity) fake_num,COUNT (*) cart_num FROM change_record a INNER JOIN dbo.udt_pp_MachineProcess udp_pp ON a.cart_number = udp_pp.CarNumber INNER JOIN udt_tb_WipInventory wipInv ON wipInv.WI_Id = udp_pp.BusinessWiid INNER JOIN ( SELECT a.CarNumber AS [车号],b.Path_Desc AS [工序],r.pu_desc,r.erpcode erp_code FROM dbo.udt_pp_MachineProcess a LEFT JOIN Prdexec_Paths b ON b.Path_Id = a.TargetProcess LEFT JOIN v_cbpc_classinfo r ON r.PU_Id = a.MachineTeam WHERE a.CarNumber IS NOT NULL and r.PU_Desc<>\'凹印况东机台\' ) b ON a.cart_number = b.车号 WHERE b.工序 LIKE \'%胶%\' OR b.工序 LIKE \'凹%\' GROUP BY 工序,b.pu_desc,erp_code HAVING COUNT (*) > 50 ),excellent_list AS ( SELECT proc_name,erp_code,fake_num,cart_num FROM ( SELECT  row_number () OVER (  partition BY proc_name  ORDER BY  proc_name, fake_num, (  CASE replace(   replace(pu_desc,\'凹印\',\'\'), \'机台\', \'\'  )  WHEN \'杨平\' THEN   0  WHEN \'任晓军\' THEN   0  WHEN \'蔡勇\' THEN   0  when \'刘潺\' then 0   ELSE   1  END  )  ) rn ,* FROM  fakeList ) a WHERE a.rn < 3 UNION ALL SELECT DISTINCT b.Path_Desc AS [工序],r.erpcode erp_code,0 fake_num,0 cart_num FROM dbo.udt_pp_MachineProcess a LEFT JOIN Prdexec_Paths b ON b.Path_Id = a.TargetProcess LEFT JOIN v_cbpc_classinfo r ON r.PU_Id = a.MachineTeam WHERE b.Path_Desc LIKE \'%丝%\' AND a.CarNumber IS NOT NULL ) SELECT * FROM excellent_list WHERE erp_code = ?', 'prod,machine', '', '2019-03-30 14:20:04', '2019-08-12 10:54:31', '0');
INSERT INTO `sys_api` VALUES ('470', '00000000006', '1', '精品线_单工序换票数是否大于3张', '4bb557f3b7', 'SELECT b.cart_number \"cart_number\",e.operation_name proc_name,count(1) change_num FROM qm_rectify_master a INNER JOIN wip_jobs b  ON a.job_id = b.job_id INNER JOIN qm_exchange_master c  ON c.rectifym_id_in = a.rectifym_id INNER JOIN qm_exchange_slave d  ON d.exchangem_id = c.exchangem_id INNER JOIN DIC_OPERATIONS e  ON e.operation_id = a.operation_id WHERE b.cart_number in (?) and d.item_flag = 1 group by b.cart_number,e.operation_name having count(1) >= 3', 'cart', '', '2019-03-30 14:44:59', '2019-03-30 16:11:33', '0');
INSERT INTO `sys_api` VALUES ('471', '00000000016', '1', '精品线_印刷时长是否超时(修停换)', '58f64fbe9a', 'SELECT a.车号 cart_number,a.工序 proc_name,SUM ( datediff( MINUTE,开始时间,完成时间 ) ) print_length FROM v_cbpc_cartlist a WHERE 车号 in(?) GROUP BY a.车号,a.工序 HAVING SUM (a.产量) > 8000 AND SUM ( datediff( MINUTE,开始时间,完成时间 ) ) > ( CASE WHEN a.工序 LIKE \'凹%\' THEN 90 ELSE 100 END )', 'carts', '', '2019-03-30 15:06:57', '2019-05-10 14:05:08', '0');
INSERT INTO `sys_api` VALUES ('472', '00000000005', '1', '精品线_丝印机台作废超阈值', '0fbc7c9e8f', 'select *  from (SELECT b.cart_number,count(distinct c.convert_sheet_number || sheet_num) fake_num      FROM QA_RECTIFY_MASTER A     INNER JOIN WIP_JOBS b       ON A.JOB_ID = b.JOB_ID      LEFT JOIN QA_INSPECT_MASTER D       ON A.job_id = D.job_id      left join qa_inspect_slave c       on d.inspectm_id = c.inspectm_id     WHERE A.OPERATION_ID = 11      AND D.ITEM_FLAG = 3      and b.cart_number in (?)      and c.image_blob IS NOT NULL group by b.cart_number) a where fake_num > 30', 'cart', '', '2019-03-30 15:21:33', '2019-03-30 16:01:44', '0');
INSERT INTO `sys_api` VALUES ('473', '00000000016', '1', '精品线_昨日完工车号列表', 'e39c6951e8', 'SELECT  车号 FROM v_cbpc_cartlist a WHERE datediff(DAY,完成时间,GETDATE()) = 1 AND a.工序 LIKE \\\'%印%\\\' AND a.工序 <> \\\'印码\\\' and a.品种=\\\'9607T\\\' group by 车号 having sum(a.产量)=10000', '', '', '2019-03-30 15:27:11', '2019-03-30 15:27:11', '0');
INSERT INTO `sys_api` VALUES ('474', '00000000002', '1', '精品线_当天是否已处理数据', 'a2af3bb7c2', 'select id from print_mes_excellent_prodline where convert(varchar,rec_time,112) = convert(varchar,GETDATE(),112)', '', '', '2019-03-30 15:51:54', '2019-04-08 15:46:24', '0');
INSERT INTO `sys_api` VALUES ('475', '00000000002', '1', '精品线_记录当天已处理数据', 'c13d7125af', 'insert into print_mes_excellent_prodline(rec_time,remark ) values (?,?)', 'rec_time,remark', '', '2019-03-30 15:53:27', '2019-04-08 15:53:43', '0');
INSERT INTO `sys_api` VALUES ('476', '00000000002', '1', '精品线_更新凹背标志', '99752f4c09', 'update print_mes_excellent_prodline set intaglio_back= ?,rec_time=convert(varchar,getdate(),120) where cart_number=?', 'intaglio_back,cart_number', '', '2019-03-30 15:54:06', '2019-03-30 15:54:06', '0');
INSERT INTO `sys_api` VALUES ('477', '00000000002', '1', '精品线_更新凹正标志', 'fa76698355', 'update print_mes_excellent_prodline set intaglio_front= ?,rec_time=convert(varchar,getdate(),120) where cart_number=?', 'intaglio_front,cart_number', '', '2019-03-30 15:54:41', '2019-03-30 15:54:41', '0');
INSERT INTO `sys_api` VALUES ('478', '00000000005', '1', '精品线_指定日期丝印作废超阈值', '530f98eb31', 'select *  from (SELECT b.cart_number,       count(distinct c.convert_sheet_number || sheet_num) fake_num      FROM QA_RECTIFY_MASTER A     INNER JOIN WIP_JOBS b       ON A.JOB_ID = b.JOB_ID      LEFT JOIN QA_INSPECT_MASTER D       ON A.job_id = D.job_id      left join qa_inspect_slave c       on d.inspectm_id = c.inspectm_id     WHERE A.OPERATION_ID = 11      AND D.ITEM_FLAG = 3      and to_char(b.update_time,\\\'YYYYMMDD\\\') =?      and c.image_blob IS NOT NULL     group by b.cart_number) a where fake_num > 30', 'tstart', '', '2019-03-30 16:15:51', '2019-03-30 16:15:51', '0');
INSERT INTO `sys_api` VALUES ('481', '00000000016', '1', '图核判废用户关注信息', '77013f03b6', 'SELECT cart_number 车号,remark_type 类型,remark_time 关注时间,remark 备注 FROM v_cbpc_cartcare WHERE CONVERT (  VARCHAR, CAST (remark_time AS datetime), 112 ) BETWEEN ? AND ? order by 1,2', 'tstart,tend', '', '2019-04-02 15:51:50', '2019-04-02 15:51:50', '0');
INSERT INTO `sys_api` VALUES ('482', '00000000021', '1', '凹印离线检测次数统计', 'de5fb83e71', 'SELECT prod_name 品种,machine_name 机台,captain_name 机长,(  CASE  WHEN operator_name IN (  \\\'机台人员\\\', \\\'机台首检\\\'  ) THEN  \\\'机台人员\\\'  ELSE  operator_name  END ) 操作员,COUNT (DISTINCT cart) 大万数,COUNT (1) 检测大张数 FROM [dbo].[view_score_intaglio] WHERE CONVERT (VARCHAR,rec_time,112) between ? and ? and operator_name not in (\\\'测试员\\\') GROUP BY prod_name,machine_name,captain_name,(  CASE  WHEN operator_name IN (  \\\'机台人员\\\', \\\'机台首检\\\'  ) THEN  \\\'机台人员\\\'  ELSE  operator_name  END ) order by 4,1,2', 'tstart,tend', '', '2019-04-04 13:08:06', '2019-04-04 13:08:06', '0');
INSERT INTO `sys_api` VALUES ('483', '00000000021', '1', '胶印离线检测次数统计', '8f4bcd6d0f', 'SELECT prod_name 品种,machine_name 机台,captain_name 机长,(  CASE  WHEN operator_name IN (  \\\'机台人员\\\', \\\'机台首检\\\'  ) THEN  \\\'机台人员\\\'  ELSE  operator_name  END ) 操作员,COUNT (DISTINCT cart) 大万数,COUNT (1) 检测大张数 FROM [dbo].[view_score_offset] WHERE CONVERT (VARCHAR,rec_time,112) between ? and ? and operator_name not in (\\\'测试员\\\') GROUP BY prod_name,machine_name,captain_name,(  CASE  WHEN operator_name IN (  \\\'机台人员\\\', \\\'机台首检\\\'  ) THEN  \\\'机台人员\\\'  ELSE  operator_name  END ) order by 4,1,2', 'tstart,tend', '', '2019-04-04 13:08:40', '2019-04-04 13:08:40', '0');
INSERT INTO `sys_api` VALUES ('484', '00000000016', '1', '精品线_昨日生产产品精品线判定参考数据', 'cb719ac3ea', 'WITH cartlist AS ( SELECT  车号 FROM  v_cbpc_cartlist a WHERE  CONVERT (  VARCHAR, a.[完成时间], 112  ) = CONVERT (  VARCHAR, dateadd(DAY ,- 1,getdate()), 112  ) AND 工序 IN (  \'胶印\', \'丝印\', \'凹一印\', \'凹二印\' ) AND 品种 = \'9607T\' AND 产量 > 0 ),res AS ( SELECT  车号 cart_number, 工序 process, 机台 machine, 机长 captain_name, 产量 product_num, 工艺 proc_name, a.erp_code, datediff(  MINUTE, 开始时间, 完成时间  ) print_length FROM  v_cbpc_cartlist a WHERE  车号 IN (  SELECT   车号  FROM   v_cbpc_cartlist a  WHERE   车号 IN (SELECT * FROM cartlist)  GROUP BY   车号,  工序  HAVING   SUM (产量) = 10000  ) AND CONVERT (  VARCHAR, a.[完成时间], 112 ) = CONVERT (  VARCHAR, dateadd(DAY ,- 1,getdate()), 112 ) AND 工序 IN (  \'胶印\', \'丝印\', \'凹一印\', \'凹二印\' ) AND 产量 > 0 ) SELECT cart_number,proc_name,process,machine,captain_name,SUM (product_num) product_num,SUM (print_length) print_length,a.erp_code,(  CASE  WHEN print_length >= 105  AND process IN (\'胶印\',\'丝印\') THEN  1  WHEN print_length >= 95  AND SUBSTRING (process,1,1) = \'凹\' THEN  1  ELSE  0  END ) all_check,(  CASE  WHEN process = \'胶印\' THEN  1  WHEN process = \'丝印\' THEN  19  WHEN process = \'凹一印\' THEN  20  WHEN process = \'凹二印\' THEN  14  ELSE  0  END ) proc_status,(  CASE  WHEN b.IsRemoveBarrier IS NULL THEN  0  ELSE  b.IsRemoveBarrier  END ) proc_status_before FROM res a LEFT JOIN udt_tb_WipInventory b ON a.cart_number = b.carno GROUP BY cart_number,proc_name,process,machine,captain_name,a.erp_code,print_length,IsRemoveBarrier ORDER BY 1,5', '', '', '2019-04-04 16:59:45', '2019-07-12 08:33:15', '0');
INSERT INTO `sys_api` VALUES ('485', '00000000016', '1', '精品线_测试接口_指定日期精品线判定参考车号列表', '9267fe397f', 'WITH cartlist AS ( SELECT  车号 FROM  v_cbpc_cartlist a WHERE  CONVERT (  VARCHAR, a.[完成时间], 112  ) = ? AND 工序 IN (  \'胶印\', \'丝印\', \'凹一印\', \'凹二印\' ) AND 品种 = \'9607T\' AND 产量 > 0 ),res AS ( SELECT  车号 cart_number, 工序 process, 机台 machine, 机长 captain_name, 产量 product_num, 工艺 proc_name, datediff(  MINUTE, 开始时间, 完成时间  ) print_length FROM  v_cbpc_cartlist a WHERE  车号 IN (  SELECT   车号  FROM   v_cbpc_cartlist a  WHERE   车号 IN (SELECT * FROM cartlist)  GROUP BY   车号,  工序  HAVING   SUM (产量) = 10000  ) AND CONVERT (  VARCHAR, a.[完成时间], 112 ) = ? AND 工序 IN (  \'胶印\', \'丝印\', \'凹一印\', \'凹二印\' ) ) SELECT cart_number,proc_name,process,machine,captain_name,product_num,print_length,(  CASE  WHEN print_length >= 85  AND process IN (\'胶印\',\'丝印\') THEN  1  WHEN print_length >= 75  AND SUBSTRING (process,1,1) = \'凹\' THEN  1  ELSE  0  END ) all_check,(  CASE  WHEN process = \'胶印\' THEN  1  WHEN process = \'丝印\' THEN  2  WHEN process = \'凹一印\' THEN  3  WHEN process = \'凹二印\' THEN  4  END ) proc_status,(  CASE  WHEN b.IsRemoveBarrier IS NULL THEN  0  ELSE  b.IsRemoveBarrier  END ) proc_status_before FROM res a LEFT JOIN udt_tb_WipInventory b ON a.cart_number = b.carno ORDER BY 1,5', 'tstart,tend', '', '2019-04-08 08:17:15', '2019-04-08 08:27:20', '0');
INSERT INTO `sys_api` VALUES ('486', '00000000016', '1', '置精品', '79fe6a898d', 'update udt_tb_wipinventory set isremovebarrier = CurrentPath where carno in (?)', 'carno', '', '2019-04-08 11:38:55', '2019-05-28 10:23:28', '0');
INSERT INTO `sys_api` VALUES ('487', '00000000016', '1', '印刷机台小开作废对比_检封兑换票记录', 'b6758e9a68', 'SELECT  a.工艺,a.品种, b.工序,b.机长,round(avg(小开兑换量),2) 平均小开兑换量,count(*) 大万数 FROM v_cbpc_exchange a INNER JOIN v_cbpc_cartlist b ON a.车号 = b.车号 where (b.工序 like \\\'%印%\\\' or b.工序=\\\'涂布\\\' ) and a.开始日期 BETWEEN ? AND ? group by a.工艺,a.品种, b.工序,b.机长 having count(*)>10 order by 1,2,3,5', 'tstart,tend', '', '2019-04-08 14:51:18', '2019-04-08 14:51:18', '0');
INSERT INTO `sys_api` VALUES ('488', '00000000003', '1', '涂布工序机检检测原始数据', '6fc5fee4bc', 'SELECT a.cart_number 车号,to_char(a.start_date ,\'YYYY-MM-DD hh24:mi:ss\') 生产时间,sum(case  when c.image_blob is not null then  1  else  0  end) 实废数,sum( case when substr(c.route_sheet_number,0,1)=1 then 1 else 0 end) 票面报错总数, sum( case when substr(c.route_sheet_number,0,1)=2 then 1 else 0 end) 涂布报错总数 FROM qfm_wip_jobs A INNER JOIN qfm_qa_inspect_master b ON A.job_id = b.job_id AND to_char(a.start_date,\'YYYYMMDD\') between ? and ? and b.operation_id = 10 INNER JOIN qfm_qa_inspect_slave c ON b.inspectm_id = c.inspectm_id group by cart_number,a.start_date order by 2,1', 'tstart,tend', '', '2019-04-08 15:19:44', '2019-04-08 15:30:59', '0');
INSERT INTO `sys_api` VALUES ('489', '00000000023', '1', '置精品', '729114f286', 'update udt_tb_wipinventory set isremovebarrier =Location_Id where carno in (?)', 'carno', '', '2019-04-08 15:42:40', '2019-05-23 20:14:20', '0');
INSERT INTO `sys_api` VALUES ('490', '00000000002', '1', '精品线_转工艺日志记录', 'c287255727', 'insert into print_wms_autoproc(cart,rec_time,remark ) values ?', 'values', '@desc:批量插入数据时，约定使用二维数组values参数，格式为[{cart,rec_time,remark }]，数组的每一项表示一条数据', '2019-04-08 16:02:43', '2019-04-08 16:02:43', '0');
INSERT INTO `sys_api` VALUES ('491', '00000000002', '1', '提升品报总公司实废条数', '9750ec9c6c', 'SELECT a.车号,b.[工艺],b.[品种],a.[机台],a.[缺陷条数],a.[票面条数] - 透视条数 票面,a.[丝网缺陷数] 丝印,a.[透视条数] + a.[号码条数] + a.[荧光条数] 三合一,b.[实废条数] 票面实废,b.[号码实废],a.[透视条数] 透视,a.[号码条数] 号码,a.[荧光条数] 荧光,a.[未检条数],b.[丝印实废] FROM dbo.view_print_hecha AS a LEFT JOIN view_print_hecha_image_check AS b ON a.车号 = b.车号 WHERE a.生产日期 BETWEEN ? AND ?', 'tstart,tend', '', '2019-04-08 17:21:47', '2019-04-08 17:24:48', '0');
INSERT INTO `sys_api` VALUES ('492', '00000000021', '1', '凹印离线检测明细', '816f7c5482', 'SELECT prod_name 品种,cart_number 车号,machine_name 机台,captain_name 机长,(  CASE  WHEN operator_name IN (  \\\'机台人员\\\', \\\'机台首检\\\'  ) THEN  \\\'机台人员\\\'  ELSE  operator_name  END ) 操作员,COUNT (DISTINCT cart) 大万数,COUNT (1) 检测大张数 FROM [dbo].[view_score_intaglio] WHERE CONVERT (VARCHAR,rec_time,112) BETWEEN ? AND ? AND operator_name NOT IN (\\\'测试员\\\') GROUP BY prod_name,cart_number,machine_name,captain_name,(  CASE  WHEN operator_name IN (  \\\'机台人员\\\', \\\'机台首检\\\'  ) THEN  \\\'机台人员\\\'  ELSE  operator_name  END ) order by 1,3,4,5', 'tstart,tend', '', '2019-04-11 14:15:01', '2019-04-11 14:15:01', '0');
INSERT INTO `sys_api` VALUES ('493', '00000000021', '1', '胶印离线检测明细', '1d6bb2699f', 'SELECT prod_name 品种,cart_number 车号,machine_name 机台,captain_name 机长,(  CASE  WHEN operator_name IN (  \\\'机台人员\\\', \\\'机台首检\\\'  ) THEN  \\\'机台人员\\\'  ELSE  operator_name  END ) 操作员,COUNT (DISTINCT cart) 大万数,COUNT (1) 检测大张数 FROM [dbo].[view_score_offset] WHERE CONVERT (VARCHAR,rec_time,112) BETWEEN ?  AND ? AND operator_name NOT IN (\\\'测试员\\\') GROUP BY prod_name,machine_name,captain_name,cart_number,(  CASE  WHEN operator_name IN (  \\\'机台人员\\\', \\\'机台首检\\\'  ) THEN  \\\'机台人员\\\'  ELSE  operator_name  END ) order by 1,3,4,5', 'tstart,tend', '', '2019-04-11 14:15:42', '2019-04-11 14:15:42', '0');
INSERT INTO `sys_api` VALUES ('494', '00000000016', '1', '胶印产量信息', '71f0b4f57c', 'SELECT 品种,工序,机台,机长,(case max((case when 班次 =\'白班\' then 1 else 2 end)) when 1 then \'白班\' else \'中班\' end)班次,CAST (SUM(产量) AS FLOAT) / 10000 AS 产量,CONVERT ( VARCHAR (10),产量时间,120 ) AS 生产日期,生产记录 FROM v_cbpc_cartlist WHERE ( CONVERT (VARCHAR,产量时间,112) BETWEEN ? AND ? ) AND 工序 LIKE \'胶%\' GROUP BY 品种,工序,班长,机台,机长,生产记录,CONVERT ( VARCHAR (10),产量时间,120 ) having SUM(产量)>0 ORDER BY 1,2,6', 'tstart,tend', '', '2019-04-15 14:20:40', '2019-07-12 19:16:02', '0');
INSERT INTO `sys_api` VALUES ('495', '00000000016', '1', '凹印产量信息', '396c53a4d8', 'SELECT 品种,工序,机台,机长,(case max((case when 班次 =\'白班\' then 1 else 2 end)) when 1 then \'白班\' else \'中班\' end)班次,CAST (SUM(产量) AS FLOAT) / 10000 AS 产量,CONVERT ( VARCHAR (10),产量时间,120 ) AS 生产日期,生产记录 FROM v_cbpc_cartlist WHERE ( CONVERT (VARCHAR,产量时间,112) BETWEEN ? AND ? ) AND 工序 LIKE \'凹%\' GROUP BY 品种,工序,班长,机台,机长,生产记录,CONVERT ( VARCHAR (10),产量时间,120 ) having SUM(产量)>0 ORDER BY 1,2,6', 'tstart,tend', '', '2019-04-15 14:20:54', '2019-07-12 19:16:13', '0');
INSERT INTO `sys_api` VALUES ('496', '00000000016', '1', '裁封自动线产量统计', '41f42c4e47', 'WITH src_list AS ( SELECT  p.Product, b.Equ_Desc, RIGHT (  CONVERT (   VARCHAR (6),  dateadd(   HOUR,  - 3,  CAST (p.EndTime AS datetime)   ),  112  ), 2  ) AS month_name, p.ComQuantity AS ComQuantity, (  CASE  WHEN p.TestPlanId = 1  AND p.ProductionLine = 28 THEN   p.ComQuantity  ELSE   NULL  END  ) AS QuanJian_ComQuantity FROM  dbo.udt_pp_MachineProcess AS p INNER JOIN v_EquipmentType_Equ b ON p.equipment = b.equ_id WHERE  ERPCode = \\\'1008\\\' AND p.Equipment IN (  SELECT  equ_id  FROM  v_EquipmentType_Equ AS e  WHERE  EquType_Code IN (   \\\'54043048006\\\',  \\\'54043041111\\\'  ) ) AND CONVERT (  VARCHAR (6), dateadd(  HOUR, - 3, CAST (p.EndTime AS datetime)  ), 112 ) BETWEEN ? AND ? ),vars_Month_tj AS ( SELECT  t.Product, t.Equ_Desc, t.month_name, SUM (  ISNULL(   CAST (t.ComQuantity AS FLOAT),  0  )  ) AS ComQuantity, SUM (  ISNULL(   CAST (   t.QuanJian_ComQuantity AS FLOAT   ),  0  )  ) AS QuanJian_ComQuantity FROM  src_list t GROUP BY  t.Product, t.Equ_Desc, t.MONTH_name ) SELECT a.month_name 月份,SUBSTRING (  a.equ_desc, PATINDEX(\\\'%型%\\\',a.equ_desc) + 1, len(a.equ_desc) ) 机台,LEFT (pr.Des,5) AS 品种,a.comQuantity 码后产量,a.quanjian_ComQuantity 全检产量 FROM vars_Month_tj a LEFT JOIN vb_Product pr ON pr.id = a.product ORDER BY 1,2,3', 'tstart,tend', '', '2019-04-16 16:49:38', '2019-04-16 16:49:38', '0');
INSERT INTO `sys_api` VALUES ('497', '00000000004', '1', '近期热门', '310429690d', 'SELECT TOP 5 a.id,( CASE WHEN a.状态 = \'未关闭\' THEN 0 ELSE 1 END ) status,( CASE WHEN 工序 = \'其它\' THEN \'\' ELSE \'【\' + 工序 + \'】\' END ) + a.标题 title,发起人 AS \'user\',记录时间 AS datetime,set_avatar avatar,avatarkey,阅读数 readnum,已阅人员 readers FROM (select top 30 * from view_article a order by id desc) a WHERE sys_id =? and isnull(is_hide,0)=0 order BY readnum desc', 'sys_id', '', '2019-04-18 15:36:48', '2019-08-02 10:25:18', '0');
INSERT INTO `sys_api` VALUES ('498', '00000000004', '1', '最新文章', 'c7b69d12ea', 'SELECT TOP 5 a.id,(  CASE  WHEN a.状态 = \\\'未关闭\\\' THEN  0  ELSE  1  END ) status,(  CASE  WHEN 工序 = \\\'其它\\\' THEN  \\\'\\\'  ELSE  \\\'【\\\' + 工序 + \\\'】\\\'  END ) + a.标题 title,发起人 AS \\\'user\\\',记录时间 AS datetime,set_avatar avatar,avatarkey,阅读数 readnum,已阅人员 readers FROM view_article a WHERE sys_id = ? ORDER BY id DESC', 'sys_id', '', '2019-04-18 16:14:23', '2019-04-18 16:14:23', '0');
INSERT INTO `sys_api` VALUES ('499', '00000000004', '1', '获取质量问题反馈文件ID', '21105b5f1a', 'SELECT max(notice_id)+1 notice_id FROM tbl_article where cate_id=2 and convert(varchar(4),rec_time,112) = convert(varchar(4),getdate(),112)', '', '', '2019-04-18 17:20:01', '2019-06-13 17:45:02', '0');
INSERT INTO `sys_api` VALUES ('500', '00000000002', '1', '印码机检实时数据', 'f98ac39f1f', 'SELECT rtrim(a.车号) cart_number,rtrim(a.机台) machine_name,a.品种 prod_name,a.印刷总数 print_num,a.缺陷总数 fake_num,a.票面条数 pm_num,a.透视条数 ts_num,a.号码条数 code_num,a.荧光条数 yg_num,a.未检数 no_check,a.大张废 piece_fake,a.好品率 good_rate,a.D盘可用 disk_free_d,a.D盘容量 disl_vol_d,a.显示站DB vs_db, a.上传大万数 upload_cart_num,a.印刷大万数 print_cart_num,a.开位1 k_info_1,a.缺陷数1 fake_num_1,a.开位2 k_info_2,a.缺陷数2 fake_num_2,a.开位3 k_info_3,a.缺陷数3 fake_info_3,CONVERT (VARCHAR,a.上传时间,120) AS update_time,a.图像1 image_1,a.图像2 image_2,a.图像3 image_3 FROM dbo.view_print_online_quality AS a WHERE CONVERT (  VARCHAR (11), a.上传时间, 120 ) = CONVERT (VARCHAR(11),getdate(),120)', '', '', '2019-04-19 20:01:21', '2019-04-19 20:04:40', '0');
INSERT INTO `sys_api` VALUES ('501', '00000000002', '1', '实时监测-近期未检情况', 'ff0feed532', 'SELECT TOP 10 a.ProduceDate,SUM (NoCheckCount) AS num FROM MaHouData a INNER JOIN ( SELECT  MachineID FROM  onlineinfo WHERE  CartNumber = ? ) b ON a.MachineID = b.MachineID AND a.ProduceDate <= CONVERT (VARCHAR,GETDATE(),112) GROUP BY a.ProduceDate ORDER BY a.ProduceDate DESC', 'cart', '', '2019-04-19 20:08:40', '2019-04-19 20:08:40', '0');
INSERT INTO `sys_api` VALUES ('502', '00000000002', '1', '实时监测-同一工作日生产其它产品', 'b4c5a73656', 'SELECT distinct a.id,a.CartNumber,GoodRate,FormatPos1,ErrCount1,ImgVerify1 FROM MaHouData a INNER JOIN ( SELECT MachineID FROM OnlineInfo WHERE CartNumber = ? ) b ON a.MachineID = b.MachineID AND a.ProduceDate = convert(varchar,GETDATE(),112) ORDER BY a.id', 'cart', '', '2019-04-19 20:10:52', '2019-04-19 20:11:59', '0');
INSERT INTO `sys_api` VALUES ('503', '00000000012', '1', '码后缺陷图像查询', 'a8dd1e5c75', 'SELECT ErrImage1 image1,ErrImage2 image2,ErrImage3 image3 FROM ImageData where MahouID=?', 'mahou_id', '', '2019-04-19 20:13:37', '2019-04-19 20:13:37', '0');
INSERT INTO `sys_api` VALUES ('504', '00000000002', '1', '轴号信息追溯_机检信息查询', 'c9e662a163', 'SELECT a.[轴号],convert(varchar,a.[开始时间],120) 开始时间,convert(varchar,a.[结束时间],120) 结束时间,a.[产品名称],a.[机台],a.[机型],a.[班组],a.[纸张总数],a.[好纸总数],a.[好品率],a.[一般废张数],a.[严重废张数],a.[错误纸张总数],a.[落仓反馈总数] FROM dbo.view_paper_quality AS a where 轴号 like ? order by 2', 'reel', '', '2019-04-19 20:27:17', '2019-04-19 20:27:17', '0');
INSERT INTO `sys_api` VALUES ('505', '00000000002', '1', '轴号信息追溯__物理站', '2daa2d7d79', 'with reelInfo as ( select ? reel) SELECT TOP 1 a.[轴号],a.[机台],a.[检测日期],a.[得分],a.[合格],a.[备注],a.[检测人员],a.[品种],a.[班次],a.[温度],a.[湿度],a.[定量],a.[厚度],a.[横幅厚度差],a.[拉力湿],a.[平均裂断长],a.[湿强度],a.[平均耐折度],a.[白度],a.[不透明度],a.[水分],a.[水分差],a.[尘埃个数],a.[湿变形纵],a.[湿变形横],a.[挺度纵],a.[挺度横],a.[纵向撕裂度],a.[透气度],a.[揉后透气度正],a.[揉后透气度反],a.[干耐揉],a.TZ12,a.TZ2,a.L,a.a,a.b,a.[干拉力纵],a.[干拉力横],a.[湿拉力纵],a.[湿拉力横],a.[正背面色差],a.[平滑度正],a.[平滑度反],a.[粗糙度正],a.[粗糙度背],a.[横向撕裂度],a.[小轴] FROM dbo.view_paper_psc AS a WHERE 轴号 <= (select * from reelInfo) AND SUBSTRING (轴号,2,1) = SUBSTRING ((select cast(reel as varchar) reel from reelInfo),2,1) ORDER BY 轴号 DESC', 'reel', '', '2019-04-19 20:38:17', '2019-04-19 20:39:45', '0');
INSERT INTO `sys_api` VALUES ('506', '00000000002', '1', '轴号追溯_物理外观', '3949376b46', 'WITH reelInfo AS (SELECT cast(? as varchar) reel) SELECT TOP 1 a.[轴号],a.[品种],a.[得分],a.[记录人],a.[记录日期],a.[纸张匀度],a.[纸面整洁度],a.[水印位置偏差],a.[白水印位置偏差],a.[尺寸],a.[方正度],a.[水印],a.[白水印],a.[水印清晰度],a.[白水印清晰度],a.[水印一致性],a.[白水印一致性],a.[白水印偏斜],a.[开窗尺寸偏差],a.[安全线露线],a.[细线],a.[残缺],a.[防伪层脱落],a.[全埋线拉伸],a.[开窗线位置],a.[小开版式],a.[纸张完好度],a.[其它] FROM dbo.view_paper_surface AS a WHERE 轴号 <= (SELECT * FROM reelInfo) AND SUBSTRING (轴号,2,1) = SUBSTRING ( (  SELECT  *  FROM  reelInfo ),2,1 ) ORDER BY 轴号 DESC', 'reel', '', '2019-04-19 20:42:08', '2019-04-19 20:42:08', '0');
INSERT INTO `sys_api` VALUES ('507', '00000000002', '1', '轴号追溯_非常规', '6575fb1d28', 'WITH reelInfo AS (SELECT cast(? as varchar) reel) SELECT TOP 1 a.轴号,a.品种,a.机台,a.日期,a.检验员,a.室内温度,a.相对湿度,a.主管,a.备注,a.表面吸油性正,a.表面吸油性反,a.吸水性正,a.吸水性反,a.表面强度正,a.表面强度反,a.油渗性正,a.油渗性正等级,a.油渗性反,a.油渗性反等级,a.得分 FROM dbo.view_paper_para_abnormal AS a WHERE 轴号 <= (SELECT * FROM reelInfo) AND SUBSTRING (轴号,2,1) = SUBSTRING ( (  SELECT  *  FROM  reelInfo ),2,1 ) ORDER BY 轴号 DESC', 'reel', '', '2019-04-19 20:44:01', '2019-04-19 20:44:01', '0');
INSERT INTO `sys_api` VALUES ('508', '00000000002', '1', '轴号追溯_人工校验', '99b1cd2c29', 'SELECT a.[轴号],a.[机台],a.[品种],a.[记录人],a.[记录日期],a.[封包重量],a.[裁切重量],a.[严重废],a.[大错],a.[中错],a.[小错],a.[轴头轴尾],a.[怀疑纸],a.[全好品],a.[其它],a.[是否放行] FROM dbo.view_paper_validate AS a WHERE a.轴号 LIKE ?', 'reel', '', '2019-04-19 20:45:36', '2019-04-19 20:47:10', '0');
INSERT INTO `sys_api` VALUES ('509', '00000000002', '1', '轴号追溯_机检在线抽查记录', '270920daeb', 'SELECT a.ID,c.ProductName 品种,b.Machine_Name 机台,a.reel_code 轴号,a.package_weight 封包重量,a.cut_weight 裁切重量,CONVERT (VARCHAR,a.record_Time,120) AS 记录时间 FROM dbo.Paper_Validate AS a INNER JOIN dbo.Paper_Machine_Info AS b ON b.Machine_ID = a.machine_id INNER JOIN dbo.Paper_ProductData AS c ON c.ProductID = a.prod_id WHERE a.reel_code like ? ORDER BY 7', 'reel', '', '2019-04-19 20:49:43', '2019-05-04 18:42:20', '0');
INSERT INTO `sys_api` VALUES ('510', '00000000002', '1', '轴号追溯_切纸机生产原始记录', 'e74f253d29', 'SELECT a.[轴号],a.[机台],a.[品种],CONVERT (  VARCHAR, a.[生产时间], 120 ) 生产时间,a.[生产日期],a.[纸轴抄重],a.[封包令数],a.[抽检令数],a.[_69转数封令数],a.[_49令数],a.[轴头尾令数],a.[怀疑仓总数],a.[废纸仓总数],a.[班组],a.[班次],a.[导边],a.[质检],a.[纸斗],a.[查纸],a.[数数],a.[封包],a.[机长],a.[备注] FROM dbo.view_paper_cutwaste AS a WHERE a.[轴号] LIKE ?', 'reel', '', '2019-04-19 20:55:33', '2019-04-19 20:55:33', '0');
INSERT INTO `sys_api` VALUES ('511', '00000000002', '1', '年度物化耐性校验记录', '2082bb242c', 'SELECT a.[冠字],a.[品种],a.[检测日期],a.[备注],a.[耐干皱折正],a.[耐干皱折背],a.[耐干皱折OVMI],a.[抗剥离等级],a.[耐机洗正],a.[耐机洗背],a.[记录时间] FROM dbo.view_print_endurance AS a where left(检测日期,4)=? order by 11', 'tstart', '', '2019-04-19 20:59:29', '2019-04-19 21:00:08', '0');
INSERT INTO `sys_api` VALUES ('512', '00000000017', '1', '立体库出库任务执行时长统计', '2b1a1180f8', 'select datediff(SECOND,b.bgndate,b.ENDDATE)/30 \"30秒\",count(*) 次数 from TWMS_TRANSFERLOGG b where convert(varchar,b.enddate,112) between ? and ? group by datediff(SECOND,b.bgndate,b.ENDDATE)/30 having count(*)>5 order by 1', 'tstart,tend', '', '2019-05-14 17:50:04', '2019-05-14 17:51:53', '0');
INSERT INTO `sys_api` VALUES ('513', '00000000017', '1', '库管系统任务执行情况', '2678b041c7', 'SELECT DISTINCT r.EXTATTR2 event_id,r.EXTATTR11 \\\'车号\\\',r.EXTATTR9 \\\'品种\\\',r.EXTATTR10 \\\'工序\\\',r.EXTATTR25 \\\'工艺\\\',r.EXTATTR21 \\\'验证\\\',r.EXTATTR36 \\\'数量\\\',(  CASE b.STATUS  WHEN \\\'Over\\\' THEN  \\\'待收货\\\'  WHEN \\\'Doing\\\' THEN  \\\'发货中\\\'  ELSE  \\\'已领取\\\'  END ) result,r.enterdate \\\'申请时间\\\',r.EXTATTR34 \\\'执行时间\\\', dateadd(SECOND,165,r.extattr34) \\\'预计完成\\\',b.ENDDATE \\\'完成时间\\\',round(cast(datediff(SECOND,b.bgndate,b.ENDDATE) as float)/60,2) \\\'执行时长(分钟)\\\',round(cast(datediff(SECOND,r.enterdate,b.ENDDATE) as float)/60,2) \\\'总时长(分钟)\\\',165-datediff(SECOND,b.bgndate,b.ENDDATE) \\\'预测误差(秒)\\\',(  CASE  WHEN r.status = \\\'New\\\' THEN  \\\'新增\\\'  WHEN r.status = \\\'Allot\\\' THEN  \\\'执行中\\\'  ELSE  \\\'已领取\\\'  END ) status,r.EXTATTR5 uid,c.NAME username,r.EXTATTR6 \\\'申请组织\\\',r.EXTATTR7 \\\'楼层\\\',r.EXTATTR8 \\\'库区\\\',SUBSTRING (r.EXTATTR30,9,1) \\\'库门\\\' FROM WMS_RSS_REQUEST r LEFT JOIN TWMS_PLTITEM a ON a.EXTATTR1 = r.requestId LEFT JOIN TWMS_TRANSFERLOGG b ON b.VPLTNUM = a.VPLTNUM LEFT JOIN WMS_RSS_USER c ON r.EXTATTR5 = c.PSN_NO WHERE r.reponsetype = \\\'OutStockRequest\\\' AND r.status IN (\\\'New\\\',\\\'Allot\\\') AND EXTATTR34 < b.ENDDATE or r.extattr2 in (528230,528242)', '', '', '2019-05-14 18:02:46', '2019-05-14 18:02:46', '0');
INSERT INTO `sys_api` VALUES ('514', '00000000017', '1', '立体库执行任务列表', '1cc2fd77cb', 'SELECT event_id,车号,品种,工序,机台,申请人,申请人ID,机台卡号,工艺,right(convert(varchar,预计完成,120),8) 预计完成,( CASE WHEN status = \'排队中\' THEN status ELSE result END ) status,right(convert(varchar,申请时间,120),8) 申请时间,right(convert(varchar,任务开始,120),8) 任务开始,right(convert(varchar,实际完成,120),8) 实际完成,楼层,库区+\'-\'+库门 库门 FROM v_cbpc_rss_request a', '', '', '2019-05-15 16:34:27', '2019-06-21 14:20:16', '0');
INSERT INTO `sys_api` VALUES ('515', '00000000002', '1', '年度票面开包量', 'b8811b83b3', 'SELECT LEFT (a.[生产日期],6) 月份,round( AVG (CAST(a.开包量 AS FLOAT)),2 ) 票面开包量 FROM view_print_hecha_image_check a WHERE a.[生产日期] BETWEEN ? AND ? AND 品种 =? AND (a.mahouid > 0) GROUP BY LEFT (a.[生产日期],6)', 'tstart,tend,prod', '', '2019-05-16 13:35:34', '2019-06-17 10:30:35', '0');
INSERT INTO `sys_api` VALUES ('516', '00000000002', '1', '丝印增加开包量', 'cd13775868', 'SELECT LEFT (a.[生产日期],6) 月份,round( AVG ( CAST ( a.丝印增加开包量 AS FLOAT ) ),2 ) 丝印增加开包量 FROM view_print_hecha_image_check a WHERE a.[生产日期] BETWEEN ? AND ? AND 丝印后实废 <> \'未同步\' AND 品种 = ? AND (a.mahouid > 0) GROUP BY LEFT (a.[生产日期],6)', 'tstart,tend,prod', '', '2019-05-16 13:42:36', '2019-05-25 14:06:15', '0');
INSERT INTO `sys_api` VALUES ('517', '00000000002', '1', '丝印开包量', '697f8acdca', 'SELECT LEFT (a.[生产日期],6) 月份,round( AVG ( CAST ( a.丝印开包量 AS FLOAT ) ),2 ) 丝印开包量 FROM view_print_hecha_image_check a WHERE a.[生产日期] BETWEEN ? AND ? AND 丝印后实废 <> \'未同步\' AND 品种 = ? AND (a.mahouid > 0) GROUP BY LEFT (a.[生产日期],6)', 'tstart,tend,prod', '', '2019-05-16 14:37:26', '2019-05-25 14:06:02', '0');
INSERT INTO `sys_api` VALUES ('518', '00000000002', '1', '年度开包量汇总', '4e11faa491', 'SELECT CONVERT (VARCHAR(6),b.采集时间,112) 月份,avg(开包量) 开包量 FROM VIEW_PRINT_OCR b where CONVERT (VARCHAR,b.采集时间,112) BETWEEN ? AND ? AND b.开包量 >0 AND b.[工艺] = \'码后核查\' and 品种=? GROUP BY CONVERT (VARCHAR(6),b.采集时间,112) order by 1', 'tstart,tend,prod', '', '2019-05-16 15:42:57', '2019-10-11 15:06:37', '0');
INSERT INTO `sys_api` VALUES ('519', '00000000001', '1', '工序小开作废类型变化情况', '5661e9dd77', 'SELECT a.type 作废类型,a.month_name 月份,a.value 作废数,a.proc_name 工序 FROM tbl_sample_fake_type a where month_name between ? and ? and prod_name=? order by 2,3', 'tstart,tend,prod', '', '2019-05-16 18:43:11', '2019-10-15 16:00:57', '0');
INSERT INTO `sys_api` VALUES ('520', '00000000001', '1', '各工序累计小开作废曲线图', '6ad416a583', 'SELECT a.proc_name 工序,a.month_name 月份,sum(a.VALUE) 作废数 FROM tbl_sample_fake_type a WHERE month_name between ? and ? and prod_name = ? group by a.proc_name ,a.month_name order by 2,1', 'tstart,tend,prod', '', '2019-05-16 19:01:47', '2019-05-25 15:29:18', '0');
INSERT INTO `sys_api` VALUES ('521', '00000000001', '1', '各工序累计作废率(单位：‰)', '0a34b3166e', 'SELECT month_name 月份,prod_name 品种,proc_name 工序,round(fake_num / package_num,3) 累计作废率 FROM ( SELECT a.month_name,a.prod_name,b.proc_name,sum(a.package_num * b.fake_rate) fake_num,a.package_num,(  CASE  WHEN proc_name = \'胶印\' THEN  0.5  WHEN proc_name = \'胶背\' THEN  1  WHEN proc_name = \'胶正\' THEN  2  WHEN proc_name = \'丝印\' THEN  2  WHEN proc_name = \'凹背\' THEN  3  WHEN proc_name = \'凹正\' THEN  4  WHEN proc_name = \'印码\' THEN  5  WHEN proc_name = \'裁切\' THEN  6  WHEN proc_name = \'检封其他\' THEN  7  WHEN proc_name = \'其他\' THEN  8  WHEN proc_name = \'白纸\' THEN  9  WHEN proc_name = \'数管\' THEN  10  ELSE  11  END ) order_idx FROM tbl_sample_fake_package AS a INNER JOIN tbl_sample_fake_rate AS b ON a.prod_name = b.prod_name AND a.month_name = b.month_name GROUP BY  month_name,a.prod_name,b.proc_name ) a WHERE month_name between ? and ? and a.prod_name =? ORDER BY 1,order_idx', 'tstart,tend,prod', '', '2019-05-16 19:10:42', '2019-05-25 15:30:53', '0');
INSERT INTO `sys_api` VALUES ('522', '00000000001', '1', '各工序小开作废率', 'b0053a065b', 'SELECT a.proc_name 工序,a.month_name 月份,sum(a. VALUE) / b.package_num 小开作废率 FROM tbl_sample_fake_type a LEFT JOIN tbl_sample_fake_package b ON a.month_name = b.month_name AND a.prod_name = b.prod_name WHERE  a.month_name between ? and ? and a.prod_name = ? GROUP BY a.proc_name,a.month_name ORDER BY 2,1', 'tstart,tend,prod', '', '2019-05-16 19:19:55', '2019-05-25 15:30:28', '0');
INSERT INTO `sys_api` VALUES ('523', '00000000016', '1', '检封平均小开兑换量', '77ce9dd52d', 'WITH change_log AS ( SELECT  replace(pb.Prod_Type_Desc,\'品\',\'\') prodname, CONVERT (  VARCHAR (6), CAST (a.exchangetime AS DATE), 112  ) month_name, a.CarNumber AS cart_number, SUM (CAST(a.Quantity AS INT)) exchange_quantity FROM  udt_ps_Exchange a LEFT JOIN v_Prod_BaseInfo pb ON pb.Prod_Id = a.Prod_Id WHERE  a.unit = 51082 AND CONVERT (  VARCHAR, CAST (a.ExchangeTime AS datetime), 112 ) BETWEEN ?  AND ?  GROUP BY  replace(pb.Prod_Type_Desc,\'品\',\'\'), pb.Prod_Type_Desc, a.CarNumber, CONVERT (  VARCHAR (6), CAST (a.exchangetime AS DATE), 112  ) ),change_record AS ( SELECT DISTINCT  b.* FROM  change_log b LEFT JOIN dbo.udt_pp_MachineProcess a ON b.cart_number = a.CarNumber LEFT JOIN udt_tb_WipInventory wipInv ON wipInv.WI_Id = a.BusinessWiid WHERE  CrownWordStartNum IS NOT NULL AND wipInv.ProcessLine_Desc = \'码后核查工艺\' ) SELECT prodname 品种,month_name 月份,AVG (exchange_quantity) 平均兑换量 FROM change_record GROUP BY month_name,prodname', 'tstart,tend', '', '2019-05-16 19:29:59', '2019-08-29 16:17:36', '0');
INSERT INTO `sys_api` VALUES ('524', '00000000016', '1', '9607T品码后及全检产量占比变化情况', '55d8d53922', 'SELECT 工艺,month_name 月份,COUNT (*) 产量 FROM (  SELECT DISTINCT  车号, 工艺, CONVERT (   VARCHAR (6),  开始时间,  112  ) month_name  FROM  v_cbpc_cartlist  WHERE  CONVERT (VARCHAR,[开始时间],112) BETWEEN  ?  AND ?  AND 工序 LIKE \'%裁%\'  AND 工艺 IN (\'码后核查\',\'全检品\') and 品种=\'9607T\' ) a GROUP BY 工艺,month_name', 'tstart,tend', '', '2019-05-16 19:41:21', '2019-05-20 09:29:43', '0');
INSERT INTO `sys_api` VALUES ('525', '00000000002', '1', 'OCR质量原始数据', '907e52208b', 'select distinct a.[车号],a.[品种],a.机台,a.机长,a.生产日期,a.工艺,convert(varchar,a.[采集时间],120) as 采集时间,a.[小开总数],a.[已取出],a.[多取出],a.[开包量],a.[机检开包量] from view_print_ocr a where convert(varchar,a.[采集时间],112) between ? and ?', 'tstart,tend', '', '2019-05-16 19:52:15', '2019-05-20 08:59:48', '0');
INSERT INTO `sys_api` VALUES ('526', '00000000003', '1', '指定车号实废原因分析', 'f5ffd925ef', 'with cart_list as (select cart_number from qfm_wip_jobs where cart_number in (?)),fake_info as (SELECT substr(c.ROUTE_SHEET_NUMBER,0,2) camera,c.CONVERT_SHEET_NUMBER position,c.error_site macro_id,count(*) err_num FROM qfm_wip_jobs A INNER JOIN qfm_qa_inspect_master b ON A.job_id = b.job_id AND A.cart_number in (select * from cart_list) INNER JOIN qfm_qa_inspect_slave c ON b.inspectm_id = c.inspectm_id and c.image_blob IS NOT NULL group by substr(c.ROUTE_SHEET_NUMBER,0,2),c.error_site,c.CONVERT_SHEET_NUMBER having count(*) > (select count(*) from cart_list)),fake_images as (SELECT a.cart_number,substr(c.ROUTE_SHEET_NUMBER,0,2) camera,c.CONVERT_SHEET_NUMBER position,c.error_site macro_id,c.image_blob FROM qfm_wip_jobs A INNER JOIN qfm_qa_inspect_master b ON A.job_id = b.job_id AND A.cart_number in (select * from cart_list) INNER JOIN qfm_qa_inspect_slave c ON b.inspectm_id = c.inspectm_id and c.image_blob IS NOT NULL),fake_image_list as (select * from( select row_number()over(partition by camera,position,macro_id order by dbms_random.value()) rn,a.* from fake_images a ) where rn<=4) select b.cart_number \"车号\",(case a.camera  when \'10\' then  \'正面\'  when \'14\' then  \'背面\'  when \'13\' then  \'透视\'  when \'15\' then  \'OVMI\'  else  \'其它\' || a.camera end) \"检测区域\",\'m_\' || a.macro_id \"宏区id\",a.position ||\'k\' \"开位\",a.err_num \"缺陷条数\",b.image_blob \"缺陷图像\" from fake_info a inner join fake_image_list b on a.camera = b.camera and a.position = b.position and a.macro_id = b.macro_id order by 5 desc', 'carts', '', '2019-05-16 20:27:09', '2019-05-17 13:37:54', '0');
INSERT INTO `sys_api` VALUES ('527', '00000000003', '1', '指定车号实废原因分析', '3dc3d3d2da', 'with cart_list as (select cart_number  from qfm_wip_jobs where cart_number in (?)),fake_info as (SELECT substr(c.ROUTE_SHEET_NUMBER,0,2) camera,  c.error_site macro_id, count(*) err_num  FROM qfm_wip_jobs A INNER JOIN qfm_qa_inspect_master b  ON A.job_id = b.job_id  AND A.cart_number in (select * from cart_list) INNER JOIN qfm_qa_inspect_slave c  ON b.inspectm_id = c.inspectm_id  and c.image_blob IS NOT NULL group by substr(c.ROUTE_SHEET_NUMBER,0,2),  c.error_site having count(*) > (select count(*) from cart_list)),fake_images as (SELECT a.cart_number, substr(c.ROUTE_SHEET_NUMBER,0,2) camera,  c.error_site macro_id, c.image_blob  FROM qfm_wip_jobs A INNER JOIN qfm_qa_inspect_master b  ON A.job_id = b.job_id  AND A.cart_number in (select * from cart_list) INNER JOIN qfm_qa_inspect_slave c  ON b.inspectm_id = c.inspectm_id  and c.image_blob IS NOT NULL),fake_image_list as (select *  from (select row_number() over(partition by camera,macro_id order by dbms_random.value()) rn,   a.*    from fake_images a) where rn <=4) select b.cart_number \"车号\", (case a.camera   when \'10\' then   \'正面\'   when \'14\' then   \'背面\'   when \'13\' then   \'透视\'   when \'15\' then   \'OVMI\'   else   \'其它\' || a.camera  end) \"检测区域\", \'m_\' || a.macro_id \"宏区id\", a.err_num \"缺陷条数\", b.image_blob \"缺陷图像\" from fake_info a inner join fake_image_list b  on a.camera = b.camera  and a.macro_id = b.macro_id order by 4 desc', 'carts', '', '2019-05-17 09:55:45', '2019-05-17 13:38:05', '0');
INSERT INTO `sys_api` VALUES ('528', '00000000003', '1', '指定车号按宏区开包量汇总', '008ef401e0', 'with cart_list as (select cart_number from qfm_wip_jobs where cart_number in (?)),fake_info as (select camera,macro_id,sum(nums) open_num from ( select convert_sheet_number position,kilo_num,macro_id,camera,count(1) nums from (SELECT distinct a.cart_number,c.convert_sheet_number,substr(sheet_num,7,1) kilo_num,error_site macro_id,substr(c.ROUTE_SHEET_NUMBER,0,2) camera  FROM qfm_wip_jobs A INNER JOIN qfm_qa_inspect_master b  ON A.job_id = b.job_id  AND A.cart_number in (select * from cart_list) INNER JOIN qfm_qa_inspect_slave c  ON b.inspectm_id = c.inspectm_id  and c.image_blob IS NOT NULL  ) a group by convert_sheet_number,kilo_num,macro_id,camera) a group by camera,macro_id ),fake_images as (SELECT a.cart_number, substr(c.ROUTE_SHEET_NUMBER,0,2) camera, c.error_site macro_id, c.image_blob  FROM qfm_wip_jobs A INNER JOIN qfm_qa_inspect_master b  ON A.job_id = b.job_id  AND A.cart_number in (select * from cart_list) INNER JOIN qfm_qa_inspect_slave c  ON b.inspectm_id = c.inspectm_id  and c.image_blob IS NOT NULL),fake_image_list as (select *  from (select row_number() over(partition by camera,macro_id order by dbms_random.value()) rn,   a.*    from fake_images a) where rn <=4) select b.cart_number \"车号\", (case a.camera   when \'10\' then   \'正面\'   when \'14\' then   \'背面\'   when \'13\' then   \'透视\'   when \'15\' then   \'OVMI\'   else   \'其它\' || a.camera  end) \"检测区域\", \'m_\' || a.macro_id \"宏区id\", a.open_num \"开包量\", b.image_blob \"缺陷图像\" from fake_info a inner join fake_image_list b  on a.camera = b.camera and a.macro_id = b.macro_id order by 4 desc', 'carts', '', '2019-05-17 10:30:45', '2019-05-17 13:38:17', '0');
INSERT INTO `sys_api` VALUES ('529', '00000000003', '1', '批量车号开包量主要原因构成', '5cfc19aa38', 'with cart_list as (select cart_number from qfm_wip_jobs where cart_number in (?)),fake_info as (select camera,macro_id,sum(nums) open_num from (  select convert_sheet_number position,kilo_num,macro_id,camera,count(1) nums from (SELECT distinct a.cart_number,c.convert_sheet_number,substr(sheet_num,7,1) kilo_num,error_site macro_id,substr(c.ROUTE_SHEET_NUMBER,0,2) camera   FROM qfm_wip_jobs A  INNER JOIN qfm_qa_inspect_master b    ON A.job_id = b.job_id   AND A.cart_number in (select * from cart_list)  INNER JOIN qfm_qa_inspect_slave c    ON b.inspectm_id = c.inspectm_id   and c.image_blob IS NOT NULL   ) a group by convert_sheet_number,kilo_num,macro_id,camera) a group by camera,macro_id  having sum(nums) > (select count(*) from cart_list))    select     (case a.camera     when \'10\' then      \'正面\'     when \'14\' then      \'背面\'     when \'13\' then      \'透视\'     when \'15\' then      \'OVMI\'     else      \'其它\' || a.camera    end) || \'宏区_\' || a.macro_id \"缺陷区域\",   a.open_num \"开包量\" from fake_info a order by 2 desc', 'carts', '', '2019-05-17 10:38:25', '2019-05-17 10:44:53', '0');
INSERT INTO `sys_api` VALUES ('530', '00000000003', '1', '批量车号实废缺陷主要原因构成', '73e5b93f60', 'with cart_list as (select cart_number  from qfm_wip_jobs where cart_number in (?)),fake_info as (SELECT substr(c.ROUTE_SHEET_NUMBER,0,2) camera,  c.error_site macro_id, count(*) err_num  FROM qfm_wip_jobs A INNER JOIN qfm_qa_inspect_master b  ON A.job_id = b.job_id  AND A.cart_number in (select * from cart_list) INNER JOIN qfm_qa_inspect_slave c  ON b.inspectm_id = c.inspectm_id  and c.image_blob IS NOT NULL group by substr(c.ROUTE_SHEET_NUMBER,0,2),  c.error_site) select (case a.camera   when \'10\' then   \'正面\'   when \'14\' then   \'背面\'   when \'13\' then   \'透视\'   when \'15\' then   \'OVMI\'   else   \'其它\' || a.camera  end) || \'宏区_\' || a.macro_id \"缺陷区域\", a.err_num \"缺陷条数\" from fake_info a order by 2 desc', 'carts', '', '2019-05-17 13:24:30', '2019-05-17 13:39:00', '0');
INSERT INTO `sys_api` VALUES ('531', '00000000016', '1', '批量车号生产信息汇总', 'efa69aab8a', 'SELECT 工序 ,机台,机长 ,COUNT (*) 大万数 FROM ( SELECT a.CarNumber AS [车号],(  CASE  WHEN m.pu_desc LIKE \'人工大张班%\' THEN  \'人工拉号\'  WHEN b.Path_Desc = \'干胶印\' THEN  \'胶印\'  WHEN b.Path_Desc = \'凹一印\'  AND SUBSTRING (  pa.Prod_Desc,PATINDEX(\'%[.]%\',pa.Prod_Desc) + 1,5  ) = \'9602A\' THEN  \'凹印\'  WHEN b.Path_Desc = \'丝凸印丝印\' THEN  \'丝印\'  WHEN b.Path_Desc = \'印后涂布\' THEN  \'涂布\'  WHEN b.Path_Desc = \'裁封自动线\' THEN  \'裁封\'  WHEN b.Path_Desc = \'印码\'  AND (  (  charindex(\'XCJ\',m.PU_Desc) > 0  OR charindex(\'XZJ\',m.PU_Desc) > 0  )  OR m.PU_Desc LIKE \'%清分机%\'  ) THEN  \'抽查\'  WHEN b.Path_Desc = \'小张清分机全检\'  OR SUBSTRING (  m.pu_desc,0,PATINDEX(\'%型%\',m.PU_Desc)  ) = \'bps2000\' THEN  \'抽查\'  ELSE  b.Path_Desc  END ) AS [工序],(  CASE  WHEN n.pu_desc_alias IS NULL THEN  (  CASE  WHEN len(m.PU_Desc) - PATINDEX(\'%型%\',m.PU_Desc) > 5 THEN  SUBSTRING (   m.pu_desc, PATINDEX(\'%型%\',m.PU_Desc) + 1, len(m.PU_Desc)  )  ELSE  m.pu_desc  END  )  ELSE  n.pu_desc_alias  END ) AS [机台],(  CASE  WHEN users.User_Desc IS NULL THEN  rtrim(  SUBSTRING (  replace(m2.PU_Desc,\'机台\',\'\'), 3, 5  )  )  ELSE  users.User_Desc  END ) AS [机长] FROM dbo.udt_pp_MachineProcess a LEFT JOIN Prdexec_Paths b ON b.Path_Id = a.TargetProcess LEFT JOIN udt_dict_UserBase c ON c.User_Id = a.PresentCaptain LEFT JOIN dbo.Users_Base users ON users.User_Id = c.User_Id LEFT JOIN Prod_Units_Base m ON m.PL_Id = 55 AND m.PU_Id = a.Equipment LEFT JOIN Prod_Units_Base m2 ON a.MachineTeam = m2.PU_Id LEFT JOIN tbl_cbpc_prod_units_base n ON n.pu_id = a.Equipment LEFT JOIN Products_Base pa ON pa.Prod_Id = a.Prod_Id WHERE a.CarNumber IN (  ? ) ) a WHERE 工序 LIKE \'%印%\' or 工序 LIKE \'%数%\' GROUP BY 工序,机台,机长 ORDER BY 4 DESC', 'carts', '', '2019-05-17 14:06:21', '2019-05-17 14:10:52', '0');
INSERT INTO `sys_api` VALUES ('532', '00000000016', '1', '批量车号不同月份生产信息汇总', '5a08ad8ed2', 'SELECT 机台+\' \'+机长 机台,month_name 月份,count(*) 大万数,工序 FROM ( SELECT a.CarNumber AS [车号],convert(varchar(6),cast(a.StartTime as date),112) month_name,(  CASE  WHEN m.pu_desc LIKE \'人工大张班%\' THEN  \'人工拉号\'  WHEN b.Path_Desc = \'干胶印\' THEN  \'胶印\'  WHEN b.Path_Desc = \'凹一印\'  AND SUBSTRING (  pa.Prod_Desc,PATINDEX(\'%[.]%\',pa.Prod_Desc) + 1,5  ) = \'9602A\' THEN  \'凹印\'  WHEN b.Path_Desc = \'丝凸印丝印\' THEN  \'丝印\'  WHEN b.Path_Desc = \'印后涂布\' THEN  \'涂布\'  WHEN b.Path_Desc = \'裁封自动线\' THEN  \'裁封\'  WHEN b.Path_Desc = \'印码\'  AND (  (  charindex(\'XCJ\',m.PU_Desc) > 0  OR charindex(\'XZJ\',m.PU_Desc) > 0  )  OR m.PU_Desc LIKE \'%清分机%\'  ) THEN  \'抽查\'  WHEN b.Path_Desc = \'小张清分机全检\'  OR SUBSTRING (  m.pu_desc,0,PATINDEX(\'%型%\',m.PU_Desc)  ) = \'bps2000\' THEN  \'抽查\'  ELSE  b.Path_Desc  END ) AS [工序],(  CASE  WHEN n.pu_desc_alias IS NULL THEN  (  CASE  WHEN len(m.PU_Desc) - PATINDEX(\'%型%\',m.PU_Desc) > 5 THEN  SUBSTRING (   m.pu_desc, PATINDEX(\'%型%\',m.PU_Desc) + 1, len(m.PU_Desc)  )  ELSE  m.pu_desc  END  )  ELSE  n.pu_desc_alias  END ) AS [机台],(  CASE  WHEN users.User_Desc IS NULL THEN  rtrim(  SUBSTRING (  replace(m2.PU_Desc,\'机台\',\'\'), 3, 5  )  )  ELSE  users.User_Desc  END ) AS [机长] FROM dbo.udt_pp_MachineProcess a LEFT JOIN Prdexec_Paths b ON b.Path_Id = a.TargetProcess LEFT JOIN udt_dict_UserBase c ON c.User_Id = a.PresentCaptain LEFT JOIN dbo.Users_Base users ON users.User_Id = c.User_Id LEFT JOIN Prod_Units_Base m ON m.PL_Id = 55 AND m.PU_Id = a.Equipment LEFT JOIN Prod_Units_Base m2 ON a.MachineTeam = m2.PU_Id LEFT JOIN tbl_cbpc_prod_units_base n ON n.pu_id = a.Equipment LEFT JOIN Products_Base pa ON pa.Prod_Id = a.Prod_Id WHERE a.CarNumber IN (?) ) a WHERE 工序 LIKE \'%印%\' and month_name>=\'201901\' group by 机台,机长,month_name,工序 order by 2,3', 'carts', '', '2019-05-17 19:45:47', '2019-05-17 19:50:26', '0');
INSERT INTO `sys_api` VALUES ('533', '00000000003', '1', '9607T水印蹭脏产品作废开位热力图', '95e6954571', 'with cart_list as (select cart_number from qfm_wip_jobs where cart_number in (?)),fake_list as ( SELECT 5-(convert_sheet_number-1-mod(convert_sheet_number-1,7))/7 col_idx ,7-mod(c.convert_sheet_number+6,7) row_idx,convert_sheet_number FROM qfm_wip_jobs A INNER JOIN qfm_qa_inspect_master b ON A.job_id = b.job_id AND A.cart_number in (select * from cart_list) INNER JOIN qfm_qa_inspect_slave c ON b.inspectm_id = c.inspectm_id and c.image_blob IS NOT NULL where substr(c.ROUTE_SHEET_NUMBER,0,2)=10 and c.error_site in (98,20,19,24) or ( substr(c.ROUTE_SHEET_NUMBER,0,2)=14 and c.error_site in (12))) select col_idx 列,row_idx 行 ,count(*) 缺陷数 from fake_list group by col_idx,row_idx order by 1,2', 'carts', '', '2019-05-17 20:22:29', '2019-05-25 14:34:52', '0');
INSERT INTO `sys_api` VALUES ('534', '00000000003', '1', '指定大万实废分布', 'bc70063e23', 'with cart_list as (select cart_number from qfm_wip_jobs where cart_number in (?)),fake_list as (SELECT 5 -     (convert_sheet_number - 1 - mod(convert_sheet_number - 1,(case when substr(a.cart_number,3,1) in (2,3) then 8 else 7 end))) / (case when substr(a.cart_number,3,1) in (2,3) then 8 else 7 end) col_idx,    (case when substr(a.cart_number,3,1) in (2,3) then 8 else 7 end) - mod(c.convert_sheet_number + (case when substr(a.cart_number,3,1) in (2,3) then 8 else 7 end)-1,(case when substr(a.cart_number,3,1) in (2,3) then 8 else 7 end)) row_idx,    convert_sheet_number   FROM qfm_wip_jobs A  INNER JOIN qfm_qa_inspect_master b    ON A.job_id = b.job_id   AND A.cart_number in (select * from cart_list)  INNER JOIN qfm_qa_inspect_slave c    ON b.inspectm_id = c.inspectm_id   and c.image_blob IS NOT NULL) select col_idx 列,row_idx 行,count(*) 缺陷数  from fake_list group by col_idx,row_idx order by 1,2', 'carts', '', '2019-05-17 20:55:25', '2019-05-20 08:52:32', '0');
INSERT INTO `sys_api` VALUES ('535', '00000000002', '1', '各品种月度平均缺陷条数', '443c3338cd', 'SELECT a.品种,LEFT (a.生产日期,6) 月份,round(avg(a.[缺陷条数]),0) 平均缺陷数 FROM view_print_hecha a WHERE a.[生产日期] BETWEEN ? AND ? and a.品种 <>\\\'9607A\\\' GROUP BY a.品种,LEFT (a.生产日期,6) order by 1,2', 'tstart,tend', '', '2019-05-20 11:04:41', '2019-05-20 11:04:41', '0');
INSERT INTO `sys_api` VALUES ('536', '00000000002', '1', '印刷机台机检缺陷条数排名', '6fc3754734', 'SELECT row_number () OVER ( partition BY 品种,工序 ORDER BY a.票面缺陷条数 ) 名次,a.* from (SELECT a.ProductName AS 品种,a.ProcName AS 工序,a.CaptainName AS 机长,round( AVG ( a.errpiccount ),2 ) AS 票面缺陷条数,COUNT (*) AS 大万数 FROM dbo.view_print_intaglioAndOffset_anany AS a WHERE ProduceDate BETWEEN ? AND ? GROUP BY a.ProductName,a.ProcName,a.CaptainName,a.procid HAVING COUNT (*) > 10) a', 'tstart,tend', '', '2019-05-23 13:47:20', '2019-05-23 13:51:09', '0');
INSERT INTO `sys_api` VALUES ('537', '00000000002', '1', '核查工艺产品人工判废情况', 'f937dd48fd', 'SELECT DISTINCT a.[车号],a.[生产日期],a.[工艺],a.[品种],a.[机台],a.[缺陷条数],a.[实废大张数],a.[实废小开数],a.[实废条数],a.[开包量] AS [票面开包量],a.[丝印开包量],a.[丝印实废],a.[号码开包量],a.[号码实废],a.[号码黑图],a.[票面黑图],a.[丝印机检黑图],a.[丝印成像黑图],a.[期望开包量],a.[丝印增加开包量],a.[号码增加开包量] ,(case when a.品种<>\\\'9607T\\\' then \\\'0\\\' else 丝印后实废 end) 丝印后实废,码后未检出实废 FROM view_print_hecha_image_check AS a WHERE a.生产日期 BETWEEN ? AND ?', 'tstart,tend', '', '2019-05-23 14:54:25', '2019-05-23 14:54:25', '0');
INSERT INTO `sys_api` VALUES ('538', '00000000017', '1', '立体库出库白名单', '6d7ab499bc', 'SELECT a.proc_name 工艺,a.cart_number 车号,a.prod_name 品种,a.process_name 工序,a.review 状态,a.order_idx 出库序号 FROM v_cbpc_whitelist a order by 3,a.type,a.type_order,6', '', '', '2019-05-23 15:01:55', '2019-05-23 15:01:55', '0');
INSERT INTO `sys_api` VALUES ('539', '00000000016', '1', 'MES完成品 产品id', '945c6e3e8f', 'SELECT distinct  l.PU_Id AS LocationId,dbo.fn_Get_Table_Field_Value (  \\\'prod_units\\\', \\\'ERPCode\\\', l.PU_Id ) AS LocationCode,replace(l.PU_Desc,\\\'完成品\\\',\\\'\\\') AS LocationDesc  FROM PrdExec_Inputs pi inner JOIN PrdExec_Input_Sources pis ON pi.PEI_Id = pis.PEI_Id inner JOIN Prod_Units_Base l ON pis.PU_Id = l.PU_Id WHERE pi.Input_Name = \\\'MES库房MES货位对应\\\' AND l.PU_Id IS NOT NULL  and l.pu_desc like \\\'%完成品\\\'', '', '', '2019-05-23 19:41:03', '2019-05-23 19:41:03', '0');
INSERT INTO `sys_api` VALUES ('540', '00000000016', '1', '精品线机台质量排名', '2890c18c9a', 'WITH prod_list AS ( SELECT prod_id FROM Products_Base WHERE SUBSTRING (prod_desc,4,5) = \'9607T\' ),change_log AS ( SELECT a.CarNumber AS cart_number,SUM (CAST(a.Quantity AS INT)) exchange_quantity FROM udt_ps_Exchange a INNER JOIN prod_list b ON a.prod_id = b.prod_id WHERE a.unit = 51082 AND CONVERT ( VARCHAR,CAST (a.ExchangeTime AS datetime),112 ) BETWEEN CONVERT ( VARCHAR,dateadd(MONTH ,- 1,getdate()),112 ) AND CONVERT (VARCHAR,GETDATE(),112) GROUP BY a.CarNumber ),change_record AS ( SELECT DISTINCT b.* FROM change_log b LEFT JOIN dbo.udt_pp_MachineProcess a ON b.cart_number = a.CarNumber LEFT JOIN udt_tb_WipInventory wipInv ON wipInv.WI_Id = a.BusinessWiid WHERE CrownWordStartNum IS NOT NULL AND wipInv.ProcessLine_Desc = \'码后核查工艺\' ),fakeList AS ( SELECT b.工序 proc_name,b.erp_code,b.pu_desc,AVG (exchange_quantity) fake_num,COUNT (*) cart_num FROM change_record a INNER JOIN dbo.udt_pp_MachineProcess udp_pp ON a.cart_number = udp_pp.CarNumber INNER JOIN udt_tb_WipInventory wipInv ON wipInv.WI_Id = udp_pp.BusinessWiid INNER JOIN ( SELECT a.CarNumber AS [车号],b.Path_Desc AS [工序],r.pu_desc,r.erpcode erp_code FROM dbo.udt_pp_MachineProcess a LEFT JOIN Prdexec_Paths b ON b.Path_Id = a.TargetProcess LEFT JOIN v_cbpc_classinfo r ON r.PU_Id = a.MachineTeam WHERE a.CarNumber IS NOT NULL and r.PU_Desc<>\'凹印况东机台\' ) b ON a.cart_number = b.车号 WHERE b.工序 LIKE \'%胶%\' OR b.工序 LIKE \'凹%\' GROUP BY 工序,b.pu_desc,erp_code HAVING COUNT (*) > 50 ) SELECT proc_name,erp_code,fake_num,cart_num FROM ( SELECT row_number () OVER (  partition BY proc_name  ORDER BY  proc_name,fake_num,(  CASE replace(  replace(pu_desc,\'凹印\',\'\'), \'机台\', \'\'  )  WHEN \'杨平\' THEN  0  when \'刘潺\' then 0  WHEN \'任晓军\' THEN  0  WHEN \'蔡勇\' THEN  0  ELSE  1  END  ) ) rn ,* FROM fakeList ) a WHERE a.rn < 3 UNION ALL SELECT DISTINCT b.Path_Desc AS [工序],r.erpcode erp_code,0 fake_num,0 cart_num FROM dbo.udt_pp_MachineProcess a LEFT JOIN Prdexec_Paths b ON b.Path_Id = a.TargetProcess LEFT JOIN v_cbpc_classinfo r ON r.PU_Id = a.MachineTeam WHERE b.Path_Desc LIKE \'%丝%\' AND a.CarNumber IS NOT NULL', '', '', '2019-05-23 20:04:46', '2019-08-12 10:54:22', '0');
INSERT INTO `sys_api` VALUES ('541', '00000000016', '1', '印刷机台平均清分机作废开数', '9d601420c3', 'WITH cartlist AS ( SELECT  b.品种, b.工序, b.机台, b.机长, AVG (a.废票数) 清分机作废开数, COUNT (DISTINCT a.车号) 大万数 FROM  (  SELECT   车号,  SUM (废票数) 废票数  FROM   v_cbpc_CFTurnGuard  WHERE   CONVERT (VARCHAR,录入时间,112) between ? and ?  GROUP BY   车号  ) a INNER JOIN v_cbpc_cartlist b ON a.车号 = b.车号 WHERE  工序 NOT IN (\\\'过数\\\',\\\'人工拉号\\\') GROUP BY  b.品种, b.工序, b.机台, b.机长 HAVING  COUNT (*) > 10 ) SELECT row_number () OVER (  partition by 品种, 工序 ORDER BY  清分机作废开数 ) 名次,* FROM cartlist a', 'tstart,tend', '', '2019-05-24 20:00:28', '2019-05-24 20:00:28', '0');
INSERT INTO `sys_api` VALUES ('542', '00000000016', '1', '清分机作废开数原始数据', 'a89019f9a4', 'SELECT b.车号,b.冠字,b.品种,b.工序,b.机台,b.机长,a.废票数,a.拒钞数,convert(varchar,b.[开始时间],120) 开始时间,convert(varchar,b.[完成时间],120) 完成时间 FROM ( SELECT 车号,SUM (废票数) 废票数,SUM (拒钞数) 拒钞数 FROM v_cbpc_CFTurnGuard WHERE CONVERT (VARCHAR,录入时间,112) between ? and ? GROUP BY 车号 ) a INNER JOIN v_cbpc_cartlist b ON a.车号 = b.车号 WHERE 工序 NOT IN (\'过数\',\'人工拉号\')', 'tstart,tend', '', '2019-05-24 20:03:37', '2019-06-11 13:13:02', '0');
INSERT INTO `sys_api` VALUES ('543', '00000000016', '1', '印刷机台月度产量汇总', 'e6fef8a252', 'SELECT 品种,工序,机台,机长,SUM (产量) 产量 FROM v_cbpc_cartlist a WHERE CONVERT (VARCHAR,a.产量时间,112) between ? and ?  AND 品种 IS NOT NULL GROUP BY 品种,工序,机台,机长 HAVING SUM (产量) > 0 ORDER BY 1,2,3,5', 'tstart,tend', '', '2019-05-24 20:51:17', '2019-05-24 21:43:19', '0');
INSERT INTO `sys_api` VALUES ('544', '00000000016', '1', '机台每日产量', 'bbf273e743', 'SELECT 品种,工序,机台,机长,CONVERT (VARCHAR,a.产量时间,112) 日期,SUM (产量) 产量 FROM v_cbpc_cartlist a WHERE CONVERT (VARCHAR,a.产量时间,112) between ? and ? AND 品种 IS NOT NULL GROUP BY 品种,工序,机台,机长,CONVERT (VARCHAR,a.产量时间,112) HAVING SUM (产量) > 0 ORDER BY 1,2,3,5', 'tstart,tend', '', '2019-05-24 20:52:54', '2019-05-24 21:43:42', '0');
INSERT INTO `sys_api` VALUES ('545', '00000000016', '1', '印刷工序', '0a7840abbc', 'select path_id value,Path_Desc name from Prdexec_Paths where pl_id=55', '', '', '2019-05-24 21:02:16', '2019-05-24 21:02:16', '0');
INSERT INTO `sys_api` VALUES ('546', '00000000016', '1', '品种', 'db53f036f0', 'SELECT name,name value from (select distinct ProdTypeDesc name from udt_tb_WipInventory) a where a.name is not null', '', '', '2019-05-24 21:40:30', '2019-07-17 17:49:33', '0');
INSERT INTO `sys_api` VALUES ('547', '00000000016', '1', '立体库指定品种在库状态', '6f14b5a36a', 'SELECT a.CarNo 车号,a.[工艺],a.[产量],a.[接收方],a.[付出方],a.[工序],a.[机台],a.[品种],a.[最近更新] FROM dbo.v_cbpc_wip_inventory AS a WHERE a.[生产状态] = \\\'入库\\\' AND a.[品种] = ? AND 产品类型 LIKE \\\'%完成品\\\' ORDER BY a.[最近更新]', 'prod', '', '2019-05-24 21:48:12', '2019-05-24 21:48:12', '0');
INSERT INTO `sys_api` VALUES ('548', '00000000002', '1', '批量车号开包量查询', 'f97ad283d2', 'select 车号,[生产日期],机台,缺陷条数,实废条数,开包量 from view_print_hecha_image_check where 车号 in (?)', 'carts', '', '2019-05-24 21:54:51', '2019-05-24 21:54:51', '0');
INSERT INTO `sys_api` VALUES ('549', '00000000016', '1', '批量车号生产信息查询', '70c410bf80', 'SELECT a.[工艺],a.[车号],a.[冠字],a.[工序],a.[班次],a.[机台],a.[机长],convert(varchar,a.[开始时间],120) as 开始时间,convert(varchar,a.[完成时间],120) as 完成时间,a.[品种],a.[产量],a.生产记录 FROM dbo.v_cbpc_cartlist AS a WHERE a.[车号] in (?)', 'carts', '', '2019-05-24 22:03:01', '2019-07-12 19:55:41', '0');
INSERT INTO `sys_api` VALUES ('550', '00000000002', '1', '印钞品种列表', '12623689ae', 'select rtrim(ProductName)value,rtrim(ProductName) name from ProductData a where status=1 order by 2', '', '', '2019-05-25 14:07:22', '2019-05-25 14:07:22', '0');
INSERT INTO `sys_api` VALUES ('551', '00000000002', '1', '号码开包量汇总', '19e35d5524', 'SELECT LEFT (a.[生产日期],6) 月份,round( AVG ( CAST ( a.号码开包量 AS FLOAT ) ),2 ) 号码开包量 FROM view_print_hecha_image_check a WHERE a.[生产日期] BETWEEN ? AND ? AND 品种 = ? AND (a.mahouid > 0) GROUP BY LEFT (a.[生产日期],6)', 'tstart,tend,prod', '', '2019-05-25 14:21:10', '2019-05-25 14:30:43', '0');
INSERT INTO `sys_api` VALUES ('552', '00000000003', '1', '9604A水印蹭脏产品作废开位热力图', 'f1f880026e', 'with cart_list as (select cart_number from qfm_wip_jobs where cart_number in (?)),fake_list as ( SELECT 5-(convert_sheet_number-1-mod(convert_sheet_number-1,7))/7 col_idx ,7-mod(c.convert_sheet_number+6,7) row_idx,convert_sheet_number FROM qfm_wip_jobs A INNER JOIN qfm_qa_inspect_master b ON A.job_id = b.job_id AND A.cart_number in (select * from cart_list) INNER JOIN qfm_qa_inspect_slave c ON b.inspectm_id = c.inspectm_id and c.image_blob IS NOT NULL where substr(c.ROUTE_SHEET_NUMBER,0,2)=10 and c.error_site in (15,37) or ( substr(c.ROUTE_SHEET_NUMBER,0,2)=14 and c.error_site in (16))) select col_idx 列,row_idx 行 ,count(*) 缺陷数 from fake_list group by col_idx,row_idx order by 1,2', 'carts', '', '2019-05-25 14:36:17', '2019-05-25 14:38:45', '0');
INSERT INTO `sys_api` VALUES ('553', '00000000002', '1', '印刷机台平均开包量分析', '6fb9157874', 'SELECT a.品种 ,a.工序,a.机台 ,a.机长 ,avg(a.小开总数) as 小开废,round(avg(cast(a.已取出 as float)),2) AS 机检小开废,round(avg(cast(a.开包量 as float)),2) AS 实际开包量,round(avg(cast(a.机检开包量 as float)),2) AS 机检开包量,count(*) as 大万数 FROM view_print_ocr_ananysis a where CONVERT (VARCHAR,a.采集时间,112) BETWEEN ? AND ? group by a.品种 ,a.工序,a.机台 ,a.机长 order by 1,(case when 工序=\\\'胶一印\\\' then 1 when 工序=\\\'胶二印\\\' then 2 when 工序=\\\'胶印\\\' then 3 when 工序=\\\'凹一印\\\' then 4 when 工序=\\\'凹二印\\\' then 5 when 工序=\\\'凹印\\\' then 6 when 工序=\\\'印码\\\' then 7 when 工序=\\\'丝印\\\' then 8 end),3', 'tstart,tend', '', '2019-05-28 10:32:23', '2019-05-28 10:32:23', '0');
INSERT INTO `sys_api` VALUES ('554', '00000000003', '1', '产品主要缺陷类型分析', 'ccd89d81b5', 'with cart_list as (select cart_number from qfm_wip_jobs where cart_number in (?)),fake_info as (SELECT substr(c.ROUTE_SHEET_NUMBER,0,2) camera, c.error_site macro_id, count(*) err_num  FROM qfm_wip_jobs A INNER JOIN qfm_qa_inspect_master b  ON A.job_id = b.job_id  AND A.cart_number in (select * from cart_list) INNER JOIN qfm_qa_inspect_slave c  ON b.inspectm_id = c.inspectm_id  and c.image_blob IS NOT NULL group by substr(c.ROUTE_SHEET_NUMBER,0,2),c.error_site having count(*) > (select count(*) from cart_list)),fake_images as (SELECT a.cart_number, substr(c.ROUTE_SHEET_NUMBER,0,2) camera, c.error_site macro_id, c.image_blob  FROM qfm_wip_jobs A INNER JOIN qfm_qa_inspect_master b  ON A.job_id = b.job_id  AND A.cart_number in (select * from cart_list) INNER JOIN qfm_qa_inspect_slave c  ON b.inspectm_id = c.inspectm_id  and c.image_blob IS NOT NULL),fake_image_list as (select *  from (select row_number() over(partition by camera,macro_id order by dbms_random.value()) rn,   a.*    from fake_images a) where rn <= 1) select 检测区域,\"宏区id\",缺陷条数,缺陷图像 from (select   a.camera \"检测区域\", a.macro_id \"宏区id\", a.err_num \"缺陷条数\", b.image_blob \"缺陷图像\",row_number() over( order by 3 desc) rn from fake_info a inner join fake_image_list b  on a.camera = b.camera and a.macro_id = b.macro_id  order by 3 desc) a where rn <=12', 'cart', '', '2019-05-28 14:00:59', '2019-05-28 14:18:35', '0');
INSERT INTO `sys_api` VALUES ('555', '00000000009', '1', '装箱记录查询', 'ca793921a2', 'SELECT A.冠字,A.期望箱号,A.实际箱号,A.装箱时间,A.机长,A.封签  FROM VIEW_CBPC_BOXINFO A WHERE 冠字=?  and A.品种 = ? order by 1,4', 'code,prod', '', '2019-05-29 13:10:40', '2019-05-29 13:10:40', '0');
INSERT INTO `sys_api` VALUES ('556', '00000000009', '1', '装箱线生产记录查询', 'fc6bc37405', 'SELECT A.品种,A.冠字,A.期望箱号,A.实际箱号,A.装箱时间,A.机长,A.封签 FROM VIEW_CBPC_BOXINFO A WHERE a.装箱日期 between ? and ? order by 1,2,5', 'tstart,tend', '', '2019-05-29 13:37:24', '2019-05-29 13:37:24', '0');
INSERT INTO `sys_api` VALUES ('557', '00000000009', '1', '箱号信息追溯', 'cb96552dc3', 'SELECT A.冠字,   A.品种,   A.首张号,   A.箱内序号,   A.期望箱号,   A.实际箱号,   A.装箱时间,   A.机长,   A.封签,   A.号码图像,a.大号,a.小号  FROM VIEW_CBPC_PACKAGE A WHERE 品种 = ? and 冠字=?', 'prod,code', '', '2019-05-29 13:45:49', '2019-05-29 13:45:49', '0');
INSERT INTO `sys_api` VALUES ('558', '00000000005', '1', '丝印机台质量信息', 'df903c4adf', 'SELECT CART_NUMBER 车号,E .machine_name 机台,MACHINE_WASTER_NUMBER 机检缺陷,COUNT ( DISTINCT c.convert_sheet_number||\\\'_\\\'||c.sheet_num ) 实废开数,COUNT (*) 实废条数,TO_CHAR ( A .start_date,\\\'YYYY-MM-DD hh24:mi\\\' ) 生产时间 FROM wip_jobs A INNER JOIN QA_INSPECT_MASTER b ON A .JOB_ID = b.JOB_ID LEFT JOIN QA_INSPECT_SLAVE c ON c.inspectm_id = b.inspectm_id AND c.image_blob IS NOT NULL LEFT JOIN WIP_PROD_LOGS D ON A .job_id = D .job_id AND D .operation_id = 11 LEFT JOIN DIC_MACHINES E ON D .machine_id = E .machine_id WHERE TO_CHAR (A .start_date,\\\'yyyymmdd\\\') BETWEEN ? AND ? and c.convert_sheet_number is not null GROUP BY CART_NUMBER,E .machine_name,MACHINE_WASTER_NUMBER,A .start_date ORDER BY 1', 'tstart,tend', '', '2019-05-29 14:11:52', '2019-05-29 14:11:52', '0');
INSERT INTO `sys_api` VALUES ('559', '00000000005', '1', '丝印机台平均缺陷数统计', '1e21572d30', 'select month_name 月份,machine_name 机台,round(avg(machine_waster_number),0) 平均缺陷条数,round(avg(fake_num),0) 平均实废条数,count(*) 大万数 from (SELECT TO_CHAR (A.start_date,\\\'yyyymm\\\') month_name,E.machine_name,MACHINE_WASTER_NUMBER,COUNT (*) fake_num FROM wip_jobs A INNER JOIN QA_INSPECT_MASTER b ON A.JOB_ID = b.JOB_ID LEFT JOIN QA_INSPECT_SLAVE c ON c.inspectm_id = b.inspectm_id AND c.image_blob IS NOT NULL LEFT JOIN WIP_PROD_LOGS D ON A.job_id = D.job_id AND D.operation_id = 11 LEFT JOIN DIC_MACHINES E ON D.machine_id = E.machine_id WHERE TO_CHAR (A.start_date,\\\'yyyymmdd\\\') BETWEEN ? AND ? AND c.convert_sheet_number IS NOT NULL GROUP BY TO_CHAR (A.start_date,\\\'yyyymm\\\'),E.machine_name,MACHINE_WASTER_NUMBER )a group by month_name,machine_name order by 1,2', 'tstart,tend', '', '2019-05-29 14:12:18', '2019-05-29 14:12:18', '0');
INSERT INTO `sys_api` VALUES ('560', '00000000005', '1', '指定车号丝印实废分析', '9ff40ccaa4', 'with cart_list as (select cart_number from qfm_wip_jobs where cart_number in (?)),fake_list as (SELECT 5 -     (convert_sheet_number - 1 - mod(convert_sheet_number - 1,                    (case                      when substr(a.cart_number,3,1) in (2,3) then                       8                      else                       7                     end))) / (case      when substr(a.cart_number,3,1) in (2,3) then       8      else       7     end) col_idx,    (case      when substr(a.cart_number,3,1) in (2,3) then       8      else       7     end) - mod(c.convert_sheet_number + (case            when substr(a.cart_number,3,1) in (2,3) then            8            else            7           end) - 1,          (case            when substr(a.cart_number,3,1) in (2,3) then            8            else            7           end)) row_idx,    convert_sheet_number   FROM wip_jobs A  INNER JOIN qa_inspect_master b    ON A.job_id = b.job_id   AND A.cart_number in (select * from cart_list)  INNER JOIN qa_inspect_slave c    ON b.inspectm_id = c.inspectm_id   and c.image_blob IS NOT NULL) select col_idx 列,row_idx 行,count(*) 缺陷数  from fake_list group by col_idx,row_idx order by 1,2', 'carts', '', '2019-05-29 14:33:53', '2019-05-29 14:33:53', '0');
INSERT INTO `sys_api` VALUES ('561', '00000000005', '1', '指定车号丝印实废原因分析', 'ee8734a75f', 'with cart_list as (select cart_number from wip_jobs where cart_number in (?)),fake_info as (SELECT substr(c.ROUTE_SHEET_NUMBER,0,2) camera,    c.error_site macro_id,    count(*) err_num   FROM wip_jobs A  INNER JOIN qa_inspect_master b    ON A.job_id = b.job_id   AND A.cart_number in (select * from cart_list)  INNER JOIN qa_inspect_slave c    ON b.inspectm_id = c.inspectm_id   and c.image_blob IS NOT NULL  group by substr(c.ROUTE_SHEET_NUMBER,0,2),c.error_site  having count(*) > (select count(*) from cart_list)),fake_images as (SELECT a.cart_number,    substr(c.ROUTE_SHEET_NUMBER,0,2) camera,    c.error_site macro_id,    c.image_blob   FROM wip_jobs A  INNER JOIN qa_inspect_master b    ON A.job_id = b.job_id   AND A.cart_number in (select * from cart_list)  INNER JOIN qa_inspect_slave c    ON b.inspectm_id = c.inspectm_id   and c.image_blob IS NOT NULL),fake_image_list as (select *   from (select row_number() over(partition by camera,macro_id order by dbms_random.value()) rn,        a.*       from fake_images a)  where rn <= 10) select b.cart_number \"车号\",   (case a.camera     when \\\'10\\\' then      \\\'正面\\\'     when \\\'14\\\' then      \\\'背面\\\'     when \\\'13\\\' then      \\\'透视\\\'     when \\\'15\\\' then      \\\'OVMI\\\'     else      \\\'其它\\\' || a.camera    end) \"检测区域\",   \\\'m_\\\' || a.macro_id \"宏区id\",   a.err_num \"缺陷条数\",   b.image_blob \"缺陷图像\"  from fake_info a inner join fake_image_list b   on a.camera = b.camera  and a.macro_id = b.macro_id order by 4 desc', 'carts', '', '2019-05-29 14:39:40', '2019-05-29 14:39:40', '0');
INSERT INTO `sys_api` VALUES ('562', '00000000002', '1', '印刷机台OCR原始数据', '354d3e6bac', 'SELECT a.[车号],a.[品种],a.工序,a.机台,a.机长,a.印刷日期,a.检封日期,a.工艺,CONVERT ( VARCHAR,a.[采集时间],120 ) AS 采集时间,a.[小开总数],a.[已取出],a.[多取出],a.[开包量],a.[机检开包量],a.[丝印开包量],a.号码开包量 FROM view_print_ocr_offanditg a WHERE a.检封日期 BETWEEN ? AND ?', 'tstart,tend', '', '2019-05-29 14:52:19', '2019-07-24 17:50:54', '0');
INSERT INTO `sys_api` VALUES ('563', '00000000002', '1', 'OCR质量原始数据', 'cd4e573dfa', 'select a.[车号],a.[品种],a.机台,a.机长,a.生产日期,a.工艺,convert(varchar,a.[采集时间],120) as 采集时间,a.[小开总数],a.[已取出],a.[多取出],a.[开包量],a.[机检开包量],a.[小开作废率] from view_print_ocr a where convert(varchar,a.[采集时间],112) between ? and ?', 'tstart,tend', '', '2019-05-29 14:54:21', '2019-05-29 14:54:21', '0');
INSERT INTO `sys_api` VALUES ('564', '00000000002', '1', '开包量中间值以下产品机台分布', '320ba4c38c', 'select a.品种,a.工序,a.设备,a.机长,count(a.车号) 大万数 from (SELECT distinct a.[车号],a.[品种],b.MachineName 设备,b.ProcName 工序,b.CaptainName 机长 FROM [dbo].[VIEW_PRINT_OCR] a LEFT JOIN CartInfoData b on a.[车号]=b.CartNumber and b.NoteAnayID+b.MahouID>0 and (b.ProcName like \\\'胶%\\\' or b.ProcName like \\\'凹%\\\') where convert(varchar,a.[采集时间],112) between ? and ? and a.开包量 >( case when a.品种 =\\\'9607T\\\' then 110 when a.品种 =\\\'9606A\\\' then 75 when a.品种 =\\\'9604A\\\' then 65 when a.品种 =\\\'9603A\\\' then 80 when a.品种 =\\\'9602A\\\' then 50 end)) a group by a.品种,a.工序,a.设备,a.机长 order by 1,2,5 desc', 'tstart,tend', '', '2019-05-29 14:56:14', '2019-05-29 14:56:14', '0');
INSERT INTO `sys_api` VALUES ('565', '00000000002', '1', '开包量中间值以下产品设备分布', '96307c22bf', 'select a.品种,a.工序,a.设备,count(a.车号) 大万数 from (SELECT distinct a.[车号],a.[品种],b.MachineName 设备,b.ProcName 工序,b.CaptainName 机长 FROM [dbo].[VIEW_PRINT_OCR] a LEFT JOIN CartInfoData b on a.[车号]=b.CartNumber and b.NoteAnayID+b.MahouID>0 and (b.ProcName like \\\'胶%\\\' or b.ProcName like \\\'凹%\\\') where convert(varchar,a.[采集时间],112) between ? and ? and a.开包量 >(case when a.品种 =\\\'9607T\\\' then 110 when a.品种 =\\\'9606A\\\' then 75 when a.品种 =\\\'9604A\\\' then 65 when a.品种 =\\\'9603A\\\' then 80 when a.品种 =\\\'9602A\\\' then 50 end)) a group by a.品种,a.工序,a.设备 order by 1,2,4 desc', 'tstart,tend', '', '2019-05-29 14:56:29', '2019-05-29 14:56:29', '0');
INSERT INTO `sys_api` VALUES ('566', '00000000002', '1', '开包量优于中间值的产品机台分布', '0f061aa46d', 'select a.品种,a.工序,a.设备,a.机长,count(a.车号) 大万数 from (SELECT distinct a.[车号],a.[品种],b.MachineName 设备,b.ProcName 工序,b.CaptainName 机长 FROM [dbo].[VIEW_PRINT_OCR] a LEFT JOIN CartInfoData b on a.[车号]=b.CartNumber and b.NoteAnayID+b.MahouID>0 and (b.ProcName like \\\'胶%\\\' or b.ProcName like \\\'凹%\\\') where convert(varchar,a.[采集时间],112) between ? and ? and a.开包量 <( case when a.品种 =\\\'9607T\\\' then 110 when a.品种 =\\\'9606A\\\' then 75 when a.品种 =\\\'9604A\\\' then 65 when a.品种 =\\\'9603A\\\' then 80 when a.品种 =\\\'9602A\\\' then 50 end)) a group by a.品种,a.工序,a.设备,a.机长 order by 1,2,5 desc', 'tstart,tend', '', '2019-05-29 14:56:42', '2019-05-29 14:56:42', '0');
INSERT INTO `sys_api` VALUES ('567', '00000000002', '1', '开包量优于中间值的产品设备分布', 'cc3c2d0748', 'select a.品种,a.工序,a.设备,count(a.车号) 大万数 from (SELECT distinct a.[车号],a.[品种],b.MachineName 设备,b.ProcName 工序,b.CaptainName 机长 FROM [dbo].[VIEW_PRINT_OCR] a LEFT JOIN CartInfoData b on a.[车号]=b.CartNumber and b.NoteAnayID+b.MahouID>0 and (b.ProcName like \\\'胶%\\\' or b.ProcName like \\\'凹%\\\') where convert(varchar,a.[采集时间],112) between ? and ? and a.开包量 <( case when a.品种 =\\\'9607T\\\' then 110 when a.品种 =\\\'9606A\\\' then 75 when a.品种 =\\\'9604A\\\' then 65 when a.品种 =\\\'9603A\\\' then 80 when a.品种 =\\\'9602A\\\' then 50 end)) a group by a.品种,a.工序,a.设备 order by 1,2,4 desc', 'tstart,tend', '', '2019-05-29 14:56:55', '2019-05-29 14:56:55', '0');
INSERT INTO `sys_api` VALUES ('568', '00000000002', '1', '各品种实际开包量统计', 'f7b6817ba7', 'SELECT b.[工艺],a.品种,大万数,MAX,MIN,平均开包量,SUM ( CASE WHEN b.开包量 >= a.平均开包量 THEN 1 ELSE 0 END ) AS 平均开包量以上大万 FROM ( SELECT a.[工艺],品种,COUNT (*) AS 大万数,MAX (开包量) AS MAX,MIN (开包量) AS MIN,AVG (开包量) AS 平均开包量 FROM VIEW_PRINT_OCR a WHERE CONVERT (VARCHAR,a.采集时间,112) BETWEEN ? AND ? AND a.开包量 > 0 GROUP BY a.[工艺],品种 ) a INNER JOIN VIEW_PRINT_OCR b ON a.品种 = b.品种 and a.[工艺]= b.[工艺] AND CONVERT (VARCHAR,b.采集时间,112) BETWEEN ? AND ? AND b.开包量 > 0 GROUP BY a.品种,大万数,MAX,MIN,平均开包量,b.[工艺]', 'tstart,tend,tstart2,tend2', '', '2019-05-29 14:58:37', '2019-05-29 15:01:02', '0');
INSERT INTO `sys_api` VALUES ('569', '00000000002', '1', '印码机检系统多取出产品', 'f1690a30cc', 'SELECT 机台,SUM (多取出) AS 漏检总开数,AVG (多取出) 平均值,COUNT (*) AS 大万数 FROM view_print_ocr_leakcheck a WHERE a.生产日期 BETWEEN ? AND ? GROUP BY 机台', 'tstart,tend', '', '2019-05-29 15:01:49', '2019-05-29 15:01:49', '0');
INSERT INTO `sys_api` VALUES ('570', '00000000002', '1', '印刷机台平均开包量分析', '27d6c5af06', 'SELECT a.品种 ,a.工序,a.机台 ,a.机长 ,avg(a.小开总数) as 小开废,round(avg(cast(a.已取出 as float)),2) AS 机检小开废,round(avg(cast(a.开包量 as float)),2) AS 实际开包量,round(avg(cast(a.机检开包量 as float)),2) AS 机检开包量,count(*) as 大万数 FROM view_print_ocr_ananysis a where CONVERT (VARCHAR,a.采集时间,112) BETWEEN ? AND ? group by a.品种 ,a.工序,a.机台 ,a.机长 order by 1,(case when 工序=\\\'胶一印\\\' then 1 when 工序=\\\'胶二印\\\' then 2 when 工序=\\\'胶印\\\' then 3 when 工序=\\\'凹一印\\\' then 4 when 工序=\\\'凹二印\\\' then 5 when 工序=\\\'凹印\\\' then 6 when 工序=\\\'印码\\\' then 7 when 工序=\\\'丝印\\\' then 8 end),3', 'tstart,tend', '', '2019-05-29 15:02:46', '2019-05-29 15:02:46', '0');
INSERT INTO `sys_api` VALUES ('571', '00000000002', '1', '不同设备平均开包量分析', 'b5ce7911ba', 'SELECT 品种,工序,机台,avg(a.小开总数) as 小开废,avg(a.开包量) AS 开包量,round(avg(a.小开作废率),3) as 小开作废率,count(*) as 大万数 FROM view_print_ocr_ananysis a where CONVERT (VARCHAR,a.采集时间,112) BETWEEN ? AND ? group by 品种,工序,机台 order by 1,(case when 工序=\\\'胶一印\\\' then 1 when 工序=\\\'胶二印\\\' then 2 when 工序=\\\'胶印\\\' then 3 when 工序=\\\'凹一印\\\' then 4 when 工序=\\\'凹二印\\\' then 5 when 工序=\\\'凹印\\\' then 6 end),4 desc', 'tstart,tend', '', '2019-05-29 15:04:05', '2019-05-29 15:04:05', '0');
INSERT INTO `sys_api` VALUES ('572', '00000000002', '1', '各品种小开实废汇总', '15b42a2f0f', 'SELECT a.工艺,a.品种,AVG (小开总数) AS 平均总作废,count(*) as 大万数,AVG (多取出) AS 多取出,AVG (开包量) AS 开包量,AVG (机检开包量) AS 机检开包量,round(AVG(小开作废率),3) AS 小开作废率 FROM view_print_ocr a WHERE CONVERT (VARCHAR,a.采集时间,112) BETWEEN ? AND ? GROUP BY a.工艺,品种', 'tstart,tend', '', '2019-05-29 15:05:06', '2019-05-29 15:05:06', '0');
INSERT INTO `sys_api` VALUES ('573', '00000000002', '1', '各品种月度实废汇总', 'a7ca830079', 'SELECT a.工艺,a.品种,left(CONVERT (VARCHAR,a.采集时间,112),6) as 月份,count(*) as 大万数,AVG (小开总数) AS 平均总作废,AVG (多取出) AS 多取出,AVG (开包量) AS 开包量,AVG (机检开包量) AS 机检开包量,round(AVG(小开作废率),3) AS 小开作废率 FROM view_print_ocr a WHERE CONVERT (VARCHAR,a.采集时间,112) BETWEEN ? AND ? and a.工艺<>\\\'\\\' GROUP BY a.工艺,品种,left(CONVERT (VARCHAR,a.采集时间,112),6)', 'tstart,tend', '', '2019-05-29 15:05:53', '2019-05-29 15:05:53', '0');
INSERT INTO `sys_api` VALUES ('574', '00000000022', '1', '成品库出入记录', '30efd1b25d', 'WITH temp AS ( SELECT dbo.B_CZ.CZ,dbo.B_XQ.PZ,dbo.B_XQ.GZ,dbo.B_XQ.XH,dbo.B_GZ.XWDAH,dbo.B_GZ.XWDH,dbo.B_XQ.MXZS,dbo.B_RK.RQ,dbo.B_XQ.XID,dbo.B_SCX.SCXMC,g.Email AS operator FROM dbo.B_XQ INNER JOIN dbo.B_RK ON dbo.B_XQ.XID = dbo.B_RK.XID INNER JOIN dbo.B_GZ ON dbo.B_XQ.PZ = dbo.B_GZ.PZ AND dbo.B_XQ.GZ = dbo.B_GZ.GZ INNER JOIN dbo.B_SCX ON dbo.B_XQ.SCXID = dbo.B_SCX.SCXID INNER JOIN dbo.B_CZ ON dbo.B_XQ.XID = dbo.B_CZ.XID INNER JOIN dbo.aspnet_Users AS f ON f.UserName = dbo.B_CZ.RY1 INNER JOIN dbo.aspnet_Membership AS g ON g.UserId = f.UserId ) SELECT (case cz when \'D\' then \'入临库\' when \'R\' then \'入成品库\' end) 操作,GZ 冠字,XH 箱号,XWDAH ,XWDH 箱外大号,MXZS 小开数,RQ 日期,XID xid,operator 操作员 FROM temp AS temp_2 WHERE cz in (\'R\',\'D\') and PZ=? AND GZ = ? AND XH in (?) order by xid', 'prod,code,codenum', '', '2019-05-29 15:26:55', '2019-05-29 15:32:23', '0');
INSERT INTO `sys_api` VALUES ('575', '00000000016', '1', '清分机兑换记录', '3094407e19', 'SELECT a.[车号],a.[废票数],a.[拒钞数],a.[录入时间],a.[录入人] FROM dbo.v_cbpc_CFTurnGuard AS a WHERE a.[车号] =?', 'cart', '', '2019-05-29 16:44:18', '2019-05-29 16:44:18', '0');
INSERT INTO `sys_api` VALUES ('576', '00000000003', '1', '指定日期图核完工车号列表', '0f62812170', 'select cart_number from qfm_wip_jobs a inner join dic_products b on a.product_id=b.product_id where to_char(a.start_date,\\\'YYYYMMDD\\\') between ? and ? and b.product_name=? and finished_flag=3 order by a.start_date desc', 'tstart,tend,prod', '', '2019-05-29 17:16:49', '2019-05-29 17:16:49', '0');
INSERT INTO `sys_api` VALUES ('577', '00000000016', '1', '指定机台车号筛选', '32b912a393', 'select distinct 车号 carts from v_cbpc_cartlist where 车号 in (?) and 机台 =?', 'carts,machine_name', '', '2019-05-29 17:21:26', '2019-05-29 17:21:26', '0');
INSERT INTO `sys_api` VALUES ('578', '00000000016', '1', '产品流转原始记录', '14cf29cb53', 'WITH storageList AS ( SELECT  pu.PU_Id AS StorageId, pu.PU_Desc AS StorageDesc FROM  prod_units pu LEFT JOIN Prod_Lines pl ON pu.PL_Id = pl.pl_id WHERE  pl.Extended_Info = \'PL_MESStorageModel\' ),cartList AS (SELECT ? cart) SELECT * FROM (  SELECT  st.OutStorageTime 交接时间, st.CarNumber 车号, st.Business_Desc 业务类型, process.proc_path_desc 工序, process.dept_desc 部门, wh.PU_Desc 付出, (   CASE   WHEN st.BusinessId = 7574 THEN   isnull(    m.StorageDesc,   team.MachineTeamDesc   )   WHEN st.Equipment = 11122 THEN   dp.MachineDesc   ELSE   isnull(    team.MachineTeamDesc,   dp.MachineDesc   )   END  ) 接收, st.quantity 产量  FROM  udt_ps_StorageOut st  LEFT JOIN Prod_Units wh ON st.Storage = wh.pu_id  INNER JOIN v_cbpc_dept_process process ON st.Process = process.proc_path_id  LEFT JOIN v_dept_machineteam team ON st.MachineTeam = team.MachineTeamId  LEFT JOIN storageList m ON st.Equipment = m.StorageId  LEFT JOIN v_dept_machine dp ON st.Equipment = dp.MachineId  WHERE  st.ERPCode = \'1008\'  AND st.BusinessCode IN (\'10.0001\',\'10.0012\')  AND st.Quantity <> 0  AND st.CarNumber = (SELECT * FROM cartList)  UNION ALL  SELECT   st.InStorageTime 交接时间,  st.CarNumber 车号,  st.Business_Desc 业务类型,  process.proc_path_desc 工序,  process.dept_desc 部门,  isnull(   team.MachineTeamDesc,  m.StorageDesc   ) AS 付出,  wh.PU_Desc 接收,  cast(st.quantity as varchar) 产量  FROM   udt_ps_StorageIn st  LEFT JOIN Prod_Units wh ON st.Storage = wh.pu_id  INNER JOIN v_cbpc_dept_process process ON st.Process = process.proc_path_id  LEFT JOIN v_dept_machineteam team ON st.MachineTeam = team.MachineTeamId  LEFT JOIN storageList m ON st.Equipment = m.StorageId  WHERE   ERPCode = \'1008\'  AND st.Quantity <> 0  AND BusinessCode IN (\'10.0002\')  AND st.CarNumber = (SELECT * FROM cartList)  UNION ALL   SELECT   完成时间 交接时间,  车号,  \'上机生产\' 业务类型,  工序,  \'\' 部门,  \'库房\' 付出,  机台 接收,  cast(产量 as varchar)产量   FROM   v_cbpc_cartlist   WHERE   车号 = (SELECT * FROM cartList)   UNION ALL   SELECT    完成时间 交接时间,   车号,   \'入库申请\' 业务类型,   工序,   \'\' 部门,   机台 付出,   \'库房\' 接收,   cast(产量 as varchar)产量   FROM    v_cbpc_cartlist   WHERE    车号 = (SELECT * FROM cartList)   union ALL   select 开始时间 交接时间,车号,\'数管过数\' 业务类型,工序,\'印钞数管部\' 部门,ip 付出,过数员 接收,总数 产量 from v_cbpc_storage_count_log where 车号 = (SELECT * FROM cartList) ) t ORDER BY 1', 'cart', '', '2019-05-30 17:02:10', '2019-06-12 21:14:25', '0');
INSERT INTO `sys_api` VALUES ('579', '00000000002', '1', '精品线自动转工艺记录', '37c74463af', 'SELECT cart 车号,remark 备注 ,convert(varchar,rec_time,120) 时间 FROM [dbo].[print_wms_autoproc] where convert(varchar,rec_time,112) between ? and ? order by id desc', 'tstart,tend', '', '2019-05-30 18:36:42', '2019-06-10 09:32:00', '0');
INSERT INTO `sys_api` VALUES ('580', '00000000003', '1', '指定日期图核完工产品_自动线排产', '2a2f87d66f', 'SELECT distinct A.cart_number \"cart\" FROM QFM_wip_jobs A INNER JOIN QFM_WIP_PROD_LOGS c  ON A.job_id = c.job_id WHERE (c.operation_id = 8) AND TO_CHAR(c.end_date,\'yyyymmdd\') between ? and ? and a.finished_flag >= 2', 'tstart,tend', '', '2019-06-01 15:45:49', '2019-06-01 16:26:50', '0');
INSERT INTO `sys_api` VALUES ('581', '00000000003', '1', '图核判废原始记录', 'd92da42146', 'SELECT A.cart_number \"车号\",q.product_name \"品种\",r.operator_name \"判废人员\",b.machine_waster_number \"判废条数\",COUNT(DISTINCT E.qa_id) \"实废条数\",H.opennum \"票面开包量\" ,TO_CHAR(A.start_date,\'yyyy-mm-dd hh24:mi:ss\') \"上传时间\",TO_CHAR(c.end_date,\'yyyy-mm-dd hh24:mi:ss\') \"判废时间\" FROM QFM_wip_jobs A INNER JOIN QFM_WIP_PROD_LOGS c ON A.job_id = c.job_id INNER JOIN dic_operators r ON r.operator_id = c.operator_id INNER JOIN QFM_QA_INSPECT_MASTER b ON A.job_id = b.job_id INNER JOIN qfm_qa_temp_qatbl E ON A.job_id = E.job_id INNER JOIN (SELECT job_id,COUNT(*) AS opennum  FROM (SELECT G.job_id   FROM qfm_qa_temp_qatbl G,qfm_wip_jobs a1   WHERE G.job_id = a1.job_id   GROUP BY G.job_id,G.thousand_index,G.convert_num)  GROUP BY job_id) H ON A.job_id = H.job_id INNER JOIN dic_products q ON q.product_id = A.product_id WHERE (c.operation_id = 8) AND TO_CHAR(c.end_date,\'yyyymmdd\') between ? and ? AND b.item_flag IN (2,3) and a.finished_flag >= 2 GROUP BY A.cart_number,A.start_date,c.end_date,b.machine_waster_number,H.opennum,q.PRODUCT_NAME,r.operator_name order by c.end_date', 'tstart,tend', '', '2019-06-01 16:00:38', '2019-06-01 16:10:39', '0');
INSERT INTO `sys_api` VALUES ('582', '00000000003', '1', '图核判废月度开包量排名', '2f85e74042', 'select row_number() over(order by 平均开包量 asc) rn,a.*  from (SELECT r.operator_name 判废人员,       sum(b.machine_waster_number) 判废总条数,       round(avg(H.opennum),1) 平均开包量,       count(*) 大万数      FROM QFM_wip_jobs A     INNER JOIN QFM_WIP_PROD_LOGS c       ON A.job_id = c.job_id     INNER JOIN dic_operators r       ON r.operator_id = c.operator_id     INNER JOIN QFM_QA_INSPECT_MASTER b       ON A.job_id = b.job_id     INNER JOIN (SELECT job_id,COUNT(*) AS opennum            FROM (SELECT G.job_id                FROM qfm_qa_temp_qatbl G,qfm_wip_jobs a1               WHERE G.job_id = a1.job_id               GROUP BY G.job_id,                   G.thousand_index,                   G.convert_num)           GROUP BY job_id) H       ON A.job_id = H.job_id     WHERE (c.operation_id = 8)      AND TO_CHAR(c.end_date,\\\'yyyymmdd\\\') between ? and        ?      AND b.item_flag IN (2,3)      and a.finished_flag >= 2     GROUP BY r.operator_name) a', 'tstart,tend', '', '2019-06-01 16:10:00', '2019-06-01 16:10:00', '0');
INSERT INTO `sys_api` VALUES ('583', '00000000016', '1', '是否已同步开包量信息', '3a8dc78b43', 'SELECT top 1 recid FROM [dbo].[tbl_cbpc_batch_opennum] where convert(varchar,rec_time,112)=convert(varchar,GETDATE(),112)', '', '', '2019-06-01 16:33:57', '2019-06-01 16:33:57', '0');
INSERT INTO `sys_api` VALUES ('584', '00000000016', '1', '记录精品线开包量', 'ca6c993f1a', 'insert into tbl_cbpc_batch_opennum(cart,opennum,rec_time ) values (?,?,?)', 'cart,opennum,rec_time', '', '2019-06-01 16:50:09', '2019-06-01 16:50:09', '0');
INSERT INTO `sys_api` VALUES ('585', '00000000016', '1', '白名单中未同步开包量的产品列表', '8b7cb43d6c', 'SELECT 车号 cart FROM v_cbpc_whitelist where 工艺=\'码后核查\' and proc_name = \'dzhp\' and 开包量 is null', '', '', '2019-06-01 18:49:05', '2019-06-01 19:19:58', '0');
INSERT INTO `sys_api` VALUES ('586', '00000000016', '1', '码后核查在库产品查询', '59bbb64465', 'SELECT a.[冠字] gh,a.prod_id,a.[品种] prodname,a.[工艺] tech,a.[proc_name] \'proc\',a.[车号] carno,a.[类型] review,a.[开包量] ex_opennum,a.[出库序号] idx FROM dbo.v_cbpc_whitelist AS a WHERE a.工艺 = ? AND a.proc_name in (\'dzhp\',\'tbhp\') order by prodname,idx', 'proc_type', '', '2019-06-01 19:23:38', '2019-09-05 10:58:40', '0');
INSERT INTO `sys_api` VALUES ('587', '00000000016', '1', '检封兑换票原始记录', '21068ef547', 'SELECT * FROM v_cbpc_exchange a where a.[开始日期] between ? and ?', 'tstart,tend', '', '2019-06-12 10:42:00', '2019-06-12 10:42:00', '0');
INSERT INTO `sys_api` VALUES ('588', '00000000016', '1', '指定车号冠字信息查询', '9f836c859a', 'SELECT distinct 车号 cart,冠字 gz FROM v_cbpc_cart_lite a where a.车号 in (?) and 冠字 <>\\\'\\\'', 'carts', '', '2019-06-14 20:35:19', '2019-06-14 20:35:19', '0');
INSERT INTO `sys_api` VALUES ('589', '00000000016', '1', '凹二印过数时长分布直方图', '29015726fd', 'SELECT ( CASE SUBSTRING (车号,3,1) WHEN 0 THEN \'9606T\' WHEN 8 THEN \'9607T\' ELSE \'960\' + SUBSTRING (车号,3,1) + \'A\' END ) 品种,datediff( MINUTE,开始时间,结束时间 ) 过数时长 FROM [dbo].[v_cbpc_storage_count_log] WHERE 工序 = \'凹二印\' and datediff( MINUTE,开始时间,结束时间 ) between 4 and 60 order by 1 desc,2', '', '', '2019-06-17 12:22:16', '2019-06-17 13:05:47', '0');
INSERT INTO `sys_api` VALUES ('590', '00000000016', '1', '凹二印过数时长分布图', '322f8db474', 'SELECT 过数时长,COUNT (*) 数量 FROM ( SELECT ceiling(datediff( MINUTE,开始时间,结束时间 )/5+1)*5 过数时长 FROM [dbo].[v_cbpc_storage_count_log] WHERE 工序 = \'凹二印\' AND ( CASE SUBSTRING (车号,3,1) WHEN 0 THEN \'9606T\' WHEN 8 THEN \'9607T\' ELSE \'960\' + SUBSTRING (车号,3,1) + \'A\' END ) = ? AND datediff( MINUTE,开始时间,结束时间 ) BETWEEN 4 AND 60 ) a GROUP BY 过数时长', 'prefix', '', '2019-06-17 13:02:32', '2019-06-17 13:10:32', '0');
INSERT INTO `sys_api` VALUES ('591', '00000000016', '1', '指定车号凹正过数人员分析', '351a7c7f9a', 'SELECT 过数员,count(*) 大万数 FROM [dbo].[v_cbpc_storage_count_log] WHERE 车号 IN (? ) and 工序=\\\'凹二印\\\' group by 过数员 order by 2', 'carts', '', '2019-06-18 19:33:30', '2019-06-18 19:33:30', '0');
INSERT INTO `sys_api` VALUES ('592', '00000000003', '1', '实际开包量统计', 'cf000250a0', 'with carts as (select status,substr(code_num,7,1) kilo_num,substr(regexp_replace(code_num,\'[A-Z]\',\'\'),1,4) format_pos from ocr_contrast_result where cart_num=?),summary as (select sum(case when status=\'多取出\' then 1 else 0 end) leak_num,sum(1) fake_num from carts ),opennum as (select kilo_num,count(1) ex_opennum from carts group by kilo_num,format_pos),ex_opennum as (select sum(case when kilo_num=0 then 1 else 0 end) ex_opennum_kilo0,sum(1) ex_opennum,sum(case when kilo_num=0 then ex_opennum else 0 end) fake_num_kilo0 from opennum) select sum(leak_num) \"leak_num\",sum(fake_num) \"fake_num\",sum(ex_opennum_kilo0) \"ex_opennum_kilo0\" ,sum(ex_opennum) \"ex_opennum\",sum(fake_num_kilo0) \"fake_num_kilo0\" from (select leak_num,fake_num,0 ex_opennum_kilo0,0 ex_opennum,0 fake_num_kilo0 from summary union select 0 leak_num,0 fake_num ,ex_opennum_kilo0,ex_opennum ,fake_num_kilo0 from ex_opennum ) a', 'cart', '', '2019-06-19 08:51:00', '2019-06-19 08:52:10', '0');
INSERT INTO `sys_api` VALUES ('593', '00000000024', '1', '立体库执行任务列表', '359da13962', 'SELECT event_id,车号,品种,工序,机台,申请人,申请人ID,机台卡号,工艺,right(convert(varchar,预计完成,120),8) 预计完成,( CASE WHEN status = \\\'排队中\\\' THEN status ELSE result END ) status,right(convert(varchar,申请时间,120),8) 申请时间,right(convert(varchar,任务开始,120),8) 任务开始,right(convert(varchar,实际完成,120),8) 实际完成,楼层,库区+\\\'-\\\'+库门 库门 FROM v_cbpc_rss_request a', '', '', '2019-06-21 12:50:19', '2019-06-21 12:50:19', '0');
INSERT INTO `sys_api` VALUES ('594', '00000000016', '1', '清空当前班次均衡生产黑名单产品', '4e607123a7', 'delete from udt_di_Quality_Interface', '', '', '2019-06-26 17:15:47', '2019-07-01 11:39:27', '0');
INSERT INTO `sys_api` VALUES ('595', '00000000016', '1', '写入检封均衡生产黑名单产品列表', 'ae34ce8c72', 'insert into udt_di_quality_interface(carno,biztype,excutetime ) values ?', 'values', '@desc:批量插入数据时，约定使用二维数组values参数，格式为[{carno,biztype,excutetime }]，数组的每一项表示一条数据', '2019-06-26 17:19:43', '2019-06-27 13:20:16', '0');
INSERT INTO `sys_api` VALUES ('596', '00000000024', '1', '总公司企业活力评估问卷插入', 'fadd053a8f', 'insert into tbl_cbpc_harmoney_2019(uuid,company_id,ip,remark_1,remark_2,remark_3,remark_4,remark_5,remark_6,remark_7,remark_8,remark_9,remark_10,remark_11,remark_12,remark_13,remark_14,remark_15,remark_16,remark_17,remark_18,remark_19,remark_20,remark_21,remark_22,remark_23,remark_24,remark_25,remark_26,remark_27,remark_28,remark_29,remark_30,start_time,batch ) values ?', 'values', '@desc:批量插入数据时，约定使用二维数组values参数，格式为[{uuid,company_id,vote_detail,remark_1,remark_2,remark_3,remark_4,remark_5,remark_6,remark_7,remark_8,remark_9,remark_10,remark_11,remark_12,remark_13,remark_14,remark_15,remark_16,remark_17,remark_18,remark_19,remark_20,remark_21,remark_22,remark_23,remark_24,remark_25,remark_26,remark_27,remark_28,remark_29,remark_30,remark_31,remark_32,remark_33,remark_34,remark_35,remark_36,remark_37,remark_38,remark_39,remark_40,remark_41,remark_42,remark_43,remark_44,remark_45,remark_46,remark_47,remark_48,remark_49,remark_50,start_time }]，数组的每一项表示一条数据', '2019-07-02 15:16:03', '2019-08-31 10:35:39', '0');
INSERT INTO `sys_api` VALUES ('597', '00000000025', '1', '总公司企业活力评估问卷查询', '7746a9e708', 'SELECT a.uuid,ci.company,a.remark_1 AS question_1,a.remark_2 AS question_2,a.remark_3 AS question_3,a.remark_4 AS question_4,a.remark_5 AS question_5,a.remark_6 AS question_6,a.remark_7 AS question_7,a.remark_8 AS question_8,b.remark_8 AS question_ext_8,a.remark_9 AS question_9,b.remark_9 AS question_ext_9,a.remark_10 AS question_10,b.remark_10 AS question_ext_10,a.remark_11 AS question_11,a.remark_12 AS question_12,b.remark_12 AS question_ext_12,a.remark_13 AS question_13,b.remark_13 AS question_ext_13,a.remark_14 AS question_14,a.remark_15 AS question_15,a.remark_16 AS question_16,b.remark_16 AS question_ext_16,a.remark_17 AS question_17,b.remark_17 AS question_ext_17,a.remark_18 AS question_18,b.remark_18 AS question_ext_18,a.remark_19 AS question_19,b.remark_19 AS question_ext_19,a.remark_20 AS question_20,b.remark_20 AS question_ext_20,a.remark_21 AS question_21,a.remark_22 AS question_22,b.remark_22 AS question_ext_22,a.remark_23 AS question_23,b.remark_23 AS question_ext_23,a.remark_24 AS question_24,a.remark_25 AS question_25,a.remark_26 AS question_26,b.remark_26 AS question_ext_26,a.remark_27 AS question_27,a.remark_28 AS question_28,a.remark_29 AS question_29,b.remark_29 AS question_ext_29,a.remark_30 AS question_30 FROM tbl_cbpc_harmoney_2019 a INNER JOIN tbl_cbpc_harmoney_2019_remark b ON a.uuid = b.uuid INNER JOIN company_ip ci ON a.ip LIKE concat( ci.ip,\'%\' ) ORDER BY ci.company', '', '', '2019-07-02 15:17:18', '2019-08-21 20:02:47', '0');
INSERT INTO `sys_api` VALUES ('598', '00000000024', '1', '总公司企业活力评估问卷其他插入', '8ef0b5d673', 'insert into tbl_cbpc_harmoney_2019_remark(uuid,company_id,ip,remark_1,remark_2,remark_3,remark_4,remark_5,remark_6,remark_7,remark_8,remark_9,remark_10,remark_11,remark_12,remark_13,remark_14,remark_15,remark_16,remark_17,remark_18,remark_19,remark_20,remark_21,remark_22,remark_23,remark_24,remark_25,remark_26,remark_27,remark_28,remark_29,remark_30,start_time) values ?', 'values', '', '2019-07-02 15:33:39', '2019-08-31 10:35:30', '0');
INSERT INTO `sys_api` VALUES ('599', '00000000025', '1', '总公司企业活力评估问卷总数', '7318236484', 'SELECT count(1) as total FROM tbl_cbpc_harmoney_2019', '', '', '2019-07-04 08:29:31', '2019-07-04 08:29:31', '0');
INSERT INTO `sys_api` VALUES ('600', '00000000025', '1', '总公司企业活力评估问卷地址分组统计', '38f12aabc9', 'SELECT ( CASE when a.ip = \' \' then \'-\' WHEN b.company IS NULL THEN a.ip ELSE b.company END ) IP地址,CONCAT( sum( a.total ),\'/\',max( case when b.target = \' \' or isnull(b.target) then \'-\' else b.target end) ) AS total FROM ( SELECT substr( ip,1,locate( \'.\',ip,LOCATE( \'.\',ip,1 ) + 1 ) ) ip,count( 1 ) total FROM tbl_cbpc_harmoney_2019 GROUP BY substr( ip,1,locate( \'.\',ip,LOCATE( \'.\',ip,1 ) + 1 ) ) ) a LEFT JOIN company_ip b ON a.ip = b.ip GROUP BY ( CASE when a.ip = \' \' then \'-\' WHEN b.company IS NULL THEN a.ip ELSE b.company END )', '', '', '2019-07-04 08:49:55', '2019-07-05 13:31:48', '0');
INSERT INTO `sys_api` VALUES ('601', '00000000025', '1', '获得服务器时间', 'e5ea192295', 'select SYSDATE() as dt from dual', '', '', '2019-07-04 12:13:29', '2019-07-04 12:49:06', '0');
INSERT INTO `sys_api` VALUES ('602', '00000000016', '1', '实际开包量统计', '3b7b66ab32', 'SELECT recid,cart FROM tbl_cbpc_batch_opennum where isnull(ex_opennum,0)=0 and substring(cart,3,1)<>0 and datediff(day,rec_time,getdate())<120 order by rec_time', '', '', '2019-07-11 13:45:54', '2019-10-11 15:30:35', '0');
INSERT INTO `sys_api` VALUES ('603', '00000000016', '1', '更新OCR实废信息', '15af7fe1bb', 'update tbl_cbpc_batch_opennum set ex_opennum = ?,fake_num = ?,leak_num = ?,ex_opennum_kilo0 = ?,fake_num_kilo0 = ? where recid=?', 'ex_opennum,fake_num,leak_num,ex_opennum_kilo0,fake_num_kilo0,recid', '', '2019-07-11 14:01:15', '2019-07-11 14:01:15', '0');
INSERT INTO `sys_api` VALUES ('604', '00000000016', '1', '印码产量记录', '560029dccc', 'SELECT 品种,工序,机台,机长,(case max((case when 班次 =\\\'白班\\\' then 1 else 2 end)) when 1 then \\\'白班\\\' else \\\'中班\\\' end)班次,CAST (SUM(产量) AS FLOAT) / 10000 AS 产量,CONVERT ( VARCHAR (10),产量时间,120 ) AS 生产日期,生产记录 FROM v_cbpc_cartlist WHERE ( CONVERT (VARCHAR,产量时间,112) BETWEEN ? AND ? ) AND 工序 in (\\\'印码\\\',\\\'丝印\\\',\\\'涂布\\\') GROUP BY 品种,工序,班长,机台,机长,生产记录,CONVERT ( VARCHAR (10),产量时间,120 ) having SUM(产量)>0 ORDER BY 1,2,6', 'tstart,tend', '', '2019-07-12 19:17:49', '2019-07-12 19:17:49', '0');
INSERT INTO `sys_api` VALUES ('605', '00000000016', '1', '裁切及裁封自动线生产记录', 'e11c753ca6', 'SELECT 品种,工序,班长,机台,机长,(case max((case when 班次 =\\\'白班\\\' then 1 else 2 end)) when 1 then \\\'白班\\\' else \\\'中班\\\' end)班次,CAST (SUM(产量) AS FLOAT) AS 产量,CONVERT (  VARCHAR (10), 产量时间, 120 ) AS 生产日期,生产记录 FROM v_cbpc_cartlist WHERE (  CONVERT (VARCHAR,产量时间,112) BETWEEN ?  AND ? ) AND 工序 LIKE \\\'裁%\\\' GROUP BY 品种,工序,班长,机台,机长, 生产记录,CONVERT (  VARCHAR (10), 产量时间, 120 ) having SUM(产量)>0 ORDER BY 1,2,7', 'tstart,tend', '', '2019-07-12 19:19:05', '2019-07-12 19:19:05', '0');
INSERT INTO `sys_api` VALUES ('606', '00000000016', '1', '清分机生产记录', '18eebf296c', 'SELECT 品种,工序,班长,机台,机长,(case max((case when 班次 =\\\'白班\\\' then 1 else 2 end)) when 1 then \\\'白班\\\' else \\\'中班\\\' end)班次,CAST (SUM(产量) AS FLOAT)  AS 产量,CONVERT (  VARCHAR (10), 产量时间, 120 ) AS 生产日期,生产记录 FROM v_cbpc_cartlist WHERE (  CONVERT (VARCHAR,产量时间,112) BETWEEN ?  AND ? ) AND 工序=\\\'抽查\\\' GROUP BY 品种,工序,班长,机台,机长, 生产记录,CONVERT (  VARCHAR (10), 产量时间, 120 ) having SUM(产量)>0 ORDER BY 1,2,7', 'tstart,tend', '', '2019-07-12 19:20:07', '2019-07-12 19:20:07', '0');
INSERT INTO `sys_api` VALUES ('607', '00000000016', '1', 'MES兑换品自动转全检', '0c6677a9a2', 'select carno cart from udt_tb_WipInventory where UserDefine2=\\\'DHP\\\' and CurrentUnit_Id=10996', '', '', '2019-07-12 19:26:59', '2019-07-12 19:26:59', '0');
INSERT INTO `sys_api` VALUES ('608', '00000000016', '1', '产品总帐', '4e00407442', 'SELECT [ExcuteDate] AS \'日期\',isnull([白纸准备完成品],0) AS \'白纸投入\',CONVERT(VARCHAR,convert(decimal(13,3),[外来样])) AS 外来样,isnull([白纸],0) AS \'白纸\',[胶印],[凹印],isnull([查白票],0) AS [查白票],[丝印],[印码],isnull([涂布],0) AS [涂布],[检封],[补白票],[厂用样张],[废品],[厂金库],isnull([厂存档数],0) AS [厂存档数],CONVERT(VARCHAR,convert(decimal(13,3),[外来样张])) AS 外来样张 ,[解缴],[销毁],CONVERT(VARCHAR,convert(decimal(13,3),[报局样])) AS 报局样,CONVERT(VARCHAR,convert(decimal(13,3),[库存合计])) AS 库存合计,CONVERT(VARCHAR,convert(decimal(13,3),[期末库存合计])) AS \'校验\' FROM [SOADB].[dbo].[udt_tb_Report_Account_All] WHERE [Product_Desc] =? AND ( CONVERT (VARCHAR,cast([ExcuteDate] as datetime),112) BETWEEN ? AND ? ) ORDER BY [ExcuteDate] ASC', 'product,tstart,tend', '', '2019-07-16 15:22:17', '2019-11-04 16:02:39', '0');
INSERT INTO `sys_api` VALUES ('609', '00000000016', '1', '产品品种', '190710414d', 'select distinct(Product_Desc) from v_Machine_Process where Product_Desc IS NOT NULL;', '', '', '2019-07-17 15:20:47', '2019-07-17 15:33:09', '0');
INSERT INTO `sys_api` VALUES ('610', '00000000023', '1', '成都印钞有限公司印钞产品总账', '99d1ed4c79', 'SELECT ? 名称,\'103-G-6T\' 纸张名称,\'XXX\' 纸张规格,\'35开\' 开数,\'尺\' 单位,\'数-钞-2-11\' 库房', 'product', '', '2019-07-18 14:06:02', '2019-07-18 16:25:03', '0');
INSERT INTO `sys_api` VALUES ('611', '00000000016', '1', '人工判废同步结果', '6172ccf74e', 'select convert(varchar,excutetime,120) 同步时间,strcarno 车号列表,userdefine3 MES处理时间,userdefine4 状态 from udt_di_wasterlog order by 1 desc', '', '', '2019-07-22 13:08:15', '2019-07-22 13:08:15', '0');
INSERT INTO `sys_api` VALUES ('612', '00000000016', '1', '均衡生产车号列表', '6d3c1b323e', 'select carno 车号,(case substring(carno,3,1) when 8 then \'9607T\' when 4 then \'9604A\' when 3 then \'9603A\' when 2 then \'9602A\' when 0 then \'9606T\' else substring(carno,3,1) end) 品种,(case biztype when \'JHSC\' then \'均衡生产\' else BizType end) 类型,convert(varchar,excutetime,120) 记录时间,b.opennum 开包量 from udt_di_Quality_Interface a left join tbl_cbpc_batch_opennum b on a.carno=b.cart', '', '', '2019-07-22 13:14:00', '2019-07-22 13:21:53', '0');
INSERT INTO `sys_api` VALUES ('613', '00000000016', '1', '裁封自动线开包量情况', '69398bb6c9', 'SELECT b.[工艺],b.[品种],b.[车号],b.[冠字],b.[工序],b.[班次],b.[机台],b.[机型],b.[机长],b.[完成时间],a.opennum AS [期望开包量],a.ex_opennum 实际开包量,a.ex_opennum_kilo0 第0千位开包量,round(  CAST (a.ex_opennum_kilo0 AS FLOAT) / a.ex_opennum * 100, 2 ) 开包量占比,a.fake_num 实废小开,a.leak_num 多取出,a.fake_num_kilo0 第0千位实废小开,round(  CAST (a.fake_num_kilo0 AS FLOAT) / a.fake_num * 100, 2 ) 实废占比 FROM tbl_cbpc_batch_opennum a LEFT JOIN v_cbpc_cartlist b ON a.cart = b.车号 WHERE CONVERT (VARCHAR,产量时间,112) BETWEEN ? AND ? AND b.工序 IN (\\\'裁切\\\',\\\'裁封\\\') AND b.车号 IS NOT NULL AND ex_opennum > 0 ORDER BY 完成时间,品种,机台', 'tstart,tend', '', '2019-07-22 13:32:50', '2019-07-22 13:32:50', '0');
INSERT INTO `sys_api` VALUES ('614', '00000000016', '1', '印钞品种与钞纸品种规格映射', '142956c77b', 'select * from ( select \'9602A品\' as 产品名称,\'103-G-2A\' as 纸张名称,\'676*542-90g\' as 纸张规格,\'40K\' as \'开数\',\'尺\' as 单位,\'数-钞-2—11\' as 报表编号 union all select \'9603A品\' as 产品名称,\'103-G-3A\' as 纸张名称,\'700*545-90g\' as 纸张规格,\'40K\' as \'开数\',\'尺\' as 单位,\'数-钞-2—11\' as 报表编号 union all select \'9604A品\' as 产品名称,\'103-G-4A\' as 纸张名称,\'726*530-90g\' as 纸张规格,\'35K\' as \'开数\',\'尺\' as 单位,\'数-钞-2—11\' as 报表编号 union all select \'9605A品\' as 产品名称,\'103-G-5A\' as 纸张名称,\' \' as 纸张规格,\'35K\' as \'开数\',\'尺\' as 单位,\'数-钞-2—11\' as 报表编号 union all select \'9606A品\' as 产品名称,\'103-G-6A\' as 纸张名称,\' \' as 纸张规格,\'35K\' as \'开数\',\'尺\' as 单位,\'数-钞-2—11\' as 报表编号 union all select \'9607A品\' as 产品名称,\'103-G-7A\' as 纸张名称,\'800*578-90g\' as 纸张规格,\'35K\' as \'开数\',\'尺\' as 单位,\'数-钞-2—11\' as 报表编号  union all select \'9606T品\' as 产品名称,\'103-G-6T\' as 纸张名称,\'700*545-90g\' as 纸张规格,\'35K\' as \'开数\',\'尺\' as 单位,\'数-钞-2—11\' as 报表编号  union all select \'9607T品\' as 产品名称,\'103-G-7T\' as 纸张名称,\'800*578-95g\' as 纸张规格,\'35K\' as \'开数\',\'尺\' as 单位,\'数-钞-2—11\' as 报表编号 )as t where 产品名称=?', 'product', '', '2019-07-22 15:05:55', '2019-10-29 08:36:38', '0');
INSERT INTO `sys_api` VALUES ('615', '00000000016', '1', '印钞主业品工序产量报表', 'fdbf0a49ed', 'SELECT [Product_Desc] as \'品种\',[GongXu_Desc] as \'工序\',[Unit_Desc] as \'单位\',[Quantity_1] as \'1月\',[Quantity_2] as \'2月\',[Quantity_3] as \'3月\',[Quantity_4] as \'4月\',[Quantity_5] as \'5月\',[Quantity_6] as \'6月\',[Quantity_7] as \'7月\',[Quantity_8] as \'8月\',[Quantity_9] as \'9月\',[Quantity_10] as \'10月\',[Quantity_11] as \'11月\',[Quantity_12] as \'12月\' FROM [SOADB].[dbo].[udt_report_Storage_InOut_GongXuChanLiang] WHERE YYYY=? ORDER BY [Product_Desc],[Sort]', 'tstart', '', '2019-07-23 09:11:11', '2019-07-23 09:30:02', '0');
INSERT INTO `sys_api` VALUES ('616', '00000000016', '1', '印钞专业物资收存报表', '3bccf5ab9f', 'SELECT [Prod_Code] as 物料编码  ,[Prod_Desc] as 物料名称  ,[MeteringUnit] as 计量单位 ,[Price] as 单价  ,[LastYearBalance] as 年初库存数量  ,[LastMonthBalance] as 月初库存数量  ,[MonthIn] as 收入数量  ,[MonthOut] as 付出数量  ,[MonthFaYun] as 发运数量  ,[MonthHeJi] as 合计  ,[MonthZaiTu] as 在途量  ,[MonthBalance] as 实际 ,[TotalPrice] as 库存金额  ,[TotalIn] as 累计收入数量  ,[TotalOut] as 累计付出数量  ,[TotalFaYun] as 累计发运数量  ,[Remark] as 备注 FROM [SOADB].[dbo].[udt_report_Storage_InOut_YinChaoZhuanYe_WuZi] where [YYYY_MM]=convert(nvarchar(7),cast(concat(?,\'01\') as datetime),120) order by [Prod_Desc]', 'tstart', '', '2019-07-23 11:51:23', '2019-07-23 17:59:04', '0');
INSERT INTO `sys_api` VALUES ('617', '00000000016', '1', '检封制作部各品种投入产出库存表', '9e4ea7198a', 'SELECT [YYYY_MM] as 日期    ,[Product_Desc] as 品种    ,[Product_ProdSize] as \'规格(K)\'    ,[ShouYinMa] as 收印码    ,[FuChengPin] as 付成品    ,[FuFeiPin] as 付废品    ,[ChengPinMonthBalance] as 成品结存    ,[FeiPinMonthBalance] as 废品结存    ,[LastChengPinMonthBalance] as 上月成品结存    ,[LastFeiPinMonthBalance] as 上月废品结存    ,[WeiCha] as 未查    ,[WeiZhuang] as 未装    ,[WeiFu] as 未付  FROM [SOADB].[dbo].[udt_report_Storage_InOut_JianFengZhiZuoGePinZhong]  where [YYYY_MM]=convert(nvarchar(7),cast(concat(?,\'01\') as datetime),120)  ORDER BY [Product_Desc]', 'tstart', '', '2019-07-23 15:21:53', '2019-07-23 15:48:22', '0');
INSERT INTO `sys_api` VALUES ('618', '00000000016', '1', '检封制作部生产月报表', '8c0f3617cf', 'SELECT [YYYY_MM] as 日期    ,[Product_Desc] as 品种    ,[GongXu_Desc] as 工序    ,[Unit_Desc] as 单位    ,[Plan_Month] as 计划当月    ,[Plan_Total] as 计划累计    ,[Real_Month] as 实际当月    ,[Real_Total] as 实际累计    ,[Compare_Total] as 比较累计  FROM [SOADB].[dbo].[udt_report_Storage_InOut_JianFengZhiZuo]  WHERE [YYYY_MM]=convert(nvarchar(7),cast(concat(?,\'01\') as datetime),120)  ORDER BY [Product_Desc],[Id]', 'tstart', '', '2019-07-23 16:18:14', '2019-07-23 16:31:58', '0');
INSERT INTO `sys_api` VALUES ('619', '00000000016', '1', '清分机各机台抽查产量统计表', 'af3ae14dae', 'SELECT [YYYY] as 年份    ,[Equ_Desc] as 机台    ,[Product_Desc] as 品种   ,[Prod_Line_Desc] as 类型    ,[ComQuantity_01] as 一月    ,[ComQuantity_02] as 二月    ,[ComQuantity_03] as 三月    ,[ComQuantity_04] as 四月    ,[ComQuantity_05] as 五月    ,[ComQuantity_06] as 六月    ,[ComQuantity_07] as 七月    ,[ComQuantity_08] as 八月    ,[ComQuantity_09] as 九月    ,[ComQuantity_10] as 十月    ,[ComQuantity_11] as 十一月    ,[ComQuantity_12] as 十二月  FROM [SOADB].[dbo].[udt_report_Storage_InOut_QingFenJi]  WHERE [YYYY]=?  ORDER BY [Equ_Desc],[Product_Desc],[Prod_Line_Desc]', 'tstart', '', '2019-07-24 11:11:10', '2019-07-24 11:11:10', '0');
INSERT INTO `sys_api` VALUES ('620', '00000000016', '1', '印钞数管部产品月报表 ', '70dd660038', 'SELECT [YYYY_MM] as 日期    ,[Product_Desc] as 品种    ,[Type_Desc] as 工序    ,[Location_SimpleDesc] as 类型    ,[LastMonthBalance] as 期初库存    ,[MonthIn] as 本期投入    ,[MonthFeiPin] as 本期废品    ,[MonthFuChuFeiPin] as 付出废品    ,[MonthFuChuYangZhang] as 付出样张    ,[MonthFuChuLiang] as 本期付出量    ,[MonthBalance] as 期末结存  FROM [SOADB].[dbo].[udt_report_Storage_InOut_YinChao]  WHERE [YYYY_MM]=convert(nvarchar(7),cast(concat(?,\'01\') as datetime),120)  ORDER BY [Product_Desc],[Id]', 'tstart', '', '2019-07-24 11:38:15', '2019-07-24 11:49:47', '0');
INSERT INTO `sys_api` VALUES ('621', '00000000002', '1', '产品过程质量控制水平月报', '4c11b44b89', 'WITH tempdata AS ( SELECT *,6 AS subdistance FROM noteaysdata WHERE ( [Date] BETWEEN ? AND ?) ) SELECT ProductType AS 品种,COUNT (*) AS 分析总量,ROUND( CASE WHEN a.ProductType = \'9607T\' THEN SUM (a.SMSignal) * 20 / COUNT (*) ELSE SUM (a.FingerLine + a.SMSignal) * 10 / COUNT (*) END,2 ) AS 胶凹得分_防伪,ROUND( CASE WHEN a.ProductType = \'9607T\' OR a.ProductType = \'9602A\' THEN SUM ( a.ofstfsub + ofstbsub + itgfsub + itgbsub ) / 86 / COUNT (*) * 100 ELSE SUM ( a.ofstfsub + ofstbsub + itgfsub + itgbsub ) / 84 / COUNT (*) * 100 END,2 ) AS 胶凹得分_小开仪,ROUND( SUM (a.WSignal + a.YG) * 10 / COUNT (*),2 ) AS 印码得分_防伪,ROUND( CASE WHEN a.ProductType = \'9607T\' THEN SUM (a.codesub) / 7 / COUNT (*) * 100 ELSE SUM (a.codesub) / 8 / COUNT (*) * 100 END,2 ) AS 印码得分_小开仪,ROUND( SUM (CutDistance) * 100 / COUNT (*) / subdistance,2 ) AS 裁切得分_小开仪,ROUND(SUM(b.score) / COUNT(*),2) AS 裁切得分_人工,ROUND( SUM ( CASE WHEN a.ProductType = \'9607T\' THEN ( a.FingerLine + a.WSignal + a.SMSignal + a.YG + a.VCode + a.OVMI ) + 0.7 * (a.TotalScore) ELSE ( a.FingerLine + a.WSignal + a.SMSignal + a.YG + a.VCode + a.OVMI ) + 0.8 * (a.TotalScore) END ) / COUNT (*),2 ) AS 总分 FROM tempdata a LEFT JOIN NoteAysCutManulData b ON a.id = b.note_ays_id WHERE ProductType <> \'\' GROUP BY ProductType,subdistance ORDER BY ProductType', 'tstart,tend', '', '2019-07-24 17:23:15', '2019-12-20 17:07:26', '0');
INSERT INTO `sys_api` VALUES ('622', '00000000002', '1', '印钞特抽抽检开位分布情况', '118ac82f6b', 'SELECT ProductType AS 品种,( CASE WHEN nKai < 0 THEN nKai + 10000 ELSE nKai END ) AS 开位,COUNT (*) AS 抽检量 FROM ( SELECT CAST (gznums AS INT) - CAST ( CAST (gznumber AS VARCHAR(4)) AS INT ) + 1 AS nKai,ProductType FROM ( SELECT DISTINCT a.producttype,a.gznum,b.gznumber,( CASE WHEN SUBSTRING (a.gznum,2,1) BETWEEN \\\'0\\\' AND \\\'9\\\' THEN SUBSTRING (a.gznum,2,1) ELSE \\\'\\\' END ) + ( CASE WHEN SUBSTRING (a.gznum,3,1) BETWEEN \\\'0\\\' AND \\\'9\\\' THEN SUBSTRING (a.gznum,3,1) ELSE \\\'\\\' END ) + ( CASE WHEN SUBSTRING (a.gznum,4,1) BETWEEN \\\'0\\\' AND \\\'9\\\' THEN SUBSTRING (a.gznum,4,1) ELSE \\\'\\\' END ) + ( CASE WHEN SUBSTRING (a.gznum,5,1) BETWEEN \\\'0\\\' AND \\\'9\\\' THEN SUBSTRING (a.gznum,5,1) ELSE \\\'\\\' END ) + ( CASE WHEN SUBSTRING (a.gznum,6,1) BETWEEN \\\'0\\\' AND \\\'9\\\' THEN SUBSTRING (a.gznum,6,1) ELSE \\\'\\\' END ) AS GZNums FROM ( SELECT id,producttype,SUBSTRING (gznum,1,6) AS GZNum FROM noteaysdata WHERE DATE BETWEEN ? AND ?) a INNER JOIN cartinfodata b ON a.id = b.noteanayid ) a ) a GROUP BY ProductType,( CASE WHEN nkai < 0 THEN nKai + 10000 ELSE nkai END ) ORDER BY 1,2', 'tstart,tend', '', '2019-07-24 17:28:09', '2019-07-24 17:28:09', '0');
INSERT INTO `sys_api` VALUES ('623', '00000000002', '1', '印钞特抽抽检千位分布情况', 'e069b98ca9', 'SELECT ProductType as 品种,GZNums AS 千位,COUNT(*) AS 抽检量 FROM (SELECT producttype,(CASE WHEN substring(GZNum,7,1) IN (\\\'o\\\',\\\'O\\\') THEN \\\'0\\\' ELSE substring(GZNum,7,1) END) AS GZNums,GZNum FROM noteaysdata WHERE date BETWEEN ? AND ?) a where GZNums between \\\'0\\\' and \\\'9\\\' and producttype<>\\\' \\\' GROUP BY ProductType,GZNums ORDER BY 1,2', 'tstart,tend', '', '2019-07-24 17:28:50', '2019-07-24 17:28:50', '0');
INSERT INTO `sys_api` VALUES ('624', '00000000002', '1', '印钞特抽抽检异常车号列表', '92a3503703', 'SELECT DISTINCT b.CartNumber AS 车号,a.GZNum AS 印码号,a.Date as 抽检日期 FROM NoteAysData a INNER JOIN CartInfoData b ON a.ID = b.NoteAnayID WHERE (b.CartNumber IN (SELECT CartNumber FROM (SELECT DISTINCT substring(gznum,7,1) AS Kilo,(CASE WHEN substring(gznum,7,1) > \\\'4\\\' THEN 1 ELSE - 1 END) AS kilos,b.CartNumber FROM NoteAysData a INNER JOIN CartInfoData b ON a.ID = b.NoteAnayID WHERE a.date between ? and ?) DERIVEDTBL GROUP BY CartNumber HAVING (COUNT(Kilo) IN (1,2)) AND (SUM(kilos) <> 0))) ORDER BY b.CartNumber', 'tstart,tend', '', '2019-07-24 17:29:52', '2019-07-24 17:29:52', '0');
INSERT INTO `sys_api` VALUES ('625', '00000000002', '1', '特抽班产品质量控制水平机台汇总', '3bb0f50376', 'SELECT a.ProductType AS 品种,a.ProcName AS 工序,a.CaptainName AS 机长,COUNT (*) AS 抽检量,round( SUM (a.physicScore) / COUNT (*),2 ) AS 机读防伪得分,round( SUM (a.physicRatio) / COUNT (*),2 ) AS 机读防伪精品率,round( SUM (a.machineScore) / COUNT (*),2 ) AS 单开分析得分,round( SUM (a.machineRatio) / COUNT (*),2 ) AS 单开分析精品率,round( SUM (a.ManualCutScore) / COUNT (*),2 ) AS 人工裁切评分 ,round(sum(case when physicRatio=0 then (case when ManualCutScore=0 then machineRatio else machineRatio*0.7 + ManualCutScore*0.3 end) else machineRatio*0.8 + physicRatio*0.2 end )/count(*),2) as 总分 FROM dbo.view_print_note_ananysis_score AS a WHERE a.[date] between ? and ? GROUP BY ProductType,procname,captainname,procid ORDER BY 1,procid,8 DESC', 'tstart,tend', '', '2019-07-24 17:31:29', '2019-07-24 17:31:29', '0');
INSERT INTO `sys_api` VALUES ('626', '00000000002', '1', '特抽班产品质量控制水平工序汇总', '125d75ab8e', 'SELECT a.ProductType AS 品种,a.ProcName AS 工序,COUNT (*) AS 抽检量,round( SUM (a.physicScore) / COUNT (*),2 ) AS 机读防伪得分,round( SUM (a.physicRatio) / COUNT (*),2 ) AS 机读防伪精品率,round( SUM (a.machineScore) / COUNT (*),2 ) AS 单开分析得分,round( SUM (a.machineRatio) / COUNT (*),2 ) AS 单开分析精品率,round( SUM (a.ManualCutScore) / COUNT (*),2 ) AS 人工裁切评分,round(sum(case when physicRatio=0 then (case when ManualCutScore=0 then machineRatio else machineRatio*0.7 + ManualCutScore*0.3 end) else machineRatio*0.8 + physicRatio*0.2 end )/count(*),2) as 总分 FROM dbo.view_print_note_ananysis_score AS a WHERE a.[date] between ? and ? GROUP BY ProductType,procname,procid ORDER BY 1,procid,8 DESC', 'tstart,tend', '', '2019-07-24 17:31:50', '2019-07-24 17:31:50', '0');
INSERT INTO `sys_api` VALUES ('627', '00000000002', '1', '特抽班产品质量控制水平统计报告', '2409b33bca', 'SELECT a.ProductType AS 品种,round(SUM(a.cutRatio),0) AS 裁切机检总分,round(AVG(a.cutRatio),2) AS 裁切机检精品率,SUM (a.ManualCutScore) AS 裁切人工总分,round(AVG(a.ManualCutScore),2) AS 裁切人工得分,round( AVG ( a.ManualCutScore * 0.3 + a.cutRatio * 0.7 ),2 ) AS 裁切得分 FROM dbo.view_print_note_ananysis_score AS a WHERE a.ProcName LIKE \\\'裁%\\\' AND a.[date] BETWEEN ? AND ? GROUP BY ProductType', 'tstart,tend', '', '2019-07-24 17:33:29', '2019-07-24 17:33:29', '0');
INSERT INTO `sys_api` VALUES ('628', '00000000002', '1', '印钞特抽每日分析量', '6e660b2ad3', 'SELECT a.[date] as 日期,a.ProductType AS 品种,count(*) AS 分析量,round(avg(a.cutRatio),2) AS 裁切精品率,round(avg(a.ManualCutScore),2) AS 裁切人工评分,round(avg(a.machineRatio),2) AS 过程质量控制水平 FROM dbo.view_print_note_ananysis_score AS a where a.[date] between ? and ? group by a.[date],a.ProductType', 'tstart,tend', '', '2019-07-24 17:33:45', '2019-07-24 17:33:45', '0');
INSERT INTO `sys_api` VALUES ('629', '00000000002', '1', '特抽班质量原始数据报表 ', 'b5a4be8fa9', 'SELECT DISTINCT a.[Date] AS 抽检日期,b.CartNumber AS 车号,a.GZNum AS 印码号,(  CASE  WHEN a.FakeDesc = \\\'0\\\' THEN  \\\'无\\\'  ELSE  a.FakeDesc  END ) AS 备注,ROUND(  (  CASE  WHEN a.ProductType = \\\'9607T\\\' THEN   (   a.FingerLine + a.WSignal + a.SMSignal + a.YG + a.VCode + a.OVMI   ) + 0.7 * (a.TotalScore)  ELSE   (   a.FingerLine + a.WSignal + a.SMSignal + a.YG + a.VCode + a.OVMI   ) + 0.8 * (a.TotalScore)  END  ), 2 ) AS 评价总分,a.FingerLine + a.WSignal + a.SMSignal + a.YG + a.VCode + a.OVMI AS 机读防伪,a.WSignal AS W信号,a.SMSignal AS SM信号,a.YG AS 荧光亮度,a.VCode AS 竖号码,a.OVMI AS OVMI,a.FingerLine AS 手感线,a.TotalScore AS 外观总分,a.OfstFSub AS 胶正综合,a.OfstFInk AS 胶正墨色,a.OfstFLineWidth AS 胶正线宽,a.OfstFSafeCircle AS 胶正防复印圆,a.OfstFLineConn AS 胶正接线,a.OfstFMix AS 胶正混色,a.OfstFDuiYin AS 胶正对印,a.OfstBSub AS 胶背综合,a.OfstBInk AS 胶背黑色,a.OfstBLineWidth AS 胶背线宽,a.OfstBSafeCircle AS 胶背防复印圈,a.OfstBOIOver AS 胶背套印,a.OfstBMix AS 胶背混色,a.OfstBDuiYin AS 胶背对印,a.ItgFSub AS 凹正综合,a.ItgFInk AS 凹正墨色,a.ItgFOIOver AS 凹正套印,a.ItgFLineConn AS 凹正接线,a.ItgBSub AS 凹背综合,a.ItgBMix AS 凹背墨色,a.ItgBOIOver AS 凹背套印,a.ItgBLineConn AS 凹背接线,a.CodeSub AS 印码综合,a.CodeDistance AS 印码规格,a.CodeInk AS 印码墨色,a.CodeMixColor AS 印码串色,a.CodeFake AS 印码缺陷,a.CodeYG AS 印码荧光,a.CutDistance AS 裁切规格,a.PaperSub AS 纸张综合,a.PaperWarterMark AS 纸张水印,a.PaperSafeLine AS 纸张安全线,a.ProductType AS 品种 FROM NoteAysData a INNER JOIN CartInfoData b ON a.ID = b.NoteAnayID WHERE a.[Date] BETWEEN ? AND ?', 'tstart,tend', '', '2019-07-24 17:36:37', '2019-07-24 17:36:37', '0');
INSERT INTO `sys_api` VALUES ('630', '00000000002', '1', '9607T品平均开包量', '3d935263e1', 'SELECT a.印刷日期,avg(a.[开包量]) 开包量 FROM view_print_ocr_offanditg a WHERE a.检封日期 BETWEEN ? AND ? and 品种=\'9607T\' and 工序=? group by a.印刷日期 having count(*)>10 order by 1', 'tstart,tend,prefix', '', '2019-07-24 18:17:02', '2019-07-24 18:24:39', '0');
INSERT INTO `sys_api` VALUES ('631', '00000000002', '1', '9607T品平均小开废', '0dd3529db1', 'SELECT a.印刷日期,avg(a.[小开总数]) 小开总数 FROM view_print_ocr_offanditg a WHERE a.检封日期 BETWEEN ? AND ? and 品种=\'9607T\' and 工序=? group by a.印刷日期 having count(*)>10 order by 1', 'tstart,tend,prefix', '', '2019-07-24 18:21:00', '2019-07-24 18:24:46', '0');
INSERT INTO `sys_api` VALUES ('632', '00000000002', '1', '工序', '580cbb51bd', 'select distinct procname name,procname value from CartInfoData where procname like \\\'%印%\\\'', '', '', '2019-07-24 18:23:50', '2019-07-24 18:23:50', '0');
INSERT INTO `sys_api` VALUES ('633', '00000000016', '1', '裁封自动线开包量对比', 'bfce804096', 'SELECT b.[品种],b.[机长],AVG (a.opennum) AS [期望开包量],AVG (a.ex_opennum) 实际开包量,AVG (a.fake_num) 实废小开,AVG (a.leak_num) 多取出,count(*) 大万数 FROM tbl_cbpc_batch_opennum a LEFT JOIN v_cbpc_cartlist b ON a.cart = b.车号 WHERE CONVERT (VARCHAR,产量时间,112) BETWEEN ? AND ? AND b.工序 IN (\'裁切\',\'裁封\') AND b.车号 IS NOT NULL AND ex_opennum > 0 and 机长 is not null GROUP BY b.[品种],b.[机长] having count(*)>10 order by 1,4', 'tstart,tend', '', '2019-07-24 19:20:12', '2019-07-24 19:20:28', '0');
INSERT INTO `sys_api` VALUES ('634', '00000000016', '1', '大误分仓开包量原始数据记录', '711b9b6799', 'SELECT b.[车号],b.品种,b.[工序],b.[机台],b.[机长],b.[产量时间],a.opennum AS [期望开包量],a.ex_opennum 实际开包量,a.ex_opennum_kilo0 第0千位开包量,round(  CAST (a.ex_opennum_kilo0 AS FLOAT) / a.ex_opennum * 100, 2 ) 开包量占比,a.fake_num 实废小开,a.leak_num 多取出,a.fake_num_kilo0 第0千位实废小开,round(  CAST (a.fake_num_kilo0 AS FLOAT) / a.fake_num * 100, 2 ) 实废占比 FROM tbl_cbpc_batch_opennum a LEFT JOIN v_cbpc_cartlist b ON a.cart = b.车号 WHERE CONVERT (VARCHAR,a.rec_time,112) BETWEEN ? AND ? and b.[产量时间]>=\\\'2019-06-01\\\' AND b.工序 IN (\\\'凹一印\\\',\\\'凹二印\\\') AND b.车号 IS NOT NULL AND ex_opennum > 0 order by 6 desc', 'tstart,tend', '', '2019-07-24 19:52:14', '2019-07-24 19:52:14', '0');
INSERT INTO `sys_api` VALUES ('635', '00000000016', '1', '9607T品机台开包量曲线图', '9f2a0d07bd', 'SELECT b.[机台],CONVERT (  VARCHAR, b.[产量时间], 112 ) 印刷日期,AVG (a.opennum) AS [期望开包量],AVG (a.ex_opennum) 实际开包量,AVG (a.ex_opennum_kilo0) 第0千位开包量,round(  AVG (  CAST (a.ex_opennum_kilo0 AS FLOAT) / a.ex_opennum * 100  ), 2 ) 开包量占比,AVG (a.fake_num) 实废小开,AVG (a.leak_num) 多取出,AVG (a.fake_num_kilo0) 第0千位实废小开,round(  AVG (  CAST (a.fake_num_kilo0 AS FLOAT) / a.fake_num * 100  ), 2 ) 实废占比 FROM tbl_cbpc_batch_opennum a LEFT JOIN v_cbpc_cartlist b ON a.cart = b.车号 WHERE CONVERT (VARCHAR,a.rec_time,112) BETWEEN ? AND ?  AND b.工序 IN (\'凹一印\',\'凹二印\') AND b.车号 IS NOT NULL AND b.品种 = \'9607T\' AND ex_opennum > 0 GROUP BY b.[机台],CONVERT (  VARCHAR, b.[产量时间], 112 )', 'tstart,tend', '', '2019-07-24 19:55:58', '2019-07-26 11:21:16', '0');
INSERT INTO `sys_api` VALUES ('636', '00000000016', '1', '裁封线各机长抽连号情况', 'a0eb70e6f3', 'SELECT b.[机长],CONVERT (VARCHAR(6),产量时间,112) 生产时间,AVG (a.leak_num) 多取出 ,AVG (a.ex_opennum)-AVG (a.opennum) AS [抽连号开包量]FROM tbl_cbpc_batch_opennum a LEFT JOIN v_cbpc_cartlist b ON a.cart = b.车号 WHERE CONVERT (VARCHAR,产量时间,112) BETWEEN ? AND ? AND b.工序 IN (\'裁切\',\'裁封\') AND b.车号 IS NOT NULL AND ex_opennum > 0 and 机长 is not null and 品种=\'9607T\' GROUP BY CONVERT (VARCHAR(6),产量时间,112) ,b.[机长] having AVG (a.ex_opennum)-AVG (a.opennum)>0 and count(*)>10 order by 1,2,3', 'tstart,tend', '', '2019-07-24 20:10:36', '2019-07-24 20:18:45', '0');
INSERT INTO `sys_api` VALUES ('637', '00000000016', '1', '凹印工序精品机台列表', 'c66db16688', 'WITH prod_list AS ( SELECT prod_id FROM Products_Base WHERE SUBSTRING (prod_desc,4,5) = \'9607T\' ),change_log AS ( SELECT a.CarNumber AS cart_number,SUM (CAST(a.Quantity AS INT)) exchange_quantity FROM udt_ps_Exchange a INNER JOIN prod_list b ON a.prod_id = b.prod_id WHERE a.unit = 51082 AND CONVERT ( VARCHAR,CAST (a.ExchangeTime AS datetime),112 ) BETWEEN CONVERT ( VARCHAR,dateadd(MONTH ,- 1,getdate()),112 ) AND CONVERT (VARCHAR,GETDATE(),112) GROUP BY a.CarNumber ),change_record AS ( SELECT DISTINCT b.* FROM change_log b LEFT JOIN dbo.udt_pp_MachineProcess a ON b.cart_number = a.CarNumber LEFT JOIN udt_tb_WipInventory wipInv ON wipInv.WI_Id = a.BusinessWiid WHERE CrownWordStartNum IS NOT NULL AND wipInv.ProcessLine_Desc = \'码后核查工艺\' ),fakeList AS ( SELECT b.工序 proc_name,b.Class_ID,b.Equipment,b.pu_desc,b.erp_code,AVG (exchange_quantity) fake_num,COUNT (*) cart_num FROM change_record a INNER JOIN dbo.udt_pp_MachineProcess udp_pp ON a.cart_number = udp_pp.CarNumber INNER JOIN udt_tb_WipInventory wipInv ON wipInv.WI_Id = udp_pp.BusinessWiid INNER JOIN ( SELECT a.CarNumber AS [车号],b.Path_Desc AS [工序],r.erpcode erp_code,r.pu_desc,r.PU_Id Class_ID,a.Equipment FROM dbo.udt_pp_MachineProcess a LEFT JOIN Prdexec_Paths b ON b.Path_Id = a.TargetProcess LEFT JOIN v_cbpc_classinfo r ON r.PU_Id = a.MachineTeam WHERE a.CarNumber IS NOT NULL and r.PU_Desc<>\'凹印况东机台\' ) b ON a.cart_number = b.车号 WHERE b.工序 LIKE \'凹%\' GROUP BY 工序,b.pu_desc,erp_code,b.Class_ID,b.Equipment HAVING COUNT (*) > 50 ),prodinfo AS ( SELECT proc_name,erp_code,replace( replace(pu_desc,\'凹印\',\'\'),\'机台\',\'\' ) machine,Class_ID,fake_num,equipment machine_id FROM ( SELECT  row_number () OVER (  partition BY proc_name  ORDER BY  proc_name, fake_num, (  CASE replace(   replace(pu_desc,\'凹印\',\'\'), \'机台\', \'\'  )  WHEN \'杨平\' THEN   0  WHEN \'任晓军\' THEN   0  when \'刘潺\' then 0  WHEN \'蔡勇\' THEN   0  ELSE   1  END  )  ) rn ,* FROM  fakeList ) a WHERE a.rn <= 2 ) SELECT r.*,n.pu_desc_alias machine_name FROM prodinfo r LEFT JOIN tbl_cbpc_prod_units_base n ON r.machine_id = n.pu_id', '', '', '2019-07-26 08:38:34', '2019-08-12 10:54:11', '0');
INSERT INTO `sys_api` VALUES ('638', '00000000016', '1', '印钞工序各产线生产完成情况(按月)', 'f141aea715', 'WITH cartlist AS ( SELECT LEFT (生产日期,6) 月份,机型,SUM (产量) 产量,COUNT ( DISTINCT 生产日期 + 班次 ) 台班 FROM ( SELECT  CONVERT (VARCHAR,产量时间,112) 生产日期,机型,产量,班次 FROM  v_cbpc_cartlist WHERE  机型 NOT LIKE \'%挑残%\' AND 机型 NOT LIKE \'%XCJ%\' AND 机型 NOT LIKE \'%X1%\' AND 机型 NOT LIKE \'%数数%\' AND 机型 NOT LIKE \'%人工大张%\' AND 机型 NOT LIKE \'%波拉%\' AND 机型 NOT LIKE \'%装箱%\' AND 机型 NOT LIKE \'%涂布%\' AND CONVERT (  VARCHAR (6),产量时间,112 ) BETWEEN ? AND ? ) a GROUP BY LEFT (生产日期,6),机型 ),prodlist AS ( SELECT 月份,( CASE WHEN 机型 LIKE \'%J98%\' THEN  \'1.1.J98\' WHEN 机型 LIKE \'%海德堡%\' THEN  \'1.2.海德堡\' WHEN 机型 LIKE \'%小森四色%\' THEN  \'1.3.小森四色\' WHEN 机型 LIKE \'%小森%八色%\' THEN  \'1.4.小森八色\' WHEN 机型 LIKE \'%SD%\' THEN  \'2.1.SD\' WHEN 机型 LIKE \'%W92%\' THEN  \'2.2.W92型\' WHEN 机型 LIKE \'%超级接线凹印机A%\' OR 机型 LIKE \'%超级接线凹印机B%\' THEN  \'2.3.超凹1-2代\' WHEN 机型 LIKE \'%超级接线凹印机C%\' THEN  \'2.4.超凹3代\' WHEN 机型 LIKE \'%W10%\' THEN  \'2.5.W10\' WHEN 机型 LIKE \'%多功能印码%\' THEN  \'3.1.多功能机\' WHEN 机型 LIKE \'%DMJ12%\' THEN  \'3.2.DMJ12\' WHEN 机型 LIKE \'%M97%\' THEN  \'3.3.M97\' WHEN 机型 LIKE \'%M81D%\' THEN  \'3.4.M81D\' WHEN 机型 LIKE \'%涂布%\' THEN  \'3.5.涂布\' WHEN 机型 LIKE \'%DMK08A%\' THEN  (  CASE  WHEN 机型 LIKE \'%DMK08A-1%\' THEN  \'3.6.丝凸检\'  ELSE  \'3.7.丝凸机\'  END  ) WHEN 机型 LIKE \'%自动线%\' THEN  (  CASE  WHEN 机型 LIKE \'%自动线10%\'  OR 机型 LIKE \'%自动线9%\'  OR 机型 LIKE \'%自动线8%\' THEN  \'4.2.自动线8-10\'  ELSE  \'4.1.自动线1-7\'  END  ) WHEN 机型 LIKE \'%BPS2000%\' THEN  \'4.4.进口清分机\' ELSE  机型 END ) 机型,SUM (产量) 产量,SUM (台班) 台班 FROM cartlist a GROUP BY 月份,( CASE WHEN 机型 LIKE \'%J98%\' THEN  \'1.1.J98\' WHEN 机型 LIKE \'%海德堡%\' THEN  \'1.2.海德堡\' WHEN 机型 LIKE \'%小森四色%\' THEN  \'1.3.小森四色\' WHEN 机型 LIKE \'%小森%八色%\' THEN  \'1.4.小森八色\' WHEN 机型 LIKE \'%SD%\' THEN  \'2.1.SD\' WHEN 机型 LIKE \'%W92%\' THEN  \'2.2.W92型\' WHEN 机型 LIKE \'%超级接线凹印机A%\' OR 机型 LIKE \'%超级接线凹印机B%\' THEN  \'2.3.超凹1-2代\' WHEN 机型 LIKE \'%超级接线凹印机C%\' THEN  \'2.4.超凹3代\' WHEN 机型 LIKE \'%W10%\' THEN  \'2.5.W10\' WHEN 机型 LIKE \'%多功能印码%\' THEN  \'3.1.多功能机\' WHEN 机型 LIKE \'%DMJ12%\' THEN  \'3.2.DMJ12\' WHEN 机型 LIKE \'%M97%\' THEN  \'3.3.M97\' WHEN 机型 LIKE \'%M81D%\' THEN  \'3.4.M81D\' WHEN 机型 LIKE \'%涂布%\' THEN  \'3.5.涂布\' WHEN 机型 LIKE \'%DMK08A%\' THEN  (  CASE  WHEN 机型 LIKE \'%DMK08A-1%\' THEN  \'3.6.丝凸检\'  ELSE  \'3.7.丝凸机\'  END  ) WHEN 机型 LIKE \'%自动线%\' THEN  (  CASE  WHEN 机型 LIKE \'%自动线10%\'  OR 机型 LIKE \'%自动线9%\'  OR 机型 LIKE \'%自动线8%\' THEN  \'4.2.自动线8-10\'  ELSE  \'4.1.自动线1-7\'  END  ) WHEN 机型 LIKE \'%BPS2000%\' THEN  \'4.4.进口清分机\' ELSE  机型 END ) ),proddetail as (SELECT 月份,SUBSTRING (机型,5,len(机型)) 机型,产量 / ( CASE WHEN 机型 LIKE \'%自动线%\' OR 机型 LIKE \'%清分%\' THEN 350 ELSE 10000 END ) 产量,台班,round( CAST (产量 AS FLOAT) / 台班 / ( CASE WHEN 机型 LIKE \'%自动线%\' OR 机型 LIKE \'%清分%\' THEN  350 ELSE  10000 END ),2 ) 台班产量,( CASE WHEN 机型 LIKE \'%J98%\' THEN 5.28 * 90 / 88 WHEN 机型 LIKE \'%海德堡%\' THEN 6.6 WHEN 机型 LIKE \'%小森四色%\' THEN 6.6 WHEN 机型 LIKE \'%小森八色%\' THEN 6.05 WHEN 机型 LIKE \'%接线印码%\' OR 机型 LIKE \'%丝凸%\' THEN 4.8 WHEN 机型 LIKE \'%SD%\' THEN 5.76 WHEN 机型 LIKE \'%W92型%\' THEN 5.632 * 90 / 88 WHEN 机型 LIKE \'%超凹1-2%\' THEN 5.632 * 90 / 88 WHEN 机型 LIKE \'%超凹3%\' THEN 6.08 WHEN 机型 LIKE \'%W10%\' THEN 5.76 WHEN 机型 LIKE \'%多功能机%\' THEN 4.84 WHEN 机型 LIKE \'%DMJ12%\' THEN 4.95 WHEN 机型 LIKE \'%M97%\' THEN 4.48 WHEN 机型 LIKE \'%M81D%\' THEN 3.99 WHEN 机型 LIKE \'%自动线1-7%\' THEN 7.2 WHEN 机型 LIKE \'%自动线8-10%\' THEN 4.96 WHEN 机型 LIKE \'%进口清分机%\' THEN 2.4 ELSE 1 END ) 定额 FROM prodlist) select *,round(100*台班产量/定额,2) 完成比例 from proddetail', 'tstart,tend', '', '2019-07-26 14:00:34', '2019-07-26 14:20:55', '0');
INSERT INTO `sys_api` VALUES ('639', '00000000016', '1', '印钞机台产量完成情况', '444f56f9b3', 'WITH cartlist AS ( SELECT  LEFT (生产日期,6) 月份, 机型,机台, SUM (产量) 产量, COUNT (  DISTINCT 生产日期 + 班次  ) 台班 FROM  (  SELECT   CONVERT (VARCHAR,产量时间,112) 生产日期,  机型,机台,  产量,  班次  FROM   v_cbpc_cartlist  WHERE   机型 NOT LIKE \\\'%挑残%\\\'  AND 机型 NOT LIKE \\\'%XCJ%\\\'  AND 机型 NOT LIKE \\\'%X1%\\\'  AND 机型 NOT LIKE \\\'%数数%\\\'  AND 机型 NOT LIKE \\\'%人工大张%\\\'  AND 机型 NOT LIKE \\\'%波拉%\\\'  AND 机型 NOT LIKE \\\'%涂布%\\\' and 机型 NOT LIKE \\\'%装箱%\\\'  AND CONVERT (   VARCHAR (6),  产量时间,  112  ) BETWEEN ?  AND ?  ) a GROUP BY 机台, LEFT (生产日期,6), 机型 ),prodlist AS ( SELECT  月份, (  CASE  WHEN 机型 LIKE \\\'%J98%\\\' THEN   \\\'1.1.J98\\\'  WHEN 机型 LIKE \\\'%海德堡%\\\' THEN   \\\'1.2.海德堡\\\'  WHEN 机型 LIKE \\\'%小森四色%\\\' THEN   \\\'1.3.小森四色\\\'  WHEN 机型 LIKE \\\'%小森%八色%\\\' THEN   \\\'1.4.小森八色\\\'  WHEN 机型 LIKE \\\'%SD%\\\' THEN   \\\'2.1.SD\\\'  WHEN 机型 LIKE \\\'%W92%\\\' THEN   \\\'2.2.W92型\\\'  WHEN 机型 LIKE \\\'%超级接线凹印机A%\\\'  OR 机型 LIKE \\\'%超级接线凹印机B%\\\' THEN   \\\'2.3.超凹1-2代\\\'  WHEN 机型 LIKE \\\'%超级接线凹印机C%\\\' THEN   \\\'2.4.超凹3代\\\'  WHEN 机型 LIKE \\\'%W10%\\\' THEN   \\\'2.5.W10\\\'  WHEN 机型 LIKE \\\'%多功能印码%\\\' THEN   \\\'3.1.多功能机\\\'  WHEN 机型 LIKE \\\'%DMJ12%\\\' THEN   \\\'3.2.DMJ12\\\'  WHEN 机型 LIKE \\\'%M97%\\\' THEN   \\\'3.3.M97\\\'  WHEN 机型 LIKE \\\'%M81D%\\\' THEN   \\\'3.4.M81D\\\'  WHEN 机型 LIKE \\\'%涂布%\\\' THEN   \\\'3.5.涂布\\\'  WHEN 机型 LIKE \\\'%DMK08A%\\\' THEN   (   CASE   WHEN 机型 LIKE \\\'%DMK08A-1%\\\' THEN    \\\'3.6.丝凸检\\\'   ELSE    \\\'3.7.丝凸机\\\'   END   )  WHEN 机型 LIKE \\\'%自动线%\\\' THEN   (   CASE   WHEN 机型 LIKE \\\'%自动线10%\\\'   OR 机型 LIKE \\\'%自动线9%\\\'   OR 机型 LIKE \\\'%自动线8%\\\' THEN    \\\'4.2.自动线8-10\\\'   ELSE    \\\'4.1.自动线1-7\\\'   END   )  WHEN 机型 LIKE \\\'%BPS2000%\\\' THEN   \\\'4.4.进口清分机\\\'   ELSE   机型  END  ) 机型,机台, SUM (产量) 产量, SUM (台班) 台班 FROM  cartlist a GROUP BY 机台, 月份, (  CASE  WHEN 机型 LIKE \\\'%J98%\\\' THEN   \\\'1.1.J98\\\'  WHEN 机型 LIKE \\\'%海德堡%\\\' THEN   \\\'1.2.海德堡\\\'  WHEN 机型 LIKE \\\'%小森四色%\\\' THEN   \\\'1.3.小森四色\\\'  WHEN 机型 LIKE \\\'%小森%八色%\\\' THEN   \\\'1.4.小森八色\\\'  WHEN 机型 LIKE \\\'%SD%\\\' THEN   \\\'2.1.SD\\\'  WHEN 机型 LIKE \\\'%W92%\\\' THEN   \\\'2.2.W92型\\\'  WHEN 机型 LIKE \\\'%超级接线凹印机A%\\\'  OR 机型 LIKE \\\'%超级接线凹印机B%\\\' THEN   \\\'2.3.超凹1-2代\\\'  WHEN 机型 LIKE \\\'%超级接线凹印机C%\\\' THEN   \\\'2.4.超凹3代\\\'  WHEN 机型 LIKE \\\'%W10%\\\' THEN   \\\'2.5.W10\\\'  WHEN 机型 LIKE \\\'%多功能印码%\\\' THEN   \\\'3.1.多功能机\\\'  WHEN 机型 LIKE \\\'%DMJ12%\\\' THEN   \\\'3.2.DMJ12\\\'  WHEN 机型 LIKE \\\'%M97%\\\' THEN   \\\'3.3.M97\\\'  WHEN 机型 LIKE \\\'%M81D%\\\' THEN   \\\'3.4.M81D\\\'  WHEN 机型 LIKE \\\'%涂布%\\\' THEN   \\\'3.5.涂布\\\'  WHEN 机型 LIKE \\\'%DMK08A%\\\' THEN   (   CASE   WHEN 机型 LIKE \\\'%DMK08A-1%\\\' THEN    \\\'3.6.丝凸检\\\'   ELSE    \\\'3.7.丝凸机\\\'   END   )  WHEN 机型 LIKE \\\'%自动线%\\\' THEN   (   CASE   WHEN 机型 LIKE \\\'%自动线10%\\\'   OR 机型 LIKE \\\'%自动线9%\\\'   OR 机型 LIKE \\\'%自动线8%\\\' THEN    \\\'4.2.自动线8-10\\\'   ELSE    \\\'4.1.自动线1-7\\\'   END   )  WHEN 机型 LIKE \\\'%BPS2000%\\\' THEN   \\\'4.4.进口清分机\\\'   ELSE   机型  END  ) ),proddetail as (SELECT 月份,机台,SUBSTRING (机型,5,len(机型)) 机型,产量 / (  CASE  WHEN 机型 LIKE \\\'%自动线%\\\'  OR 机型 LIKE \\\'%清分%\\\' THEN  350  ELSE  10000  END ) 产量,台班,round(  CAST (产量 AS FLOAT) / 台班 / (  CASE  WHEN 机型 LIKE \\\'%自动线%\\\'  OR 机型 LIKE \\\'%清分%\\\' THEN   350  ELSE   10000  END  ), 2 ) 台班产量,(  CASE  WHEN 机型 LIKE \\\'%J98%\\\' THEN  5.28 * 90 / 88  WHEN 机型 LIKE \\\'%海德堡%\\\' THEN  6.6  WHEN 机型 LIKE \\\'%小森四色%\\\' THEN  6.6  WHEN 机型 LIKE \\\'%小森八色%\\\' THEN  6.05  WHEN 机型 LIKE \\\'%接线印码%\\\'  OR 机型 LIKE \\\'%丝凸%\\\' THEN  4.8  WHEN 机型 LIKE \\\'%SD%\\\' THEN  5.76  WHEN 机型 LIKE \\\'%W92型%\\\' THEN  5.632 * 90 / 88  WHEN 机型 LIKE \\\'%超凹1-2%\\\' THEN  5.632 * 90 / 88  WHEN 机型 LIKE \\\'%超凹3%\\\' THEN  6.08  WHEN 机型 LIKE \\\'%W10%\\\' THEN  5.76  WHEN 机型 LIKE \\\'%多功能机%\\\' THEN  4.84  WHEN 机型 LIKE \\\'%DMJ12%\\\' THEN  4.95  WHEN 机型 LIKE \\\'%M97%\\\' THEN  4.48  WHEN 机型 LIKE \\\'%M81D%\\\' THEN  3.99  WHEN 机型 LIKE \\\'%自动线1-7%\\\' THEN  7.2  WHEN 机型 LIKE \\\'%自动线8-10%\\\' THEN  4.96  WHEN 机型 LIKE \\\'%进口清分机%\\\' THEN  2.4  ELSE  1  END ) 定额 FROM prodlist) select *,round(100*台班产量/定额,2) 完成比例 from proddetail', 'tstart,tend', '', '2019-07-26 14:18:25', '2019-07-26 14:18:25', '0');
INSERT INTO `sys_api` VALUES ('640', '00000000016', '1', '印钞工序生产完成情况', '011e01932f', 'WITH cartlist AS ( SELECT  机型, SUM (产量) 产量, COUNT (  DISTINCT 生产日期 + 班次  ) 台班 FROM  (  SELECT   CONVERT (VARCHAR,产量时间,112) 生产日期,  机型,  产量,  班次  FROM   v_cbpc_cartlist  WHERE   机型 NOT LIKE \\\'%挑残%\\\'  AND 机型 NOT LIKE \\\'%XCJ%\\\'  AND 机型 NOT LIKE \\\'%X1%\\\'  AND 机型 NOT LIKE \\\'%数数%\\\'  AND 机型 NOT LIKE \\\'%人工大张%\\\'  AND 机型 NOT LIKE \\\'%波拉%\\\'  AND 机型 NOT LIKE \\\'%装箱%\\\'  AND 机型 NOT LIKE \\\'%涂布%\\\'  AND CONVERT (   VARCHAR (6),  产量时间,  112  ) BETWEEN ?  AND ?  ) a GROUP BY  LEFT (生产日期,6), 机型 ),prodlist AS ( SELECT  (  CASE  WHEN 机型 LIKE \\\'%J98%\\\' THEN   \\\'1.1.J98\\\'  WHEN 机型 LIKE \\\'%海德堡%\\\' THEN   \\\'1.2.海德堡\\\'  WHEN 机型 LIKE \\\'%小森四色%\\\' THEN   \\\'1.3.小森四色\\\'  WHEN 机型 LIKE \\\'%小森%八色%\\\' THEN   \\\'1.4.小森八色\\\'  WHEN 机型 LIKE \\\'%SD%\\\' THEN   \\\'2.1.SD\\\'  WHEN 机型 LIKE \\\'%W92%\\\' THEN   \\\'2.2.W92型\\\'  WHEN 机型 LIKE \\\'%超级接线凹印机A%\\\'  OR 机型 LIKE \\\'%超级接线凹印机B%\\\' THEN   \\\'2.3.超凹1-2代\\\'  WHEN 机型 LIKE \\\'%超级接线凹印机C%\\\' THEN   \\\'2.4.超凹3代\\\'  WHEN 机型 LIKE \\\'%W10%\\\' THEN   \\\'2.5.W10\\\'  WHEN 机型 LIKE \\\'%多功能印码%\\\' THEN   \\\'3.1.多功能机\\\'  WHEN 机型 LIKE \\\'%DMJ12%\\\' THEN   \\\'3.2.DMJ12\\\'  WHEN 机型 LIKE \\\'%M97%\\\' THEN   \\\'3.3.M97\\\'  WHEN 机型 LIKE \\\'%M81D%\\\' THEN   \\\'3.4.M81D\\\'  WHEN 机型 LIKE \\\'%涂布%\\\' THEN   \\\'3.5.涂布\\\'  WHEN 机型 LIKE \\\'%DMK08A%\\\' THEN   (   CASE   WHEN 机型 LIKE \\\'%DMK08A-1%\\\' THEN    \\\'3.6.丝凸检\\\'   ELSE    \\\'3.7.丝凸机\\\'   END   )  WHEN 机型 LIKE \\\'%自动线%\\\' THEN   (   CASE   WHEN 机型 LIKE \\\'%自动线10%\\\'   OR 机型 LIKE \\\'%自动线9%\\\'   OR 机型 LIKE \\\'%自动线8%\\\' THEN    \\\'4.2.自动线8-10\\\'   ELSE    \\\'4.1.自动线1-7\\\'   END   )  WHEN 机型 LIKE \\\'%BPS2000%\\\' THEN   \\\'4.4.进口清分机\\\'  ELSE   机型  END  ) 机型, SUM (产量) 产量, SUM (台班) 台班 FROM  cartlist a GROUP BY  (  CASE  WHEN 机型 LIKE \\\'%J98%\\\' THEN   \\\'1.1.J98\\\'  WHEN 机型 LIKE \\\'%海德堡%\\\' THEN   \\\'1.2.海德堡\\\'  WHEN 机型 LIKE \\\'%小森四色%\\\' THEN   \\\'1.3.小森四色\\\'  WHEN 机型 LIKE \\\'%小森%八色%\\\' THEN   \\\'1.4.小森八色\\\'  WHEN 机型 LIKE \\\'%SD%\\\' THEN   \\\'2.1.SD\\\'  WHEN 机型 LIKE \\\'%W92%\\\' THEN   \\\'2.2.W92型\\\'  WHEN 机型 LIKE \\\'%超级接线凹印机A%\\\'  OR 机型 LIKE \\\'%超级接线凹印机B%\\\' THEN   \\\'2.3.超凹1-2代\\\'  WHEN 机型 LIKE \\\'%超级接线凹印机C%\\\' THEN   \\\'2.4.超凹3代\\\'  WHEN 机型 LIKE \\\'%W10%\\\' THEN   \\\'2.5.W10\\\'  WHEN 机型 LIKE \\\'%多功能印码%\\\' THEN   \\\'3.1.多功能机\\\'  WHEN 机型 LIKE \\\'%DMJ12%\\\' THEN   \\\'3.2.DMJ12\\\'  WHEN 机型 LIKE \\\'%M97%\\\' THEN   \\\'3.3.M97\\\'  WHEN 机型 LIKE \\\'%M81D%\\\' THEN   \\\'3.4.M81D\\\'  WHEN 机型 LIKE \\\'%涂布%\\\' THEN   \\\'3.5.涂布\\\'  WHEN 机型 LIKE \\\'%DMK08A%\\\' THEN   (   CASE   WHEN 机型 LIKE \\\'%DMK08A-1%\\\' THEN    \\\'3.6.丝凸检\\\'   ELSE    \\\'3.7.丝凸机\\\'   END   )  WHEN 机型 LIKE \\\'%自动线%\\\' THEN   (   CASE   WHEN 机型 LIKE \\\'%自动线10%\\\'   OR 机型 LIKE \\\'%自动线9%\\\'   OR 机型 LIKE \\\'%自动线8%\\\' THEN    \\\'4.2.自动线8-10\\\'   ELSE    \\\'4.1.自动线1-7\\\'   END   )  WHEN 机型 LIKE \\\'%BPS2000%\\\' THEN   \\\'4.4.进口清分机\\\'  ELSE   机型  END  ) ),proddetail AS ( SELECT  SUBSTRING (机型,5,len(机型)) 机型, 产量 / (  CASE  WHEN 机型 LIKE \\\'%自动线%\\\'  OR 机型 LIKE \\\'%清分%\\\' THEN   350  ELSE   10000  END  ) 产量, 台班, round(  CAST (产量 AS FLOAT) / 台班 / (   CASE   WHEN 机型 LIKE \\\'%自动线%\\\'   OR 机型 LIKE \\\'%清分%\\\' THEN   350   ELSE   10000   END  ), 2  ) 台班产量, (  CASE  WHEN 机型 LIKE \\\'%J98%\\\' THEN   5.28 * 90 / 88  WHEN 机型 LIKE \\\'%海德堡%\\\' THEN   6.6  WHEN 机型 LIKE \\\'%小森四色%\\\' THEN   6.6  WHEN 机型 LIKE \\\'%小森八色%\\\' THEN   6.05  WHEN 机型 LIKE \\\'%接线印码%\\\'  OR 机型 LIKE \\\'%丝凸%\\\' THEN   4.8  WHEN 机型 LIKE \\\'%SD%\\\' THEN   5.76  WHEN 机型 LIKE \\\'%W92型%\\\' THEN   5.632 * 90 / 88  WHEN 机型 LIKE \\\'%超凹1-2%\\\' THEN   5.632 * 90 / 88  WHEN 机型 LIKE \\\'%超凹3%\\\' THEN   6.08  WHEN 机型 LIKE \\\'%W10%\\\' THEN   5.76  WHEN 机型 LIKE \\\'%多功能机%\\\' THEN   4.84  WHEN 机型 LIKE \\\'%DMJ12%\\\' THEN   4.95  WHEN 机型 LIKE \\\'%M97%\\\' THEN   4.48  WHEN 机型 LIKE \\\'%M81D%\\\' THEN   3.99  WHEN 机型 LIKE \\\'%自动线1-7%\\\' THEN   7.2  WHEN 机型 LIKE \\\'%自动线8-10%\\\' THEN   4.96  WHEN 机型 LIKE \\\'%进口清分机%\\\' THEN   2.4  ELSE   1  END  ) 定额 FROM  prodlist ) SELECT *,round(100 * 台班产量 / 定额,2) 完成比例 FROM proddetail', 'tstart,tend', '', '2019-07-26 14:22:02', '2019-07-26 14:22:02', '0');
INSERT INTO `sys_api` VALUES ('641', '00000000016', '1', '单万产品在上工序是否为精品', '7faf19f3d0', 'WITH res AS ( SELECT  车号 cart_number, 工序 process, 机台 machine, 机长 captain_name FROM  v_cbpc_cartlist a WHERE  车号 =? AND 工序 IN (  \'凹一印\', \'凹二印\', \'丝印\' ) ) SELECT TOP 1 cart_number,process,machine,captain_name,(  CASE  WHEN b.IsRemoveBarrier = (  CASE  WHEN process = \'凹一印\'  OR process = \'丝印\' THEN   19  WHEN process = \'凹二印\' THEN   13  END  ) or b.IsRemoveBarrier-1 = (  CASE  WHEN process = \'凹一印\'  OR process = \'丝印\' THEN   19  WHEN process = \'凹二印\' THEN   13  END  ) THEN  1  ELSE  0  END ) status FROM res a LEFT JOIN udt_tb_WipInventory b ON a.cart_number = b.carno', 'cart', '', '2019-07-29 09:24:01', '2019-08-02 13:33:14', '0');
INSERT INTO `sys_api` VALUES ('642', '00000000002', '1', '每日开包量曲线图', '94521067dc', 'SELECT a.[生产日期],round( AVG (CAST(a.开包量 AS FLOAT)),2 ) 票面开包量 FROM view_print_hecha_image_check a WHERE a.[生产日期] BETWEEN ? AND ? AND 品种 =? AND (a.mahouid > 0) GROUP BY a.[生产日期]', 'tstart,tend,prod', '', '2019-07-29 17:19:48', '2019-07-29 17:20:46', '0');
INSERT INTO `sys_api` VALUES ('643', '00000000006', '1', '批量大张兑换信息查询', '6354223d5d', 'select    b.cart_number 车号,    e.operation_name 工序,   d.sheet_num 大张号,   (case     when d.item_flag = 1 then      \'换出\'     else      \'换入\'    end) 状态,to_char(a.start_date,\'YYYY-MM-DD HH24:mm:ss\') 兑换时间  from qm_rectify_master a inner join wip_jobs b   on a.job_id = b.job_id inner join qm_exchange_master c   on c.rectifym_id_in = a.rectifym_id inner join qm_exchange_slave d   on d.exchangem_id = c.exchangem_id inner join DIC_OPERATIONS e   on e.operation_id = a.operation_id where d.sheet_num=? order by a.start_date,2', 'sheet_num', '', '2019-07-31 15:35:52', '2019-07-31 15:40:11', '0');
INSERT INTO `sys_api` VALUES ('644', '00000000016', '1', '指定大万精品情况查询', 'e137b49d49', 'WITH  res AS ( SELECT  车号 cart_number, 工序 process, 机台 machine, 机长 captain_name, 产量 product_num, 工艺 proc_name, a.erp_code, datediff(  MINUTE, 开始时间, 完成时间  ) print_length FROM  v_cbpc_cartlist a WHERE  车号 =?  AND CONVERT (  VARCHAR, a.[完成时间], 112 ) between CONVERT (  VARCHAR, dateadd(DAY ,- 3,getdate()), 112 ) and CONVERT (  VARCHAR, getdate(), 112 ) AND 工序 IN (  \\\'胶印\\\', \\\'丝印\\\', \\\'凹一印\\\', \\\'凹二印\\\' ) AND 产量 > 0 ) SELECT cart_number, process,machine,captain_name, SUM (print_length) print_length,a.erp_code,(  CASE  WHEN print_length >= 105  AND process IN (\\\'胶印\\\',\\\'丝印\\\') THEN  1  WHEN print_length >= 95  AND SUBSTRING (process,1,1) = \\\'凹\\\' THEN  1  ELSE  0  END ) all_check,(case (  CASE  WHEN process = \\\'胶印\\\' THEN  1  WHEN process = \\\'丝印\\\' THEN  19  WHEN process = \\\'凹一印\\\' THEN  20  WHEN process = \\\'凹二印\\\' THEN  14  ELSE  0  END )-(  CASE  WHEN b.IsRemoveBarrier IS NULL THEN  0  ELSE  b.IsRemoveBarrier  END ) when 1 then 1 else 0 end) is_excellent FROM res a LEFT JOIN udt_tb_WipInventory b ON a.cart_number = b.carno GROUP BY cart_number, process,machine,captain_name,a.erp_code,print_length,IsRemoveBarrier', 'cart', '', '2019-08-02 11:32:06', '2019-08-02 11:32:06', '0');
INSERT INTO `sys_api` VALUES ('645', '00000000016', '1', '精品线_判断产品是否为精品及机长是否精品', '8a21ae74ee', 'WITH res AS ( SELECT 车号 cart_number,工序 process,机台 machine,机长 captain_name FROM v_cbpc_cartlist a WHERE 车号 =? AND 工序 IN ( \'凹一印\',\'凹二印\',\'丝印\' ) ) ,excellentList as (SELECT TOP 1 cart_number,process,machine,captain_name,( CASE WHEN b.IsRemoveBarrier = ( CASE WHEN process = \'凹一印\' OR process = \'丝印\' THEN  19 WHEN process = \'凹二印\' THEN  13 END ) OR b.IsRemoveBarrier - 1 = ( CASE WHEN process = \'凹一印\' OR process = \'丝印\' THEN  19 WHEN process = \'凹二印\' THEN  13 END ) THEN 1 ELSE 0 END ) status FROM res a LEFT JOIN udt_tb_WipInventory b ON a.cart_number = b.carno),prod_list AS ( SELECT prod_id FROM Products_Base WHERE SUBSTRING (prod_desc,4,5) = \'9607T\' ),change_log AS ( SELECT a.CarNumber AS cart_number,SUM (CAST(a.Quantity AS INT)) exchange_quantity FROM udt_ps_Exchange a INNER JOIN prod_list b ON a.prod_id = b.prod_id WHERE a.unit = 51082 AND CONVERT ( VARCHAR,CAST (a.ExchangeTime AS datetime),112 ) BETWEEN CONVERT ( VARCHAR,dateadd(MONTH ,- 1,getdate()),112 ) AND CONVERT (VARCHAR,GETDATE(),112) GROUP BY a.CarNumber ),change_record AS ( SELECT DISTINCT b.* FROM change_log b LEFT JOIN dbo.udt_pp_MachineProcess a ON b.cart_number = a.CarNumber LEFT JOIN udt_tb_WipInventory wipInv ON wipInv.WI_Id = a.BusinessWiid WHERE CrownWordStartNum IS NOT NULL AND wipInv.ProcessLine_Desc = \'码后核查工艺\' ),fakeList AS ( SELECT b.工序 proc_name,b.Class_ID,b.Equipment,b.pu_desc,b.erp_code,AVG (exchange_quantity) fake_num,COUNT (*) cart_num FROM change_record a INNER JOIN dbo.udt_pp_MachineProcess udp_pp ON a.cart_number = udp_pp.CarNumber INNER JOIN udt_tb_WipInventory wipInv ON wipInv.WI_Id = udp_pp.BusinessWiid INNER JOIN ( SELECT a.CarNumber AS [车号],b.Path_Desc AS [工序],r.erpcode erp_code,r.pu_desc,r.PU_Id Class_ID,a.Equipment FROM dbo.udt_pp_MachineProcess a LEFT JOIN Prdexec_Paths b ON b.Path_Id = a.TargetProcess LEFT JOIN v_cbpc_classinfo r ON r.PU_Id = a.MachineTeam WHERE a.CarNumber IS NOT NULL AND r.PU_Desc <> \'凹印况东机台\' ) b ON a.cart_number = b.车号 WHERE b.工序 LIKE \'凹%\' GROUP BY 工序,b.pu_desc,erp_code,b.Class_ID,b.Equipment HAVING COUNT (*) > 50 ),prodinfo AS ( SELECT replace( replace(pu_desc,\'凹印\',\'\'),\'机台\',\'\' ) machine FROM ( SELECT  row_number () OVER (  partition BY proc_name  ORDER BY  proc_name, fake_num, (  CASE replace(   replace(pu_desc,\'凹印\',\'\'), \'机台\', \'\'  )  WHEN \'杨平\' THEN   0  WHEN \'任晓军\' THEN   0 when \'刘潺\' then 0  WHEN \'蔡勇\' THEN   0  ELSE   1  END  )  ) rn ,* FROM  fakeList ) a WHERE a.rn <= 2 ) select * from excellentList where captain_name in (select * from prodinfo)', 'cart', '', '2019-08-02 13:49:25', '2019-08-12 10:54:02', '0');
INSERT INTO `sys_api` VALUES ('646', '00000000002', '1', '批量车号锁车原因查询', 'aa97aa4d84', 'SELECT cart_number 车号,type 锁车类型,username 锁车人,reason 锁车原因,CONVERT (VARCHAR,rec_time,120) 锁车时间 FROM ( SELECT cart_number,( CASE WHEN only_lock_cart = 1 THEN \'批量锁车.不拉号\' ELSE \'异常品\' END ) type,isnull(machine_name,\'\') + \' \' + reason AS reason,( CASE WHEN user_name IS NOT NULL THEN user_name ELSE \'\' END ) username,a.rec_date rec_time FROM Print_Abnormal_Prod a UNION ALL SELECT DISTINCT cart_number,\'人工大张日常抽检\' type,\'\' AS reason,\'\' AS username,a.rec_time FROM print_sample_cartlist a UNION ALL SELECT DISTINCT 车号 cart_number,原因 type,备注 reason,记录人 username,记录时间 rec_time FROM view_print_wms_proclist a ) a WHERE cart_number in (?) ORDER BY 1,2', 'carts', '', '2019-08-08 08:52:13', '2019-08-08 08:55:17', '0');
INSERT INTO `sys_api` VALUES ('647', '00000000016', '1', '大张号票出库白名单', '6c27a0018d', 'SELECT a.[工艺],a.[品种],a.[车号],a.[冠字],a.[类型],a.[出库序号],a.[开包量] FROM dbo.v_cbpc_whitelist AS a WHERE a.proc_name = \\\'dzhp\\\'', '', '', '2019-08-08 09:20:01', '2019-08-08 09:20:01', '0');
INSERT INTO `sys_api` VALUES ('648', '00000000021', '1', '胶印大张离线检测得分汇总', 'b345edbec9', 'SELECT a.机长,a.次数 张数,a.机台,a.品种,a.正反面,a.墨色,a.规矩,a.防复印圈,a.混色,a.对印,a.总分,a.小开数 * 次数 小张总数,ceiling(  a.小开数 * 次数 * a.总分 / 100 ) 合格小开数 FROM (  SELECT  a.captain_name 机长, COUNT (1) 次数, a.machine_name 机台, a.prod_name 品种, a.sidename 正反面, round(AVG(a.JPIColor),2) 墨色, round(AVG(a.OIOVer),2) 胶凹套印, round(AVG(a.JPICon),2) 凹印接线, round(AVG(a.distance),2) 规矩, round(AVG(a.safe_circle),2) 防复印圈, round(AVG(a.mix_color),2) 混色, round(AVG(a.over_print),2) 对印, round(AVG(a.score),2) 总分, (   CASE   WHEN a.prod_name IN (\\\'9602A\\\',\\\'9603A\\\') THEN   40   ELSE   35   END  ) 小开数  FROM  dbo.view_score_offset AS a  WHERE  CONVERT (VARCHAR,rec_time,112) BETWEEN ?  AND ?  AND a.operator_name = \\\'印钞管理部\\\'  GROUP BY  a.captain_name, a.machine_name, a.prod_name, a.sidename ) a ORDER BY 4,5,3,1', 'tstart,tend', '', '2019-08-09 09:26:08', '2019-08-09 09:26:08', '0');
INSERT INTO `sys_api` VALUES ('649', '00000000002', '1', '印钞实际开包量分布', '0cf32536d9', 'select totalopennum 开包量 from OCRData a where convert(varchar,scanDate,112) between ? and ? and productType=? and totalopennum between 10 and 300', 'tstart,tend,prefix', '', '2019-08-10 20:33:15', '2019-08-10 22:43:25', '0');
INSERT INTO `sys_api` VALUES ('650', '00000000002', '1', '印钞实际开包量分布图', 'addaaf0a75', 'select * from (SELECT (  CASE  WHEN opennum < 50 THEN  \'50以下\'  WHEN opennum > 200 THEN  \'200以上\'  ELSE  cast(opennum as varchar)  END ) 开包量,SUM (num) num FROM (  SELECT  opennum, opennum * COUNT (*) num  FROM  (   SELECT   totalOpenNum / 10 * 10 opennum   FROM   OCRData a   WHERE   CONVERT (VARCHAR,scanDate,112) BETWEEN ?   AND ?   AND productType =?   AND totalopennum BETWEEN 10   AND 300  ) a  GROUP BY  opennum ) a GROUP BY (  CASE  WHEN opennum < 50 THEN  \'50以下\'  WHEN opennum > 200 THEN  \'200以上\'  ELSE  cast(opennum as varchar)  END )) a order by (case 开包量 when \'50以下\' then 0 when \'200以上\' then 300 else 开包量 end)', 'tstart,tend,prefix', '', '2019-08-10 22:45:17', '2019-08-10 23:12:04', '0');
INSERT INTO `sys_api` VALUES ('651', '00000000002', '1', '印钞开包量占比', '9858e73399', 'SELECT  cast(opennum as varchar)+\\\'包\\\' 开包量, opennum * COUNT (*) 开包总量  FROM  (   SELECT   totalOpenNum / 10 * 10 opennum   FROM   OCRData a   WHERE   CONVERT (VARCHAR,scanDate,112) BETWEEN ?   AND ?   AND productType = ?   AND totalopennum BETWEEN 10   AND 300  ) a  GROUP BY opennum order by opennum desc', 'tstart,tend,prefix', '', '2019-08-10 23:15:23', '2019-08-10 23:15:23', '0');
INSERT INTO `sys_api` VALUES ('652', '00000000017', '1', 'ASRS出入库统计', '415b0ec871', 'SELECT a.EXTATTR9 Prod_Code,a.EXTATTR10 Proc_Code,a.direction Direction,sum(a.qty1 + a.qty2) Total from ( SELECT R.EXTATTR9,R.EXTATTR10,r.org_code,(CASE r.reponsetype WHEN \'OutStockRequest\' THEN \'出\' ELSE \'入\' END) direction,SUM(CONVERT(float,r.EXTATTR12)/10000) AS QTY1,SUM(CONVERT(float,r.EXTATTR13)/10000) AS QTY2,count(r.EXTATTR12) as total FROM ( SELECT (CASE WHEN ISNULL(l.EXTATTR14,\'\') = \'\' THEN l.EXTATTR6 ELSE l.EXTATTR14 END) org_code,l.* FROM TIMMSL0378.L0378.V_WMS_RSS_REQUEST l WHERE l.status = \'Over\' AND l.enterdate BETWEEN ? AND ? AND l.enterby = \'MES\' AND l.EXTATTR26 <> 4) r GROUP BY r.EXTATTR9,r.EXTATTR10,r.org_code,r.reponsetype ) a GROUP BY a.EXTATTR9,a.EXTATTR10,a.direction ORDER BY a.EXTATTR9,a.EXTATTR10,a.direction;', 'sdate,edate', '', '2019-08-12 15:25:28', '2019-08-20 16:55:22', '0');
INSERT INTO `sys_api` VALUES ('653', '00000000003', '1', '按号剔废_票面与丝印', 'cf5fc7dc0d', 'with cartlist as (select ? cart from dual) select distinct b.code_num \"code\",\'mahou\' \"type\",b.convert_num \"format_pos\"  from qfm_wip_jobs a inner join qfm_qa_temp_qatbl b   on a.job_id = b.job_id where cart_number in (select * from cartlist) union all select distinct b.code_num \"code\",\'silk\' \"type\",b.convert_num \"format_pos\"  from wip_jobs a inner join qa_temp_qatbl b   on a.job_id = b.job_id where cart_number in (select * from cartlist)', 'cart', '', '2019-08-14 08:55:40', '2019-11-19 09:25:40', '0');
INSERT INTO `sys_api` VALUES ('654', '00000000007', '1', '按号剔废_号码', '54579efd00', 'SELECT distinct c.EX_CODENUM AS \"code\",\'code\' \"type\",c.convert_sheet_number \"format_pos\" FROM wip_jobs T INNER JOIN wip_prod_logs A ON A.job_id = T.job_id and T.cart_number =? INNER JOIN qa_inspect_master b ON b.log_id = A.log_id INNER JOIN qa_inspect_slave c ON b.inspectm_id = c.inspectm_id AND c.item_flag IN (2,3)', 'cart', '', '2019-08-14 08:56:20', '2019-11-19 09:16:34', '0');
INSERT INTO `sys_api` VALUES ('655', '00000000016', '1', 'MES出入立体库统计', '8542a39b00', 'SELECT W.Prod_Type,W.Location,Direction,( CASE W.Eng_Unit_Desc WHEN \'令\' THEN sum( CONVERT ( FLOAT,W.Quantity / 20 ) ) ELSE sum( CONVERT ( FLOAT,W.Quantity ) ) / 10000 END ) AS Total,\'万大张\' AS Unit FROM ( SELECT V.*,bi.Prod_Type,pub.PU_Desc Location_Desc,eu.Eng_Unit_Desc,smi.PU_Desc,\'入\' AS Direction FROM ( SELECT si.Product,si.Location,si.Quantity,si.Unit,si.Business_Desc,si.CarNumber,si.InStorageTime InOutTime,( CASE WHEN si.MachineTeam = \'0\' THEN ( CASE si.Equipment WHEN \'0\' THEN ( SELECT TOP 1 uI.PU_ID FROM udt_tb_UserLogin_Info ui WHERE si.Operator = ui.User_Id AND si.InStorageTime > ui.LoginTime ORDER BY ui.LoginTime DESC ) ELSE si.Equipment END ) ELSE si.MachineTeam END ) ORG_CODE FROM udt_ps_StorageIn si WHERE si.STORAGE = 10996 AND si.Event_Status = 45 UNION ALL SELECT sli.Product,sli.Location,sli.Quantity,sli.Unit Eng_Unit_Desc,sli.Business_Desc,sli.CarNumber,sli.InStorageTime InTime,sli.MachineTeam ORG_CODE FROM udt_ps_SwingIn sli WHERE sli.STORAGE = 10996 AND sli.Event_Status = 45 ) V LEFT JOIN v_Prod_BaseInfo bi ON bi.Prod_Id = V.Product LEFT JOIN Prod_Units_Base pub ON pub.PU_Id = V.Location LEFT JOIN v_Storage_Machine_Info smi ON smi.PU_Id = V.ORG_CODE LEFT OUTER JOIN Engineering_Unit AS eu ON eu.Eng_Unit_Id = V.Unit UNION ALL SELECT V.*,bi.Prod_Type,pub.PU_Desc Location_Desc,eu.Eng_Unit_Desc,smi.PU_Desc,\'出\' AS Direction FROM ( SELECT so.Prod_Id AS Product,so.Location,so.Quantity,so.Unit,so.Business_Desc,so.CarNumber,so.OutStorageTime InOutTime,( CASE  WHEN ISNULL( so.MachineTeam,\'\' ) = \'\' THEN sO.Equipment ELSE ( SELECT TOP 1 uI.Class_Id FROM udt_tb_UserLogin_Info ui WHERE so.Operator = ui.User_Id AND so.OutStorageTime > ui.LoginTime ORDER BY ui.LoginTime DESC ) END ) ORG_CODE FROM udt_ps_StorageOut so WHERE so.STORAGE = 10996 AND so.Event_Status = 45 UNION ALL SELECT slo.Product,slo.Location,slo.Quantity,slo.Unit Eng_Unit_Desc,slo.Business_Desc,slo.CarNumber,slo.OutStorageTime OutTime,slo.MachineTeam ORG_CODE FROM udt_ps_SwingOut slo WHERE slo.STORAGE = 10996 AND slo.Event_Status = 45 ) V LEFT JOIN v_Prod_BaseInfo bi ON bi.Prod_Id = V.Product LEFT JOIN Prod_Units_Base pub ON pub.PU_Id = V.Location LEFT JOIN v_Storage_Machine_Info smi ON smi.PU_Id = V.ORG_CODE LEFT OUTER JOIN Engineering_Unit AS eu ON eu.Eng_Unit_Id = V.Unit ) W WHERE W.InOutTime BETWEEN ? AND ? GROUP BY W.Prod_Type,W.Location,W.Direction,W.Eng_Unit_Desc ORDER BY W.Prod_Type,W.Location,W.Direction,W.Eng_Unit_Desc;', 'sdate,edate', '', '2019-08-14 15:10:12', '2019-08-20 16:51:44', '0');
INSERT INTO `sys_api` VALUES ('656', '00000000016', '1', '指定冠字查询车号信息', '21e237effe', 'SELECT top 1 车号 cart FROM v_cbpc_cart_lite WHERE 品种 =? AND 冠字=? and len(车号)>0', 'prod,cart', '', '2019-08-15 08:57:16', '2019-08-15 09:45:47', '0');
INSERT INTO `sys_api` VALUES ('657', '00000000016', '1', 'MES裁封自动线产量统计', '79bf0b8a9f', 'SELECT [Year] as 年份  ,[Month] as 月份    ,[Product_Desc] as 品种    ,[Equ_Desc] as 设备机台    ,[ComQuantity] as 码后产量    ,[QuanJian_ComQuantity] as 全检产量  FROM [SOADB].[dbo].[udt_Report_Statis_CaiFen] where [Year]=? order by [Month],[Product_Desc],[Equ_Desc]', 'tstart', '', '2019-08-27 17:20:56', '2019-08-30 16:37:24', '0');
INSERT INTO `sys_api` VALUES ('658', '00000000006', '1', '指定兑换车号产品兑换记录', '3fba6bae80', 'SELECT b.cart_number 车号,E .operation_name 工序,D .sheet_num 大张号,(  CASE  WHEN D .item_flag = 1 THEN  \\\'换出\\\'  ELSE  \\\'换入\\\'  END ) 状态,TO_CHAR (  A .start_date, \\\'YYYY-MM-DD HH24:mm:ss\\\' ) 兑换时间 FROM qm_rectify_master A INNER JOIN wip_jobs b ON A .job_id = b.job_id INNER JOIN qm_exchange_master c ON c.rectifym_id_in = A .rectifym_id INNER JOIN qm_exchange_slave D ON D .exchangem_id = c.exchangem_id INNER JOIN DIC_OPERATIONS E ON E .operation_id = A .operation_id WHERE substr(D .sheet_num,0,4)=? and TO_CHAR (  A .start_date, \\\'YYYY\\\' ) =? ORDER BY A .start_date,2', 'cart,tstart', '', '2019-08-27 18:47:05', '2019-08-27 18:47:05', '0');
INSERT INTO `sys_api` VALUES ('659', '00000000002', '1', '印码各品种平均好品率', '1517a98fa2', 'select b.ProductName 品种,ProduceDate/100 as 月份,round(AVG(GoodRate),2) as 平均好品率 from MaHouData a inner join ProductData b on a.ProductTypeID = b.ID where ProduceDate between ? and ? group by ProduceDate/100,b.ProductName order by 1,2', 'tstart,tend', '', '2019-08-27 19:39:20', '2019-08-27 19:40:45', '0');
INSERT INTO `sys_api` VALUES ('660', '00000000022', '1', '入库操作记录', '98bf65c265', 'SELECT DISTINCT  a.xh 箱号, a.PZ 品种, a.GZ 冠字, a.MXZS 产量, (  CASE  WHEN a.cz = \\\'D\\\' THEN   \\\'16502\\\'  ELSE   \\\'11112\\\'  END  ) AS 货位, b.xwdh 箱外代号, b.xwdah 箱外代号2, convert(varchar,a.RQ ,120) 日期 FROM  dbo.B_XQ a INNER JOIN dbo.B_GZ b ON a.PZ = b.PZ AND a.GZ = b.GZ WHERE  a.CZ = \\\'D\\\' AND CONVERT (  VARCHAR, CAST (  DATEADD(HOUR ,- 3,a.RQ) AS DATE  ), 112 ) BETWEEN ? AND ? order by 2,3,8', 'tstart,tend', '', '2019-08-28 11:18:49', '2019-08-28 11:18:49', '0');
INSERT INTO `sys_api` VALUES ('661', '00000000022', '1', '出库操作记录', '9abc5545b3', 'SELECT DISTINCT a.xh 箱号,a.PZ 品种,a.GZ 冠字,a.MXZS 产量, (  CASE  WHEN a.cz = \\\'R\\\' THEN   \\\'16502\\\'  ELSE   \\\'11112\\\'  END  ) AS 货位, (case when a.CZ=\\\'R\\\' then \\\'入成品库\\\' when a.cz=\\\'D\\\' then \\\'入临库\\\' when a.cz=\\\'c\\\' then \\\'出成品库\\\' when a.cz=\\\'J\\\' then \\\'解缴\\\' end) 操作,b.xwdh 箱外代号,b.xwdah 箱外代号2,CONVERT (VARCHAR,a.RQ,120) 日期 FROM  dbo.B_XQ a INNER JOIN dbo.B_GZ b ON a.PZ = b.PZ AND a.GZ = b.GZ WHERE  a.CZ IN (\\\'C\\\',\\\'R\\\') AND ZTBM = 0 AND CONVERT (  VARCHAR, CAST (  DATEADD(HOUR ,- 3,a.RQ) AS DATE  ), 112 ) BETWEEN ? AND ? ORDER BY 2,3,8', 'tstart,tend', '', '2019-08-28 11:25:02', '2019-08-28 11:25:02', '0');
INSERT INTO `sys_api` VALUES ('662', '00000000021', '1', '胶印产品质量控制水平统计', '1bac369f70', 'SELECT a.prod_name 品种,a.sidename 正背面,a.captain_name 机长,a.machine_name 机台,COUNT (*) 次数,round(AVG(a.JPIColor),2) 墨色,round(AVG(a.over_print),2) 套印,round(AVG(a.safe_circle),2) 安全圆,round(AVG(a.distance),2) 规矩,\'\' 对印,round(AVG(a.mix_color),2) 混色,\'\' 线宽,round(AVG(a.score),2) 综合打分,(case when substring(a.prod_name,0,4) in (\'9602\',\'9603\') then 40 else 35 end ) *count(*) 小张总数,round((case when substring(a.prod_name,0,4) in (\'9602\',\'9603\') then 40 else 35 end ) *count(*)*round(AVG(a.score),2)/100,0) 合格数 FROM view_score_offset a WHERE CONVERT (VARCHAR,rec_time,112) BETWEEN ? AND ? AND a.operator_name = \'机台人员\' GROUP BY a.captain_name,a.machine_name,a.prod_name,a.sidename order by 1,2,3,4', 'tstart,tend', '', '2019-08-28 11:44:25', '2019-08-28 17:51:13', '0');
INSERT INTO `sys_api` VALUES ('663', '00000000021', '1', '凹印产品质量控制水平统计', '9882686082', 'SELECT a.prod_name 品种,a.sidename 正背面,a.captain_name 机长,a.machine_name 机台,COUNT (*) 次数,round(AVG(a.JPIColor),2) 墨色,round(AVG(a.OIOVer),2) 套印,round(AVG(a.JPICon),2) 接线,\'\' 红外,\'\' JPOVI,\'\' OVI,round(AVG(a.score),2) 综合打分,(case when substring(a.prod_name,0,4) in (\'9602\',\'9603\') then 40 else 35 end ) *count(*) 小张总数,round((case when substring(a.prod_name,0,4) in (\'9602\',\'9603\') then 40 else 35 end ) *count(*)*round(AVG(a.score),2)/100,0) 合格数 FROM view_score_intaglio a WHERE CONVERT (VARCHAR,rec_time,112) BETWEEN ? AND ? AND a.operator_name = \'机台人员\' AND a.captain_name NOT IN (\'测试员\',\'test\') GROUP BY a.captain_name,a.machine_name,a.prod_name,a.sidename ORDER BY 1,2,3,4', 'tstart,tend', '', '2019-08-28 11:53:06', '2019-08-28 17:51:43', '0');
INSERT INTO `sys_api` VALUES ('664', '00000000011', '1', '产成品产量解缴量', '9cdc31ddc6', 'SELECT A.生产月份,A.产品名称,A.月产量,A.计量单位,A.产品类型,A.月解缴量,A.月自用量,A.月计划产量 FROM V_540_USER_PROD_FINISH A WHERE A.生产月份 || \\\'01\\\' BETWEEN ? AND ?', 'tstart,tend', '', '2019-08-28 13:35:17', '2019-08-28 13:35:17', '0');
INSERT INTO `sys_api` VALUES ('665', '00000000011', '1', '成钞公司主要经济指标', 'ae4cd8724d', 'SELECT a.指标类型,A.\"月份\",A.\"品种\",A.\"指标值\",A.\"单位\",A.\"子项\",A.\"母项\" FROM V_540_USER_PRIMARY_ECO_INDEX a where a.月份||\\\'01\\\' BETWEEN ? and ? order by 1,2,3', 'tstart,tend', '', '2019-08-28 13:38:18', '2019-08-28 13:38:18', '0');
INSERT INTO `sys_api` VALUES ('666', '00000000011', '1', '印钞产成品产量曲线图', 'de9582fac8', 'SELECT A.产品名称,A.生产月份,A.月产量 FROM V_540_USER_PROD_FINISH A WHERE A.生产月份 || \\\'01\\\' BETWEEN ? AND ? and A.prod_type=\\\'01\\\'', 'tstart,tend', '', '2019-08-28 13:39:57', '2019-08-28 13:39:57', '0');
INSERT INTO `sys_api` VALUES ('667', '00000000002', '1', '各品种开包量汇总', '1d7713422f', 'SELECT 品种,CONVERT (VARCHAR(6),b.采集时间,112) 月份,avg(开包量) 开包量 FROM VIEW_PRINT_OCR b where CONVERT (VARCHAR,b.采集时间,112) BETWEEN ? AND ? AND b.开包量 > 0 and b.[工艺]=\'码后核查\' GROUP BY CONVERT (VARCHAR(6),b.采集时间,112),品种 order by 1,2', 'tstart,tend', '', '2019-08-29 15:00:52', '2019-08-29 15:01:13', '0');
INSERT INTO `sys_api` VALUES ('668', '00000000016', '1', '人员维修工时统计', 'ec73453b4d', 'SELECT (CAST(YEAR(StartTime) AS VARCHAR(20))+ \'年\'+ CAST(MONTH(StartTime) AS VARCHAR(20))+\'月\') AS 日期,UserDesc AS 姓名,TeamDesc AS 班组,(CAST(SUM(DATEDIFF(MINUTE,StartTime,EndTime)) AS VARCHAR(20))+ \'分钟\') AS 维修时长 FROM udt_eq_RepairPerson WHERE StartTime>=? AND StartTime<=? GROUP BY YEAR(StartTime),MONTH(StartTime),TeamDesc,UserDesc', 'tstart,tend', '', '2019-09-03 17:02:31', '2019-09-04 13:02:15', '0');
INSERT INTO `sys_api` VALUES ('669', '00000000016', '1', '设备维修工时报表', 'af0457be82', 'SELECT (CAST(YEAR(LastUpdateTime) AS VARCHAR(20))+ \'年\'+ CAST(MONTH(LastUpdateTime) AS VARCHAR(20))+\'月\') AS 日期,[EquDesc] AS 设备,(CAST( ISNULL(SUM(EquStopDuration),0) AS VARCHAR(20))+ \'分钟\') AS 故障停机时间合计,(CAST( COUNT(1) AS VARCHAR(20))+ \'次\') AS 故障次数,(CAST( ISNULL(SUM(EquStopDuration),0)/COUNT(1) AS VARCHAR(20))+ \'分钟\') AS 平均故障停机时间,(CAST( ISNULL( CONVERT(FLOAT,((CAST(( SELECT COUNT(1) [count] FROM dbo.udt_tb_DailyPlan_Detail WHERE PU_Id=eq.EquId AND YEAR(StartTime)=YEAR(LastUpdateTime)AND MONTH(StartTime)=MONTH(LastUpdateTime) GROUP BY PU_Id,YEAR(StartTime),MONTH(StartTime)) AS FLOAT)*480.0)-ISNULL(SUM(EquStopDuration),0.0))/(COUNT(1)+1)/60.0 ),0) AS VARCHAR(20))+ \'小时\') AS 平均故障间隔时间,ISNULL(( SELECT COUNT(1) [count] FROM  ( SELECT MachineTeam,Equipment Equ,YEAR( DateAdd(HOUR,-3,StartTime)) YY,MONTH( DateAdd(HOUR,-3,StartTime)) MM,day(DateAdd(HOUR,-3,StartTime)) DD FROM udt_pp_MachineProcess pp WHERE pp.StartTime<>\'0001-01-01 00:00:00\' and pp.MachineTeam IS NOT NULL GROUP BY Equipment,YEAR( DateAdd(HOUR,-3,StartTime)),MONTH( DateAdd(HOUR,-3,StartTime)),day(DateAdd(HOUR,-3,StartTime)),MachineTeam ) b WHERE CONVERT (INT,b.Equ)=eq.EquId AND b.YY=CONVERT(int,YEAR(LastUpdateTime))AND b.MM=CONVERT(int,MONTH(LastUpdateTime) ) GROUP BY b.Equ,b.YY,b.MM ),0) AS 机台台班 FROM v_eq_RepairSummary eq WHERE LastUpdateTime>=? and LastUpdateTime<=? GROUP BY YEAR(LastUpdateTime),MONTH(LastUpdateTime) ,EquId,EquCode,EquDesc ORDER BY [日期] desc,[EquDesc]', 'tstart,tend', '', '2019-09-04 12:13:54', '2019-09-05 10:22:48', '0');
INSERT INTO `sys_api` VALUES ('670', '00000000016', '1', '班组维修工时统计 ', 'cc6112479f', 'SELECT (CAST(YEAR(操作时间) AS VARCHAR(20))+ \'年\'+ CAST(MONTH(操作时间) AS VARCHAR(20))+\'月\') AS 日期,MaintainTeam AS 班组,(CAST( ISNULL(SUM(EquStopDuration),0) AS VARCHAR(20))+ \'分钟\') AS 维修工时  from v_eq_RepairSummary v LEFT JOIN (select RepairPlanId ,MIN(StartTime) AS 操作时间 from udt_eq_RepairPerson GROUP BY RepairPlanId) c ON c.RepairPlanId=v.RepairPlanId  WHERE 1=1 AND MaintainTeamId>0 AND 操作时间>=? AND 操作时间<=? GROUP BY YEAR(操作时间),MONTH(操作时间) ,MaintainTeamId,MaintainTeam ORDER BY 日期,班组', 'tstart,tend', '', '2019-09-04 13:34:40', '2019-09-04 14:01:29', '0');
INSERT INTO `sys_api` VALUES ('671', '00000000016', '1', '批量冠字生产信息查询', '24ba38d4ea', 'SELECT a.[工艺],a.[车号],a.[冠字],a.[工序],a.[班次],a.[机台],a.[机长],CONVERT (  VARCHAR, a.[开始时间], 120 ) AS 开始时间,CONVERT (  VARCHAR, a.[完成时间], 120 ) AS 完成时间,a.[品种],a.[产量],a.生产记录 FROM dbo.v_cbpc_cartlist AS a WHERE 车号 in (select distinct 车号 from v_cbpc_cart_lite a where a.[品种] =? AND a.[冠字] in (?) )', 'prod,carts', '', '2019-09-05 09:12:34', '2019-09-05 09:12:34', '0');
INSERT INTO `sys_api` VALUES ('672', '00000000016', '1', '机台墨色消耗月报', '9c7fcb0677', 'SELECT    [Des] AS 品种  ,[Path_Desc] AS 工序  ,[EquDesc] AS 设备    ,[ClassDesc] AS 台班    ,[ProdDesc] AS 油墨名称  ,([UserDefine1]+\'-\'+[UserDefine2]) AS 日期    ,[ProdQty] AS 产量    ,[ActualQty] AS 油墨消耗  ,CAST(CAST([ActualQty]/[ProdQty] AS DECIMAL(5,2)) AS VARCHAR(10)) AS 单耗    ,([EngUnitDesc]+ \'/\'+ [ProdEngUnitDesc]) AS 单位  FROM [SOADB].[dbo].[v_PrintingConsume]  WHERE [UserDefine1]=?  ORDER BY [Des],   case   when [Path_Desc]=\'干胶印\' then 1    when [Path_Desc]=\'胶一印\' then 2  when [Path_Desc]=\'胶二印\' then 3    when [Path_Desc]=\'凹一印\' then 4    when [Path_Desc]=\'凹二印\' then 5  when [Path_Desc]=\'丝凸印丝印\' then 6  when [Path_Desc]=\'印后涂布\' then 7  when [Path_Desc]=\'印码\' then 8    end ,[EquDesc],[ClassDesc],[ProdCode],UserDefine2', 'tstart', '', '2019-09-09 12:45:07', '2019-09-09 16:45:39', '0');
INSERT INTO `sys_api` VALUES ('673', '00000000001', '1', '统一身份认证平台部门列表', '46efae99d7', 'http://10.8.1.27:4040/api/depts?org=?', 'org', '', '2019-09-10 12:40:15', '2019-09-10 12:51:58', '0');
INSERT INTO `sys_api` VALUES ('674', '00000000001', '1', '统一身份认证平台用户列表', 'd2b665340b', 'http://10.8.1.27:4040/api/users?org=?&dept=?', 'org,dept', '', '2019-09-10 12:43:31', '2019-09-10 12:43:31', '0');
INSERT INTO `sys_api` VALUES ('675', '00000000001', '1', '统一身份认证平台用户登录', '25d3d1010c', 'http://10.8.1.27:4040/api/login?password=?&uid=?&username=?&dept=?&org=?', 'password,uid,username,dept,org', '', '2019-09-10 12:45:06', '2019-09-10 12:45:06', '0');
INSERT INTO `sys_api` VALUES ('676', '00000000016', '1', '印钞工序油墨消耗周报', '9215b0ba45', 'SELECT T.[Des] AS 品种  ,T.[Path_Desc] AS 工序  ,(T.[UserDefine1]+\'年\'+T.[UserDefine2]+\'月 第\'+CONVERT(VARCHAR,T.[Week])+\'周\') AS 日期  ,本月完成  ,T.[EquDesc] AS 设备    ,T.[ClassDesc] AS 台班  ,机台单耗  ,单位 FROM (SELECT   [Des],[Path_Desc],[EquDesc],[ClassDesc],UserDefine1,UserDefine2,[Week], CAST(CAST(SUM([ActualQty])/SUM([ProdQty]) AS DECIMAL(5,2)) AS VARCHAR(10)) AS 机台单耗, ([EngUnitDesc]+ \'/\'+ [ProdEngUnitDesc]) AS 单位  FROM [SOADB].[dbo].[v_PrintingConsumeWeek]       GROUP BY [Des],[Path_Desc],[EquDesc],[ClassDesc],UserDefine1,UserDefine2,[Week],[EngUnitDesc],[ProdEngUnitDesc]  ) AS T  LEFT JOIN(  SELECT [Des],[Path_Desc],UserDefine1,UserDefine2,Week,CAST(CAST(SUM([ActualQty])/SUM([ProdQty]) AS DECIMAL(5,2)) AS VARCHAR(10)) AS 本月完成    FROM [SOADB].[dbo].[v_PrintingConsumeWeek]   GROUP BY [Des],[Path_Desc],UserDefine1,UserDefine2,[Week]   ) AS W ON T.[Des]=W.[Des] AND T.[Path_Desc]=W.[Path_Desc] AND T.UserDefine1=W.UserDefine1 AND T.UserDefine2=W.UserDefine2 AND T.Week=W.Week   WHERE T.[UserDefine1]=2019  ORDER BY T.[Des],   case   when T.[Path_Desc]=\'干胶印\' then 1    when T.[Path_Desc]=\'胶一印\' then 2  when T.[Path_Desc]=\'胶二印\' then 3    when T.[Path_Desc]=\'凹一印\' then 4    when T.[Path_Desc]=\'凹二印\' then 5  when T.[Path_Desc]=\'丝凸印丝印\' then 6  when T.[Path_Desc]=\'印后涂布\' then 7  when T.[Path_Desc]=\'印码\' then 8    end,T.UserDefine1,T.UserDefine2,T.[Week],T.[EquDesc],T.[ClassDesc]', 'tstart', '', '2019-09-25 11:39:56', '2019-09-25 12:47:56', '0');
INSERT INTO `sys_api` VALUES ('677', '00000000016', '1', '每周机台平均开包量', '0bcb2f00e9', 'select 工序,机台,机长,week_name 周数,avg(实际开包量) 平均开包量,avg(第0千位开包量) 第0千,count(*) 大万数 from (SELECT  b.[工序],b.[机台],b.[机长], datepart(week,b.[产量时间]) week_name, a.ex_opennum 实际开包量,a.ex_opennum_kilo0 第0千位开包量 FROM tbl_cbpc_batch_opennum a LEFT JOIN v_cbpc_cartlist b ON a.cart = b.车号 WHERE CONVERT (VARCHAR,a.rec_time,112) BETWEEN ? and ? AND b.[产量时间] >= \\\'2019-06-01\\\' AND b.工序 IN (\\\'凹一印\\\',\\\'凹二印\\\') AND b.车号 IS NOT NULL and b.品种 =\\\'9607T\\\' AND ex_opennum > 0 and 机长 is not null ) a group by 工序,机台,机长,week_name having count(*)>5 order by 4,5', 'tstart,tend', '', '2019-10-14 13:37:28', '2019-10-14 13:37:28', '0');
INSERT INTO `sys_api` VALUES ('678', '00000000016', '1', '在库产品冠字列表', '984253131d', 'SELECT DISTINCT gz.*,a.车号 FROM v_cbpc_cart_lite a INNER JOIN ( (  SELECT  品种, MAX (冠字) 冠字, 冠号, MAX (StartTime) 完工时间, COUNT (DISTINCT 冠字) 大万数  FROM  v_cbpc_cart_lite  WHERE  CONVERT (VARCHAR(6),StartTime,112) >= CONVERT (   VARCHAR (6),  dateadd(MONTH ,- 1,getdate()),  112  )  AND 冠字 > \'\'  GROUP BY  品种, 冠号 ) ) gz ON a.冠字 = gz.冠字 AND a.品种 = gz.品种 order by 1,4', '', '', '2019-10-16 13:41:18', '2019-10-16 14:00:38', '0');
INSERT INTO `sys_api` VALUES ('679', '00000000021', '1', '胶印工序墨色一致性评价', 'ae55af4134', 'SELECT a.prod_name 品种,a.machine_name + a.captain_name 机台,round(cast(COUNT(*) as float) / count(distinct a.cart_number),1)/(case when a.prod_name in (\'9602A\',\'9603A\') then 1 else 2 end) 平均每万检测次数,round(AVG(a.JPIColor),2) 墨色得分,round(stdev(a.jpicolor),2) 墨色方差,count(distinct a.cart_number) 大万数 FROM view_score_offset a WHERE CONVERT (VARCHAR,rec_time,112) BETWEEN ? AND ? AND a.operator_name = \'机台人员\' and a.captain_name not in (\'test\',\'测试员\') GROUP BY a.captain_name,a.machine_name,a.prod_name having count(distinct a.cart_number)>10 ORDER BY 1,5,4 desc', 'tstart,tend', '', '2019-10-31 17:53:20', '2019-10-31 19:39:44', '0');
INSERT INTO `sys_api` VALUES ('680', '00000000021', '1', '凹印工序墨色一致性评价', '3d113d9d20', 'SELECT a.prod_name 品种,a.machine_name + a.captain_name 机台,round(cast(COUNT(*) as float) / count(distinct a.cart_number)/3,1) 平均每万检测次数,round(AVG(a.JPIColor),2) 墨色得分,round(stdev(a.jpicolor),2) 墨色方差,count(distinct a.cart_number) 大万数 FROM view_score_intaglio a WHERE CONVERT (VARCHAR,rec_time,112) BETWEEN ? AND ? AND a.operator_name = \'机台人员\' and a.captain_name not in (\'test\',\'测试员\') GROUP BY a.captain_name,a.machine_name,a.prod_name having count(distinct a.cart_number)>10 ORDER BY 1,5,4 desc', 'tstart,tend', '', '2019-10-31 17:54:53', '2019-10-31 19:39:38', '0');
INSERT INTO `sys_api` VALUES ('682', '00000000016', '1', '精品线_昨日凹二印完成车号列表', 'a25d70d0e9', 'SELECT 车号 cart FROM v_cbpc_cartlist WHERE 车号 IN ( SELECT  车号 FROM  v_cbpc_cartlist a WHERE  CONVERT (  VARCHAR,a.[完成时间],112  ) = CONVERT (  VARCHAR,dateadd(DAY ,- 1,getdate()),112  ) AND 工序 IN (\'凹二印\') AND 品种 = \'9607T\' AND 产量 > 0 ) AND 工序 IN (\'凹二印\') GROUP BY 车号 HAVING SUM (产量) = 10000', '', '', '2019-11-02 15:35:34', '2019-11-02 15:36:06', '0');
INSERT INTO `sys_api` VALUES ('683', '00000000016', '1', '精品线_生产超时转全检车号', '6335d2a4b0', 'WITH cartlist AS ( SELECT  车号 FROM  v_cbpc_cartlist WHERE  车号 IN (  SELECT   车号  FROM   v_cbpc_cartlist a  WHERE   CONVERT (   VARCHAR,  a.[完成时间],  112   ) = CONVERT (   VARCHAR,  dateadd(DAY ,- 1,getdate()),  112   )  AND 工序 IN (\\\'凹二印\\\')  AND 品种 = \\\'9607T\\\'  AND 产量 > 0  ) AND 工序 IN (\\\'凹二印\\\') GROUP BY  车号 HAVING  SUM (产量) = 10000 ),res AS ( SELECT  车号 cart_number, 工序 process,  sum(datediff(  MINUTE, 开始时间, 完成时间  ) ) print_length FROM  v_cbpc_cartlist a WHERE  车号 IN (SELECT * FROM cartlist) group by 车号,工序 ) select cart_number,process+\\\'工序生产超时:时长\\\'+cast(print_length as varchar) reason from res where (  CASE  WHEN print_length >= 105  AND process IN (\\\'胶印\\\',\\\'丝印\\\') THEN  1  WHEN print_length >= 95  AND SUBSTRING (process,1,1) = \\\'凹\\\' THEN  1  ELSE  0  END )=1', '', '', '2019-11-02 15:39:32', '2019-11-02 15:39:32', '0');
INSERT INTO `sys_api` VALUES ('684', '00000000003', '1', '精品线_指定车号丝印转全检或码后', 'ae19384c02', 'WITH cartlist AS (SELECT A.*   FROM (SELECT b.cart_number,D.inspectm_id       FROM QA_RECTIFY_MASTER A      INNER JOIN WIP_JOBS b        ON A.JOB_ID = b.JOB_ID       LEFT JOIN QA_INSPECT_MASTER D        ON A.job_id = D.job_id      WHERE A.OPERATION_ID = 11       AND D.ITEM_FLAG = 3      ORDER BY b.start_date DESC) A  WHERE ROWNUM <= 450),carts_row AS (SELECT ROWNUM row_id,A.fake_num   FROM (SELECT b.cart_number,        count(distinct a.convert_sheet_number || sheet_num) fake_num       FROM QA_INSPECT_SLAVE A      INNER JOIN cartlist b        ON A.inspectm_id = b.inspectm_id      WHERE A.image_blob IS NOT NULL      GROUP BY b.cart_number      ORDER BY 2) A  where rownum <= 400),tbl_thread AS (SELECT ROWNUM row_idx,A.fake_num   FROM carts_row A  INNER JOIN (SELECT CAST(MAX(A.row_id) * 0.25 AS INT) mahou,          CAST(MAX(row_id) * 0.8 AS INT) allcheck         FROM carts_row A) b    ON A.row_id = b.mahou    OR A.row_id = b.allcheck),thread as (SELECT SUM(CASE        WHEN row_idx = 1 THEN         fake_num        ELSE         0       END) mahou,    SUM(CASE        WHEN row_idx = 2 THEN         fake_num        ELSE         0       END) allcheck   FROM tbl_thread),fake_list as (SELECT b.cart_number,    COUNT(DISTINCT E.convert_sheet_number || sheet_num) fake_num   FROM QA_RECTIFY_MASTER A  INNER JOIN WIP_JOBS b    ON A.JOB_ID = b.JOB_ID   LEFT JOIN QA_INSPECT_MASTER D    ON A.job_id = D.job_id   LEFT JOIN QA_INSPECT_SLAVE E    ON D.inspectm_id = E.inspectm_id  WHERE b.cart_number in (?)   AND E.image_blob IS NOT NULL   AND D.ITEM_FLAG = 3   AND A.OPERATION_ID = 11  group by b.cart_number) select a.cart_number \"cart\",   (case     when a.fake_num <= b.mahou then      0     when a.fake_num >= b.allcheck then      1     else      2    end) \"proc\"  from fake_list a,thread b where a.fake_num not between b.mahou and b.allcheck', 'carts', '', '2019-11-02 16:04:13', '2019-11-02 16:57:03', '0');
INSERT INTO `sys_api` VALUES ('685', '00000000016', '1', '数数机过数记录_日期部门', '14ee6cdcb9', 'SELECT C.CPCH,C.UserDefine2 AS \'PROC\',(SELECT U.User_Desc FROM Users_Base U WHERE C.CZYKH = U.Username) AS GSY,C.XH,C.JSJG,C.BCZS,C.JSQR,C.KSSJ,C.JSSJ,C.IPDZ,C.ID FROM SHUSHUJI_COUNT C WHERE KSSJ BETWEEN ? AND ? AND IPDZ IN (?);', 'tstart,tend,ipdz', '', '2019-11-13 12:03:56', '2019-11-19 09:17:18', '0');
INSERT INTO `sys_api` VALUES ('686', '00000000016', '1', '印钞产品分工序总账', '1c38ff2446', 'SELECT [YYYY_MM_DD] AS 日期    ,[Product_Desc] AS 品种    ,[BaiZhi] AS 白纸    ,[JiaoYiYin] AS 胶一印    ,[JiaoYiYinDuiHuan] AS 胶一印兑换品    ,[JiaoErYin] AS 胶二印    ,[JiaoErYinDuiHuan] AS 胶二印兑换品    ,[SiYin] AS 丝印    ,[SiYinDuiHuan] AS 丝印兑换品    ,[WaYiYin] AS 凹一印    ,[WaYiYinDuiHuan] AS 凹一印兑换品    ,[WaErYin] AS 凹二印    ,[WaErYinDuiHuan] AS 凹二印兑换品    ,[YinMa] AS 印码    ,[YinMaDuiHuan] AS 印码兑换品    ,[JianFeng] AS 检封    ,[BuBaiPiao] AS 补白票    ,[FeiPinKu] AS 废品库    ,[ChengPinKu] AS 成品库    ,[ChangYongYangZhang] AS 外来样张    ,[WaiLaiYangZhang] AS 厂用样张     ,[BaiZhi]+[JiaoYiYin]+[JiaoYiYinDuiHuan]+[JiaoErYin]+[JiaoErYinDuiHuan]+[SiYin]+[SiYinDuiHuan]+[WaYiYin]+[WaYiYinDuiHuan]+[WaErYin]+[WaErYinDuiHuan]+[YinMa]+[YinMaDuiHuan]+[JianFeng]+[BuBaiPiao]+[FeiPinKu]+[ChengPinKu]+[ChangYongYangZhang]+[WaiLaiYangZhang] AS 库存  ,[GuoBanZhiKu] AS 过版纸库 FROM [SOADB].[dbo].[udt_report_Storage_All_Procedure] WHERE [Product_Desc]=? and (CONVERT (VARCHAR,[YYYY_MM_DD],112) BETWEEN ? AND ? ) order by [YYYY_MM_DD] asc ;', 'product,tstart,tend', '', '2019-11-13 17:01:42', '2019-11-26 13:55:27', '0');
INSERT INTO `sys_api` VALUES ('687', '00000000026', '1', '青年岗位积分得分排名', 'cd24026726', 'SELECT a.username,a.deptname,a.base_score,round(b.other_score,2) other_score,round(  a.base_score + b.other_score, 2 ) score,round(b.ability_score,2) ability_score,round(b.sport_score,2) sport_score,round(b.public_score,2) public_score,round(b.tech_score,2) tech_score FROM (  SELECT  a.username, a.usercode, a.deptname, round(avg(a.score) * 0.55,2) base_score  FROM  tbl_cbpc_young_base AS a  WHERE  a.rec_date BETWEEN ? AND ?  GROUP BY  a.username, a.usercode, a.deptname ) a INNER JOIN ( SELECT  a.usercode, sum(  a.score * CASE score_type  WHEN \'能力素质积分\' THEN   0.2  WHEN \'活动积分\' THEN   0.15  WHEN \'组织公民行为积分\' THEN   0.1  ELSE   1  END  ) other_score, sum(  CASE score_type  WHEN \'能力素质积分\' THEN   0.2  ELSE   0  END * score  ) ability_score, sum(  CASE score_type  WHEN \'活动积分\' THEN   0.15  ELSE   0  END  ) * score sport_score, sum(  CASE score_type  WHEN \'组织公民行为积分\' THEN   0.1  ELSE   0  END * score  ) public_score, sum(  CASE score_type  WHEN \'技术、创新成果\' THEN   1  ELSE   0  END * score  ) tech_score FROM  (SELECT distinct a.username,a.usercode,a.deptname,a.rec_date,a.score_type,a.score,a.remark FROM tbl_cbpc_young_other AS a ) AS a WHERE  a.rec_date BETWEEN ? AND ? GROUP BY  a.usercode ) b ON a.usercode = b.usercode ORDER BY 5 DESC', 'tstart,tend,tstart2,tend2', '', '2019-11-19 11:02:45', '2019-12-11 09:45:26', '0');
INSERT INTO `sys_api` VALUES ('688', '00000000026', '1', '青年岗位积分——额外加分', '1a31795568', 'SELECT a.id,a.username,a.deptname,a.rec_date,a.score_type,a.score,a.remark FROM tbl_cbpc_young_other AS a where a.rec_date between ? and ?', 'tstart,tend', '', '2019-11-19 11:02:45', '2019-11-19 11:03:56', '0');
INSERT INTO `sys_api` VALUES ('689', '00000000026', '1', '青年岗位积分——岗位业绩积分', '966772bc13', 'SELECT a.id,a.username,a.deptname,a.rec_date,a.prod_quality,a.prod_produce,a.prod_cost,a.support_prod,a.support_attitude,a.manager,a.score FROM tbl_cbpc_young_base AS a where a.rec_date between ? and ?', 'tstart,tend', '', '2019-11-19 11:02:45', '2019-11-19 11:04:01', '0');
INSERT INTO `sys_api` VALUES ('690', '00000000026', '1', '提交基础得分', 'f6b1dff03f', 'insert into tbl_cbpc_young_base(username,usercode,deptname,rec_date,prod_quality,prod_produce,prod_cost,support_prod,support_attitude,manager,score,uid ) values ?', 'values', '@desc:批量插入数据时，约定使用二维数组values参数，格式为[{username,usercode,deptname,rec_date,prod_quality,prod_produce,prod_cost,support_prod,support_attitude,manager,score }]，数组的每一项表示一条数据', '2019-11-19 11:02:45', '2019-11-19 11:04:08', '0');
INSERT INTO `sys_api` VALUES ('691', '00000000026', '1', '提交额外得分', 'd3450882c0', 'insert into tbl_cbpc_young_other(username,usercode,deptname,rec_date,score_type,score,remark,uid ) values ?', 'values', '@desc:批量插入数据时，约定使用二维数组values参数，格式为[{username,usercode,deptname,rec_date,score_type,score,remark }]，数组的每一项表示一条数据', '2019-11-19 11:02:45', '2019-11-19 11:04:13', '0');
INSERT INTO `sys_api` VALUES ('692', '00000000026', '1', '岗位积分系统登录', 'ca81a02b59', 'SELECT a.uid,username,b.deptname,a.gm,c.deptname manage_dept FROM tbl_cbpc_young_user a INNER JOIN tbl_cbpc_young_dept b ON a.dept_id = b.id  left join tbl_cbpc_young_dept c on a.uid = c.uid WHERE a.username = ?  AND a.PASSWORD = MD5( concat( \'wMqSakbLdy9t8LLD\',? ))', 'username,password', '', '2019-11-19 11:02:45', '2019-11-19 11:04:20', '0');
INSERT INTO `sys_api` VALUES ('693', '00000000026', '1', '青年积分排名(不含活动积分、公民行为积分)', 'c578560fbf', 'SELECT a.username,a.deptname,a.base_score,round( b.other_score,2 ) other_score,round( a.base_score + b.other_score,2 ) score,round( b.ability_score,2 ) ability_score,round( b.sport_score,2 ) sport_score,round( b.public_score,2 ) public_score,round( b.tech_score,2 ) tech_score FROM ( SELECT a.username,a.usercode,a.deptname,round( avg( a.score ) * 0.55,2 ) base_score FROM tbl_cbpc_young_base AS a WHERE a.rec_date BETWEEN ? AND ? GROUP BY a.username,a.usercode,a.deptname ) a INNER JOIN ( SELECT a.usercode,sum( a.score * ( CASE score_type WHEN \'能力素质积分\' THEN 0.2 WHEN \'活动积分\' THEN 0.15 WHEN \'组织公民行为积分\' THEN 0.1 when \'技术、创新成果\' then 1 else 0 END )) other_score,sum( CASE score_type WHEN \'能力素质积分\' THEN 0.2 ELSE 0 END * score) ability_score,sum( CASE score_type WHEN \'活动积分\' THEN 0.15 ELSE 0 END * score) sport_score,sum( CASE score_type WHEN \'组织公民行为积分\' THEN 0.1 ELSE 0 END * score ) public_score,sum( CASE score_type WHEN \'技术、创新成果\' THEN 1 ELSE 0 END * score ) tech_score FROM (SELECT distinct a.username,a.usercode,a.deptname,a.rec_date,a.score_type,a.score,a.remark FROM tbl_cbpc_young_other AS a ) AS a WHERE score_type NOT IN ( \'活动积分\',\'组织公民行为积分\' ) AND a.rec_date BETWEEN ? AND ? GROUP BY a.usercode ) b ON a.usercode = b.usercode ORDER BY 5 DESC', 'tstart,tend,tstart2,tend2', '', '2019-11-19 11:02:45', '2019-12-11 09:46:44', '0');
INSERT INTO `sys_api` VALUES ('694', '00000000026', '1', '青年积分系统_删除额外加分', '67625fb6e7', 'delete from tbl_cbpc_young_other where id=?', '_id', '@id:_id. 参数说明：api 索引序号', '2019-11-19 11:02:45', '2019-11-19 11:04:29', '0');
INSERT INTO `sys_api` VALUES ('695', '00000000026', '1', '青年积分系统_删除基础数据', 'd027eb0f64', 'delete from tbl_cbpc_young_base where id=?', '_id', '@id:_id. 参数说明：api 索引序号', '2019-11-19 11:02:45', '2019-11-19 11:04:32', '0');
INSERT INTO `sys_api` VALUES ('696', '00000000026', '1', '青年积分系统_额外加分修改', '74654847ae', 'update tbl_cbpc_young_other set rec_date = ?,remark = ?,score = ?,score_type = ? where id=?', 'rec_date,remark,score,score_type,_id', '@id:_id. 参数说明：api 索引序号', '2019-11-19 11:02:45', '2019-11-19 11:04:36', '0');
INSERT INTO `sys_api` VALUES ('697', '00000000026', '1', '青年积分系统_岗位绩效修改', '44b35940f1', 'update tbl_cbpc_young_base set rec_date = ?,prod_quality = ?,prod_produce = ?,prod_cost = ?,support_prod = ?,support_attitude = ?,manager = ?,score = ? where id=?', 'rec_date,prod_quality,prod_produce,prod_cost,support_prod,support_attitude,manager,score,_id', '@id:_id. 参数说明：api 索引序号', '2019-11-19 11:02:45', '2019-11-19 11:04:40', '0');
INSERT INTO `sys_api` VALUES ('698', '00000000016', '1', '检封昨日已抽精品冠字号', 'c71cb76206', 'SELECT distinct a.车号,a.工艺,品种,a.冠字,a.工序,a.班次,a.机台,a.机长,a.产量,CONVERT (VARCHAR,开始时间,120) AS 开始时间 ,CONVERT (VARCHAR,完成时间,120) AS 完工时间 FROM v_cbpc_cartlist a WHERE CONVERT (VARCHAR,开始时间,112) BETWEEN ? AND ? and 工序 like \'裁%\' and a.产量>0 order by 品种,4', 'tstart,tend', '', '2019-11-22 13:36:38', '2019-11-22 13:39:02', '0');
INSERT INTO `sys_api` VALUES ('699', '00000000002', '1', '物检中心_添加浆板明细', 'd8bf9124fe', 'insert into paper_material_pulpboard(prod_name, place, batch_no, prod_num, prod_date, sn, sample_date, test_date, whiteness, dirt_count, moisture_count, fluo, avg_fiber_length, folding_strength, breaking_length, ph, operator, result, remark ) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)', 'prod_name,place,batch_no,prod_num,prod_date,sn,sample_date,test_date,whiteness,dirt_count,moisture_count,fluo,avg_fiber_length,folding_strength,breaking_length,ph,operator,result,remark', '', '2019-11-28 12:35:05', '2019-11-28 12:35:05', '0');
INSERT INTO `sys_api` VALUES ('700', '00000000002', '1', '物检中心_检索浆板明细', '1c0cc98ebe', 'select  prod_name, place, batch_no, prod_num, prod_date, sn, sample_date, test_date, whiteness, dirt_count, moisture_count, fluo, avg_fiber_length, folding_strength, breaking_length, ph, operator, result, remark from  paper_material_pulpboard  where batch_no=?', 'batch_no', '', '2019-11-28 12:35:25', '2019-11-28 12:35:25', '0');
INSERT INTO `sys_api` VALUES ('701', '00000000002', '1', '物检中心_删除浆板明细', '002daaaf1a', 'delete from paper_material_pulpboard where batch_no=?', 'batch_no', '', '2019-11-28 12:35:42', '2019-11-28 12:35:42', '0');
INSERT INTO `sys_api` VALUES ('702', '00000000002', '1', '物检中心_更新浆板明细', '68e4a4ec47', 'update paper_material_pulpboard set prod_name = ?, place = ?, batch_no = ?, prod_num = ?, prod_date = ?, sn = ?, sample_date = ?, test_date = ?, whiteness = ?, dirt_count = ?, moisture_count = ?, fluo = ?, avg_fiber_length = ?, folding_strength = ?, breaking_length = ?, ph = ?, operator = ?, result = ?, remark  = ? where batch_no=?', 'prod_name,place,batch_no,prod_num,prod_date,sn,sample_date,test_date,whiteness,dirt_count,moisture_count,fluo,avg_fiber_length,folding_strength,breaking_length,ph,operator,result,remark', '', '2019-11-28 12:36:01', '2019-11-28 12:36:01', '0');
INSERT INTO `sys_api` VALUES ('703', '00000000002', '1', '物检中心_浆板明细_近期录入', '2d8f9bd190', 'SELECT top 10   prod_name 产品名称, place 产地, batch_no 批号, prod_num 数量, CONVERT ( VARCHAR(10),prod_date,120 ) 生产日期, sn 编号, CONVERT ( VARCHAR(10),sample_date,120 ) 取样日期, CONVERT ( VARCHAR(10),test_date,120 ) 检测日期, whiteness 白度, dirt_count 尘埃度, moisture_count 水分, fluo 荧光物质, avg_fiber_length 平均纤维长, folding_strength 耐折度, breaking_length 裂断长, ph pH值, operator 检验员, result 检验结论, remark 备注,CONVERT ( VARCHAR,rec_time,120 ) 录入时间   FROM   paper_material_pulpboard   ORDER BY   rec_time desc', '', '', '2019-11-28 12:36:37', '2019-11-28 12:37:18', '0');
INSERT INTO `sys_api` VALUES ('704', '00000000003', '1', '9606T品图核实废信息查询', '9dcb97be75', 'with cart_list as (select cart_number from qfm_wip_jobs where cart_number in (?)),fake_info as (SELECT substr(c.ROUTE_SHEET_NUMBER,0,2) camera,    c.error_site macro_id,    count(*) err_num,    a.cart_number   FROM qfm_wip_jobs A  INNER JOIN qfm_qa_inspect_master b    ON A.job_id = b.job_id   AND A.cart_number in (select * from cart_list)  INNER JOIN qfm_qa_inspect_slave c    ON b.inspectm_id = c.inspectm_id   and c.image_blob IS NOT NULL  group by substr(c.ROUTE_SHEET_NUMBER,0,2),c.error_site,a.cart_number),detail_tbl as (select cart_number 车号,    (case      when camera = 10 and macro_id <> 3 then       err_num      else       0     end) 正面,    (case      when camera = 10 and macro_id = 3 then       err_num      else       0     end) 丝印,    (case      when camera = 13 then       err_num      else       0     end) 透视,    (case      when camera = 12 then       err_num      else       0     end) 丝印单光源,    (case      when camera = 22 then       err_num      else       0     end) 涂布背,    (case      when camera = 23 then       err_num      else       0     end) 涂布正,    (case      when camera = 14 then       err_num      else       0     end) 背面   from fake_info) select 车号,   sum(正面) 正面,   sum(丝印) 丝印,   sum(透视) 透视,   sum(丝印单光源) 丝印单光源,   sum(涂布背) 涂布背,   sum(涂布正) 涂布正,   sum(背面) 背面  from detail_tbl group by 车号', 'carts', '', '2019-11-28 13:00:10', '2019-11-28 13:00:10', '0');
INSERT INTO `sys_api` VALUES ('705', '00000000002', '1', '化工原材料明细_NaOH_insert', '87828fd8c1', 'insert into paper_material_chemical_naoh(prod_name, place, batch_no, prod_num, prod_date, sample_date, test_date, surface, naoh, naco3, operator, result, remark ) values (?,?,?,?,?,?,?,?,?,?,?,?,?)', 'prod_name,place,batch_no,prod_num,prod_date,sample_date,test_date,surface,naoh,naco3,operator,result,remark', '', '2019-11-28 15:59:27', '2019-11-28 15:59:27', '0');
INSERT INTO `sys_api` VALUES ('706', '00000000002', '1', '化工原材料明细_NaOH_delete', 'fb048ae5a7', 'delete from paper_material_chemical_naoh where batch_no=?', 'batch_no', '', '2019-11-28 15:59:45', '2019-11-28 15:59:45', '0');
INSERT INTO `sys_api` VALUES ('707', '00000000002', '1', '化工原材料明细_NaOH', '9c21b13491', 'update paper_material_chemical_naoh set prod_name = ?,place = ?,batch_no = ?,prod_num = ?,prod_date = ?,sample_date = ?,test_date = ?,surface = ?,naoh = ?,naco3 = ?,operator = ?,result = ?,remark = ? where batch_no=?', 'prod_name,place,batch_no,prod_num,prod_date,sample_date,test_date,surface,naoh,naco3,operator,result,remark', '', '2019-11-28 16:00:03', '2019-11-28 16:00:11', '0');
INSERT INTO `sys_api` VALUES ('708', '00000000002', '1', '化工原材料明细_NaOH', '2146b989d4', 'select  prod_name, place, batch_no, prod_num, prod_date, sample_date, test_date, surface, naoh, naco3, operator, result, remark from  paper_material_chemical_naoh  where batch_no=?', 'batch_no', '', '2019-11-28 16:00:31', '2019-11-28 16:00:31', '0');
INSERT INTO `sys_api` VALUES ('709', '00000000002', '1', '化工原材料——氢氧化钠(液碱)', '4b3c4b103e', 'SELECT top 10 * FROM view_paper_material_chemical_naoh ORDER BY 录入时间 desc', '', '', '2019-11-28 16:08:47', '2019-11-28 16:13:37', '0');
INSERT INTO `sys_api` VALUES ('710', '00000000002', '1', '化工原材料_过氧化氢', '6d968fc9b1', 'insert into tbl_paper_material_chemical_h2o2(prod_name, place, batch_no, prod_num, prod_date, sample_date, test_date, surface, h2o2, stability, operator, result, remark ) values (?,?,?,?,?,?,?,?,?,?,?,?,?)', 'prod_name,place,batch_no,prod_num,prod_date,sample_date,test_date,surface,h2o2,stability,operator,result,remark', '', '2019-11-28 16:18:20', '2019-11-28 16:18:20', '0');
INSERT INTO `sys_api` VALUES ('711', '00000000002', '1', '化工原材料_过氧化氢', '167e091805', 'delete from tbl_paper_material_chemical_h2o2 where batch_no=?', 'batch_no', '', '2019-11-28 16:18:37', '2019-11-28 16:18:37', '0');
INSERT INTO `sys_api` VALUES ('712', '00000000002', '1', '化工原材料_过氧化氢', 'a385017347', 'update tbl_paper_material_chemical_h2o2 set prod_name = ?, place = ?, batch_no = ?, prod_num = ?, prod_date = ?, sample_date = ?, test_date = ?, surface = ?, h2o2 = ?, stability = ?, operator = ?, result = ?, remark  = ? where batch_no=?', 'prod_name,place,batch_no,prod_num,prod_date,sample_date,test_date,surface,h2o2,stability,operator,result,remark', '', '2019-11-28 16:18:59', '2019-11-28 16:18:59', '0');
INSERT INTO `sys_api` VALUES ('713', '00000000002', '1', '化工原材料_过氧化氢', '2e4f7b808e', 'select  prod_name, place, batch_no, prod_num, prod_date, sample_date, test_date, surface, h2o2, stability, operator, result, remark from  tbl_paper_material_chemical_h2o2  where batch_no=?', 'batch_no', '', '2019-11-28 16:19:11', '2019-11-28 16:19:11', '0');
INSERT INTO `sys_api` VALUES ('714', '00000000002', '1', '化工原材料——过氧化氢', '878165419b', 'SELECT top 10 * FROM view_paper_material_chemical_h2o2 ORDER BY 录入时间 desc', '', '', '2019-11-28 16:19:35', '2019-11-28 16:22:34', '0');
INSERT INTO `sys_api` VALUES ('715', '00000000002', '1', '化工原材料——盐酸', 'f176c6fe9c', 'insert into tbl_paper_material_chemical_hcl(prod_name, place, batch_no, prod_num, prod_date, sample_date, test_date, surface, acidity, operator, result, remark ) values (?,?,?,?,?,?,?,?,?,?,?,?)', 'prod_name,place,batch_no,prod_num,prod_date,sample_date,test_date,surface,acidity,operator,result,remark', '', '2019-11-28 16:30:52', '2019-11-28 16:30:52', '0');
INSERT INTO `sys_api` VALUES ('716', '00000000002', '1', '化工原材料——盐酸', '46124f7fac', 'delete from tbl_paper_material_chemical_hcl where batch_no=?', 'batch_no', '', '2019-11-28 16:31:04', '2019-11-28 16:31:04', '0');
INSERT INTO `sys_api` VALUES ('717', '00000000002', '1', '	化工原材料——盐酸', '511c6bce4f', 'update tbl_paper_material_chemical_hcl set prod_name = ?, place = ?, batch_no = ?, prod_num = ?, prod_date = ?, sample_date = ?, test_date = ?, surface = ?, acidity = ?, operator = ?, result = ?, remark  = ? where batch_no=?', 'prod_name,place,batch_no,prod_num,prod_date,sample_date,test_date,surface,acidity,operator,result,remark', '', '2019-11-28 16:31:19', '2019-11-28 16:31:19', '0');
INSERT INTO `sys_api` VALUES ('718', '00000000002', '1', '化工原材料——盐酸', 'dc30f39d8d', 'select  prod_name, place, batch_no, prod_num, prod_date, sample_date, test_date, surface, acidity, operator, result, remark from  tbl_paper_material_chemical_hcl  where batch_no=?', 'batch_no', '', '2019-11-28 16:31:39', '2019-11-28 16:31:39', '0');
INSERT INTO `sys_api` VALUES ('719', '00000000002', '1', '化工原材料——盐酸', '0a0e551574', 'SELECT top 10 * FROM view_paper_material_chemical_hcl ORDER BY 录入时间 desc', '', '', '2019-11-28 16:31:53', '2019-11-28 16:36:38', '0');
INSERT INTO `sys_api` VALUES ('720', '00000000002', '1', '化工原材料——聚乙烯醇', 'fac2987ef5', 'insert into tbl_paper_material_chemical_pva(prod_name, place, batch_no, prod_num, prod_date, sample_date, test_date, surface, viscosity, fugitive_constituent, sodium_acetate, ph, alcoholysis_deg, operator, result, remark ) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)', 'prod_name,place,batch_no,prod_num,prod_date,sample_date,test_date,surface,viscosity,fugitive_constituent,sodium_acetate,ph,alcoholysis_deg,operator,result,remark', '', '2019-11-28 17:01:15', '2019-11-28 17:01:15', '0');
INSERT INTO `sys_api` VALUES ('721', '00000000002', '1', '化工原材料——聚乙烯醇', '58168dab69', 'delete from tbl_paper_material_chemical_pva where batch_no=?', 'batch_no', '', '2019-11-28 17:01:24', '2019-11-28 17:01:24', '0');
INSERT INTO `sys_api` VALUES ('722', '00000000002', '1', '化工原材料——聚乙烯醇', 'a9170175b7', 'update tbl_paper_material_chemical_pva set prod_name = ?, place = ?, batch_no = ?, prod_num = ?, prod_date = ?, sample_date = ?, test_date = ?, surface = ?, viscosity = ?, fugitive_constituent = ?, sodium_acetate = ?, ph = ?, alcoholysis_deg = ?, operator = ?, result = ?, remark  = ? where batch_no=?', 'prod_name,place,batch_no,prod_num,prod_date,sample_date,test_date,surface,viscosity,fugitive_constituent,sodium_acetate,ph,alcoholysis_deg,operator,result,remark', '', '2019-11-28 17:01:33', '2019-11-28 17:01:33', '0');
INSERT INTO `sys_api` VALUES ('723', '00000000002', '1', '化工原材料——聚乙烯醇', '7b2f3174d9', 'select  prod_name, place, batch_no, prod_num, prod_date, sample_date, test_date, surface, viscosity, fugitive_constituent, sodium_acetate, ph, alcoholysis_deg, operator, result, remark from  tbl_paper_material_chemical_pva  where batch_no=?', 'batch_no', '', '2019-11-28 17:01:41', '2019-11-28 17:01:41', '0');
INSERT INTO `sys_api` VALUES ('724', '00000000002', '1', '化工原材料——聚乙烯醇', '3a3c0940e3', 'SELECT top 10 * FROM view_paper_material_chemical_pva ORDER BY 录入时间 desc', '', '', '2019-11-28 17:02:14', '2019-11-28 17:02:14', '0');
INSERT INTO `sys_api` VALUES ('725', '00000000002', '1', '码后核查工艺机台质量数据', 'a4a6ac28ad', 'SELECT a.[车号],a.[品种],a.[机台],a.[生产日期],a.[好品率],a.[严重废锁图],a.[缺陷条数],a.[票面条数],a.[透视条数],a.[未检条数],a.[号码条数],a.[荧光条数],a.[正面缺陷数],a.[背面缺陷数],a.[丝网缺陷数],a.[透视缺陷数],a.[二次缺陷条数],a.[黑图数],a.[大张废] FROM dbo.view_print_hecha AS a WHERE a.生产日期 BETWEEN ? AND ?', 'tstart,tend', '', '2019-12-02 10:39:45', '2019-12-02 10:39:45', '0');
INSERT INTO `sys_api` VALUES ('726', '00000000017', '1', '立库-请求响应（按车号）', '8e9445ae02', 'SELECT v.asrsid,v.recpaytype,v.businesstype,v.isoffline,v.insertat,v.taskstart,v.taskend,v.status,v.pickuplocation,v.prodid,v.processcode,v.techcode,v.reviewtag,v.carno,v.reqquantity,v.applicantname,v.applicantorg,v.executorname,v.executororg,v.asrscell,v.carda,v.cardb,v.appoint FROM V_RSS_REQUEST_API v WHERE v.carno LIKE ? ORDER BY v.insertat', 'carno', '', '2019-12-02 11:40:24', '2019-12-02 11:40:24', '0');
INSERT INTO `sys_api` VALUES ('727', '00000000017', '1', '日结查询', 'fe8b897ae5', 'SELECT [DATE],BUSINESSTYPE,ITEMCODE,PROCESSCODE,ITEMQTY FROM DAY_STOCK_SUM WHERE DATE BETWEEN ? AND ? AND ITEMCODE = ?;', 'tstart,tend,product', '', '2019-12-04 10:38:39', '2019-12-17 14:03:49', '0');
INSERT INTO `sys_api` VALUES ('728', '00000000016', '1', '单位', 'a5347ce1d0', 'SELECT a.id value,a.unit_name name FROM tbl_cbpc_prod_unit a', '', '', '2019-12-13 11:35:01', '2019-12-13 11:35:01', '0');
DROP TRIGGER IF EXISTS `api_rectime`;
DELIMITER ;;
CREATE TRIGGER `api_rectime` BEFORE INSERT ON `sys_api` FOR EACH ROW SET new.rec_time = CURRENT_TIMESTAMP,new.update_time = CURRENT_TIMESTAMP
;;
DELIMITER ;
DROP TRIGGER IF EXISTS `api_nonce`;
DELIMITER ;;
CREATE TRIGGER `api_nonce` BEFORE INSERT ON `sys_api` FOR EACH ROW if new.nonce='' then
	set new.nonce = substring(MD5(RAND()*100),1,10);
end if
;;
DELIMITER ;
DROP TRIGGER IF EXISTS `api_update`;
DELIMITER ;;
CREATE TRIGGER `api_update` BEFORE UPDATE ON `sys_api` FOR EACH ROW SET new.update_time = CURRENT_TIMESTAMP
;;
DELIMITER ;
